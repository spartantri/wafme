





<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
  <link rel="dns-prefetch" href="https://assets-cdn.github.com">
  <link rel="dns-prefetch" href="https://avatars0.githubusercontent.com">
  <link rel="dns-prefetch" href="https://avatars1.githubusercontent.com">
  <link rel="dns-prefetch" href="https://avatars2.githubusercontent.com">
  <link rel="dns-prefetch" href="https://avatars3.githubusercontent.com">
  <link rel="dns-prefetch" href="https://github-cloud.s3.amazonaws.com">
  <link rel="dns-prefetch" href="https://user-images.githubusercontent.com/">



  <link crossorigin="anonymous" href="https://assets-cdn.github.com/assets/frameworks-bedfc518345498ab3204d330c1727cde7e733526a09cd7df6867f6a231565091.css" media="all" rel="stylesheet" />
  <link crossorigin="anonymous" href="https://assets-cdn.github.com/assets/github-3aa8238ecca60313b997b230834183c66288289cbb27d47eb5635a37e61c1793.css" media="all" rel="stylesheet" />
  
  
  <link crossorigin="anonymous" href="https://assets-cdn.github.com/assets/site-877643c520258c4fa15ac8d1664d84efd0e3db56f5e544ccac58da0e50489904.css" media="all" rel="stylesheet" />
  

  <meta name="viewport" content="width=device-width">
  
  <title>Reference Manual · SpiderLabs/ModSecurity Wiki · GitHub</title>
  <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="GitHub">
  <link rel="fluid-icon" href="https://github.com/fluidicon.png" title="GitHub">
  <meta property="fb:app_id" content="1401488693436528">

    
    <meta content="https://avatars0.githubusercontent.com/u/508521?v=4&amp;s=400" property="og:image" /><meta content="GitHub" property="og:site_name" /><meta content="object" property="og:type" /><meta content="SpiderLabs/ModSecurity" property="og:title" /><meta content="https://github.com/SpiderLabs/ModSecurity" property="og:url" /><meta content="ModSecurity is an open source, cross platform web application firewall (WAF) engine for Apache, IIS and Nginx that is developed by Trustwave&amp;#39;s SpiderLabs. It has a robust event-based programmin..." property="og:description" />

  <link rel="assets" href="https://assets-cdn.github.com/">
  
  <meta name="pjax-timeout" content="1000">
  
  <meta name="request-id" content="A75C:2BD83:1106550C:19C6A60C:59D558E2" data-pjax-transient>
  

  <meta name="selected-link" value="repo_wiki" data-pjax-transient>

  <meta name="google-site-verification" content="KT5gs8h0wvaagLKAVWq8bbeNwnZZK1r1XQysX3xurLU">
<meta name="google-site-verification" content="ZzhVyEFwb7w3e0-uOTltm8Jsck2F5StVihD0exw2fsA">
    <meta name="google-analytics" content="UA-3769691-2">

<meta content="collector.githubapp.com" name="octolytics-host" /><meta content="github" name="octolytics-app-id" /><meta content="https://collector.githubapp.com/github-external/browser_event" name="octolytics-event-url" /><meta content="A75C:2BD83:1106550C:19C6A60C:59D558E2" name="octolytics-dimension-request_id" /><meta content="sea" name="octolytics-dimension-region_edge" /><meta content="iad" name="octolytics-dimension-region_render" />
<meta content="/&lt;user-name&gt;/&lt;repo-name&gt;/wiki/show" data-pjax-transient="true" name="analytics-location" />




  <meta class="js-ga-set" name="dimension1" content="Logged Out">


  

      <meta name="hostname" content="github.com">
  <meta name="user-login" content="">

      <meta name="expected-hostname" content="github.com">
    <meta name="js-proxy-site-detection-payload" content="NWU2ZDFlZDIwNmZjYjNlMGMzNWE1ZDQ5YmNkNDFlZTA2NWI0MDQ1Mjk4NzEyOTdhMTc5NWYxYWM1MGY0YmEwNHx7InJlbW90ZV9hZGRyZXNzIjoiNTQuMjQ1LjE4NS4xMjUiLCJyZXF1ZXN0X2lkIjoiQTc1QzoyQkQ4MzoxMTA2NTUwQzoxOUM2QTYwQzo1OUQ1NThFMiIsInRpbWVzdGFtcCI6MTUwNzE1NDE0NiwiaG9zdCI6ImdpdGh1Yi5jb20ifQ==">


  <meta name="html-safe-nonce" content="fde6b7a4686406d551e3be5829f5d923d64d1fc2">

  <meta http-equiv="x-pjax-version" content="8fa9fe230ab80b17256dce52bb1ac9a4">
  

      <link href="https://github.com/SpiderLabs/ModSecurity/commits/v2/master.atom" rel="alternate" title="Recent Commits to ModSecurity:v2/master" type="application/atom+xml">

  <meta name="description" content="ModSecurity is an open source, cross platform web application firewall (WAF) engine for Apache, IIS and Nginx that is developed by Trustwave&#39;s SpiderLabs. It has a robust event-based programming language which provides protection from a range of attacks against web applications and allows for HTTP traffic monitoring, logging and real-time analysis. With over 10,000 deployments world-wide, ModSecurity is the most widely deployed WAF in existence. ">
  <meta name="go-import" content="github.com/SpiderLabs/ModSecurity git https://github.com/SpiderLabs/ModSecurity.git">

  <meta content="508521" name="octolytics-dimension-user_id" /><meta content="SpiderLabs" name="octolytics-dimension-user_login" /><meta content="1320594" name="octolytics-dimension-repository_id" /><meta content="SpiderLabs/ModSecurity" name="octolytics-dimension-repository_nwo" /><meta content="true" name="octolytics-dimension-repository_public" /><meta content="false" name="octolytics-dimension-repository_is_fork" /><meta content="1320594" name="octolytics-dimension-repository_network_root_id" /><meta content="SpiderLabs/ModSecurity" name="octolytics-dimension-repository_network_root_nwo" /><meta content="false" name="octolytics-dimension-repository_explore_github_marketplace_ci_cta_shown" />




  <meta name="browser-stats-url" content="https://api.github.com/_private/browser/stats">

  <meta name="browser-errors-url" content="https://api.github.com/_private/browser/errors">

  <link rel="mask-icon" href="https://assets-cdn.github.com/pinned-octocat.svg" color="#000000">
  <link rel="icon" type="image/x-icon" href="https://assets-cdn.github.com/favicon.ico">

<meta name="theme-color" content="#1e2327">



  </head>

  <body class="logged-out env-production">
    

  <div class="position-relative js-header-wrapper ">
    <a href="#start-of-content" tabindex="1" class="px-2 py-4 show-on-focus js-skip-to-content">Skip to content</a>
    <div id="js-pjax-loader-bar" class="pjax-loader-bar"><div class="progress"></div></div>

    
    
    



        <header class="Header header-logged-out  position-relative f4 py-3" role="banner">
  <div class="container-lg d-flex px-3">
    <div class="d-flex flex-justify-between flex-items-center">
      <a class="header-logo-invertocat my-0" href="https://github.com/" aria-label="Homepage" data-ga-click="(Logged out) Header, go to homepage, icon:logo-wordmark">
        <svg aria-hidden="true" class="octicon octicon-mark-github" height="32" version="1.1" viewBox="0 0 16 16" width="32"><path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"/></svg>
      </a>

    </div>

    <div class="HeaderMenu HeaderMenu--bright d-flex flex-justify-between flex-auto">
        <nav class="mt-0">
          <ul class="d-flex list-style-none">
              <li class="ml-2">
                <a href="/features" class="js-selected-navigation-item HeaderNavlink px-0 py-2 m-0" data-ga-click="Header, click, Nav menu - item:features" data-selected-links="/features /features/project-management /features/code-review /features/project-management /features/integrations /features">
                  Features
</a>              </li>
              <li class="ml-4">
                <a href="/business" class="js-selected-navigation-item HeaderNavlink px-0 py-2 m-0" data-ga-click="Header, click, Nav menu - item:business" data-selected-links="/business /business/security /business/customers /business">
                  Business
</a>              </li>

              <li class="ml-4">
                <a href="/explore" class="js-selected-navigation-item HeaderNavlink px-0 py-2 m-0" data-ga-click="Header, click, Nav menu - item:explore" data-selected-links="/explore /trending /trending/developers /integrations /integrations/feature/code /integrations/feature/collaborate /integrations/feature/ship showcases showcases_search showcases_landing /explore">
                  Explore
</a>              </li>

              <li class="ml-4">
                    <a href="/marketplace" class="js-selected-navigation-item HeaderNavlink px-0 py-2 m-0" data-ga-click="Header, click, Nav menu - item:marketplace" data-selected-links=" /marketplace">
                      Marketplace
</a>              </li>
              <li class="ml-4">
                <a href="/pricing" class="js-selected-navigation-item HeaderNavlink px-0 py-2 m-0" data-ga-click="Header, click, Nav menu - item:pricing" data-selected-links="/pricing /pricing/developer /pricing/team /pricing/business-hosted /pricing/business-enterprise /pricing">
                  Pricing
</a>              </li>
          </ul>
        </nav>

      <div class="d-flex">
          <div class="d-lg-flex flex-items-center mr-3">
            <div class="header-search scoped-search site-scoped-search js-site-search" role="search">
  <!-- '"` --><!-- </textarea></xmp> --></option></form><form accept-charset="UTF-8" action="/SpiderLabs/ModSecurity/search" class="js-site-search-form" data-scoped-search-url="/SpiderLabs/ModSecurity/search" data-unscoped-search-url="/search" method="get"><div style="margin:0;padding:0;display:inline"><input name="utf8" type="hidden" value="&#x2713;" /></div>
    <label class="form-control header-search-wrapper js-chromeless-input-container">
        <a href="/SpiderLabs/ModSecurity/wiki/Reference-Manual" class="header-search-scope no-underline">This repository</a>
      <input type="text"
        class="form-control header-search-input js-site-search-focus js-site-search-field is-clearable"
        data-hotkey="s"
        name="q"
        value=""
        placeholder="Search"
        aria-label="Search this repository"
        data-unscoped-placeholder="Search GitHub"
        data-scoped-placeholder="Search"
        autocapitalize="off">
        <input type="hidden" class="js-site-search-type-field" name="type" >
    </label>
</form></div>

          </div>

        <span class="d-inline-block">
            <div class="HeaderNavlink px-0 py-2 m-0">
              <a class="text-bold text-white no-underline" href="/login?return_to=%2FSpiderLabs%2FModSecurity%2Fwiki%2FReference-Manual" data-ga-click="(Logged out) Header, clicked Sign in, text:sign-in">Sign in</a>
                <span class="text-gray">or</span>
                <a class="text-bold text-white no-underline" href="/join?source=header-repo" data-ga-click="(Logged out) Header, clicked Sign up, text:sign-up">Sign up</a>
            </div>
        </span>
      </div>
    </div>
  </div>
</header>


  </div>

  <div id="start-of-content" class="show-on-focus"></div>

    <div id="js-flash-container">
</div>



  <div role="main">
        <div itemscope itemtype="http://schema.org/SoftwareSourceCode">
    <div id="js-repo-pjax-container" data-pjax-container>
      



  



    <div class="pagehead repohead instapaper_ignore readability-menu experiment-repo-nav ">
      <div class="repohead-details-container clearfix container ">

        <ul class="pagehead-actions">
  <li>
      <a href="/login?return_to=%2FSpiderLabs%2FModSecurity"
    class="btn btn-sm btn-with-count tooltipped tooltipped-n"
    aria-label="You must be signed in to watch a repository" rel="nofollow">
    <svg aria-hidden="true" class="octicon octicon-eye" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M8.06 2C3 2 0 8 0 8s3 6 8.06 6C13 14 16 8 16 8s-3-6-7.94-6zM8 12c-2.2 0-4-1.78-4-4 0-2.2 1.8-4 4-4 2.22 0 4 1.8 4 4 0 2.22-1.78 4-4 4zm2-4c0 1.11-.89 2-2 2-1.11 0-2-.89-2-2 0-1.11.89-2 2-2 1.11 0 2 .89 2 2z"/></svg>
    Watch
  </a>
  <a class="social-count" href="/SpiderLabs/ModSecurity/watchers"
     aria-label="264 users are watching this repository">
    264
  </a>

  </li>

  <li>
      <a href="/login?return_to=%2FSpiderLabs%2FModSecurity"
    class="btn btn-sm btn-with-count tooltipped tooltipped-n"
    aria-label="You must be signed in to star a repository" rel="nofollow">
    <svg aria-hidden="true" class="octicon octicon-star" height="16" version="1.1" viewBox="0 0 14 16" width="14"><path fill-rule="evenodd" d="M14 6l-4.9-.64L7 1 4.9 5.36 0 6l3.6 3.26L2.67 14 7 11.67 11.33 14l-.93-4.74z"/></svg>
    Star
  </a>

    <a class="social-count js-social-count" href="/SpiderLabs/ModSecurity/stargazers"
      aria-label="1637 users starred this repository">
      1,637
    </a>

  </li>

  <li>
      <a href="/login?return_to=%2FSpiderLabs%2FModSecurity"
        class="btn btn-sm btn-with-count tooltipped tooltipped-n"
        aria-label="You must be signed in to fork a repository" rel="nofollow">
        <svg aria-hidden="true" class="octicon octicon-repo-forked" height="16" version="1.1" viewBox="0 0 10 16" width="10"><path fill-rule="evenodd" d="M8 1a1.993 1.993 0 0 0-1 3.72V6L5 8 3 6V4.72A1.993 1.993 0 0 0 2 1a1.993 1.993 0 0 0-1 3.72V6.5l3 3v1.78A1.993 1.993 0 0 0 5 15a1.993 1.993 0 0 0 1-3.72V9.5l3-3V4.72A1.993 1.993 0 0 0 8 1zM2 4.2C1.34 4.2.8 3.65.8 3c0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2zm3 10c-.66 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2zm3-10c-.66 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2z"/></svg>
        Fork
      </a>

    <a href="/SpiderLabs/ModSecurity/network" class="social-count"
       aria-label="578 users forked this repository">
      578
    </a>
  </li>
</ul>

        <h1 class="public ">
  <svg aria-hidden="true" class="octicon octicon-repo" height="16" version="1.1" viewBox="0 0 12 16" width="12"><path fill-rule="evenodd" d="M4 9H3V8h1v1zm0-3H3v1h1V6zm0-2H3v1h1V4zm0-2H3v1h1V2zm8-1v12c0 .55-.45 1-1 1H6v2l-1.5-1.5L3 16v-2H1c-.55 0-1-.45-1-1V1c0-.55.45-1 1-1h10c.55 0 1 .45 1 1zm-1 10H1v2h2v-1h3v1h5v-2zm0-10H2v9h9V1z"/></svg>
  <span class="author" itemprop="author"><a href="/SpiderLabs" class="url fn" rel="author">SpiderLabs</a></span><!--
--><span class="path-divider">/</span><!--
--><strong itemprop="name"><a href="/SpiderLabs/ModSecurity" data-pjax="#js-repo-pjax-container">ModSecurity</a></strong>

</h1>

      </div>
      
<nav class="reponav js-repo-nav js-sidenav-container-pjax container"
     itemscope
     itemtype="http://schema.org/BreadcrumbList"
     role="navigation"
     data-pjax="#js-repo-pjax-container">

  <span itemscope itemtype="http://schema.org/ListItem" itemprop="itemListElement">
    <a href="/SpiderLabs/ModSecurity" class="js-selected-navigation-item reponav-item" data-hotkey="g c" data-selected-links="repo_source repo_downloads repo_commits repo_releases repo_tags repo_branches /SpiderLabs/ModSecurity" itemprop="url">
      <svg aria-hidden="true" class="octicon octicon-code" height="16" version="1.1" viewBox="0 0 14 16" width="14"><path fill-rule="evenodd" d="M9.5 3L8 4.5 11.5 8 8 11.5 9.5 13 14 8 9.5 3zm-5 0L0 8l4.5 5L6 11.5 2.5 8 6 4.5 4.5 3z"/></svg>
      <span itemprop="name">Code</span>
      <meta itemprop="position" content="1">
</a>  </span>

    <span itemscope itemtype="http://schema.org/ListItem" itemprop="itemListElement">
      <a href="/SpiderLabs/ModSecurity/issues" class="js-selected-navigation-item reponav-item" data-hotkey="g i" data-selected-links="repo_issues repo_labels repo_milestones /SpiderLabs/ModSecurity/issues" itemprop="url">
        <svg aria-hidden="true" class="octicon octicon-issue-opened" height="16" version="1.1" viewBox="0 0 14 16" width="14"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"/></svg>
        <span itemprop="name">Issues</span>
        <span class="Counter">190</span>
        <meta itemprop="position" content="2">
</a>    </span>

  <span itemscope itemtype="http://schema.org/ListItem" itemprop="itemListElement">
    <a href="/SpiderLabs/ModSecurity/pulls" class="js-selected-navigation-item reponav-item" data-hotkey="g p" data-selected-links="repo_pulls /SpiderLabs/ModSecurity/pulls" itemprop="url">
      <svg aria-hidden="true" class="octicon octicon-git-pull-request" height="16" version="1.1" viewBox="0 0 12 16" width="12"><path fill-rule="evenodd" d="M11 11.28V5c-.03-.78-.34-1.47-.94-2.06C9.46 2.35 8.78 2.03 8 2H7V0L4 3l3 3V4h1c.27.02.48.11.69.31.21.2.3.42.31.69v6.28A1.993 1.993 0 0 0 10 15a1.993 1.993 0 0 0 1-3.72zm-1 2.92c-.66 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2zM4 3c0-1.11-.89-2-2-2a1.993 1.993 0 0 0-1 3.72v6.56A1.993 1.993 0 0 0 2 15a1.993 1.993 0 0 0 1-3.72V4.72c.59-.34 1-.98 1-1.72zm-.8 10c0 .66-.55 1.2-1.2 1.2-.65 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2zM2 4.2C1.34 4.2.8 3.65.8 3c0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2z"/></svg>
      <span itemprop="name">Pull requests</span>
      <span class="Counter">7</span>
      <meta itemprop="position" content="3">
</a>  </span>

    <a href="/SpiderLabs/ModSecurity/projects" class="js-selected-navigation-item reponav-item" data-hotkey="g b" data-selected-links="repo_projects new_repo_project repo_project /SpiderLabs/ModSecurity/projects">
      <svg aria-hidden="true" class="octicon octicon-project" height="16" version="1.1" viewBox="0 0 15 16" width="15"><path fill-rule="evenodd" d="M10 12h3V2h-3v10zm-4-2h3V2H6v8zm-4 4h3V2H2v12zm-1 1h13V1H1v14zM14 0H1a1 1 0 0 0-1 1v14a1 1 0 0 0 1 1h13a1 1 0 0 0 1-1V1a1 1 0 0 0-1-1z"/></svg>
      Projects
      <span class="Counter" >0</span>
</a>
    <a href="/SpiderLabs/ModSecurity/wiki" class="js-selected-navigation-item selected reponav-item" data-hotkey="g w" data-selected-links="repo_wiki /SpiderLabs/ModSecurity/wiki">
      <svg aria-hidden="true" class="octicon octicon-book" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M3 5h4v1H3V5zm0 3h4V7H3v1zm0 2h4V9H3v1zm11-5h-4v1h4V5zm0 2h-4v1h4V7zm0 2h-4v1h4V9zm2-6v9c0 .55-.45 1-1 1H9.5l-1 1-1-1H2c-.55 0-1-.45-1-1V3c0-.55.45-1 1-1h5.5l1 1 1-1H15c.55 0 1 .45 1 1zm-8 .5L7.5 3H2v9h6V3.5zm7-.5H9.5l-.5.5V12h6V3z"/></svg>
      Wiki
</a>

    <div class="reponav-dropdown js-menu-container">
      <button type="button" class="btn-link reponav-item reponav-dropdown js-menu-target " data-no-toggle aria-expanded="false" aria-haspopup="true">
        Insights
        <svg aria-hidden="true" class="octicon octicon-triangle-down v-align-middle text-gray" height="11" version="1.1" viewBox="0 0 12 16" width="8"><path fill-rule="evenodd" d="M0 5l6 6 6-6z"/></svg>
      </button>
      <div class="dropdown-menu-content js-menu-content">
        <div class="dropdown-menu dropdown-menu-sw">
          <a class="dropdown-item" href="/SpiderLabs/ModSecurity/pulse" data-skip-pjax>
            <svg aria-hidden="true" class="octicon octicon-pulse" height="16" version="1.1" viewBox="0 0 14 16" width="14"><path fill-rule="evenodd" d="M11.5 8L8.8 5.4 6.6 8.5 5.5 1.6 2.38 8H0v2h3.6l.9-1.8.9 5.4L9 8.5l1.6 1.5H14V8z"/></svg>
            Pulse
          </a>
          <a class="dropdown-item" href="/SpiderLabs/ModSecurity/graphs" data-skip-pjax>
            <svg aria-hidden="true" class="octicon octicon-graph" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M16 14v1H0V0h1v14h15zM5 13H3V8h2v5zm4 0H7V3h2v10zm4 0h-2V6h2v7z"/></svg>
            Graphs
          </a>
        </div>
      </div>
    </div>
</nav>


    </div>

<div class="container new-discussion-timeline experiment-repo-nav">
  <div class="repository-content">

    
  <div id="wiki-wrapper" class="wiki-wrapper page">
  <div class="gh-header">
    <div class="gh-header-show">
      <h1 class="gh-header-title instapaper_title">Reference Manual</h1>
        <div class="gh-header-meta">
          Felipe Zimmerle edited this page <relative-time datetime="2017-09-25T17:09:28Z">Sep 25, 2017</relative-time>
          &middot;
          <a href="/SpiderLabs/ModSecurity/wiki/Reference-Manual/_history" class="history">
            166 revisions
          </a>
        </div>
    </div>
  </div>
  <div id="wiki-content" class="wiki-content">
    <div class="has-rightbar">

    <div id="wiki-rightbar" class="wiki-rightbar">
      <div class="wiki-pages-box readability-sidebar boxed-group flush js-wiki-pages-box " role="navigation">
        
<h3 class="js-wiki-toggle-collapse wiki-auxiliary-content">
  <svg aria-hidden="true" class="octicon octicon-triangle-down caret-expanded" height="16" version="1.1" viewBox="0 0 12 16" width="12"><path fill-rule="evenodd" d="M0 5l6 6 6-6z"/></svg>
  <svg aria-hidden="true" class="octicon octicon-triangle-right caret-collapsed" height="16" version="1.1" viewBox="0 0 6 16" width="6"><path fill-rule="evenodd" d="M0 14l6-6-6-6z"/></svg>
  Pages <span class="Counter">16</span>
</h3>
<div class="boxed-group-inner wiki-auxiliary-content wiki-auxiliary-content-no-bg">
    <div class="filter-bar">
      <input type="text" id="wiki-pages-filter" class="form-control input-sm input-block js-filterable-field" placeholder="Find a Page…" aria-label="Find a Page…" tabindex="2">
    </div>

  <ul class="wiki-pages" data-filterable-for="wiki-pages-filter" data-filterable-type="substring">
    <li>
      <strong><a href="/SpiderLabs/ModSecurity/wiki" class="wiki-page-link">Home</a></strong>
    </li>
    <li>
      <strong><a href="/SpiderLabs/ModSecurity/wiki/Compilation-recipes" class="wiki-page-link">Compilation recipes</a></strong>
    </li>
    <li>
      <strong><a href="/SpiderLabs/ModSecurity/wiki/Debugging-ModSecurity" class="wiki-page-link">Debugging ModSecurity</a></strong>
    </li>
    <li>
      <strong><a href="/SpiderLabs/ModSecurity/wiki/Ideas-for-Google-Summer-of-Code-2016" class="wiki-page-link">Ideas for Google Summer of Code 2016</a></strong>
    </li>
    <li>
      <strong><a href="/SpiderLabs/ModSecurity/wiki/IIS-Troubleshooting" class="wiki-page-link">IIS Troubleshooting</a></strong>
    </li>
    <li>
      <strong><a href="/SpiderLabs/ModSecurity/wiki/ModSecurity-2-Data-Formats" class="wiki-page-link">ModSecurity 2 Data Formats</a></strong>
    </li>
    <li>
      <strong><a href="/SpiderLabs/ModSecurity/wiki/ModSecurity-Frequently-Asked-Questions-(FAQ)" class="wiki-page-link">ModSecurity Frequently Asked Questions (FAQ)</a></strong>
    </li>
    <li>
      <strong><a href="/SpiderLabs/ModSecurity/wiki/ModSecurity-Migration-Matrix" class="wiki-page-link">ModSecurity Migration Matrix</a></strong>
    </li>
    <li>
      <strong><a href="/SpiderLabs/ModSecurity/wiki/ModSecurity-Rules-Language-Porting-Specification" class="wiki-page-link">ModSecurity Rules Language Porting Specification</a></strong>
    </li>
    <li>
      <strong><a href="/SpiderLabs/ModSecurity/wiki/ModSecurity-version-3-(earlier-release-candidate-1)" class="wiki-page-link">ModSecurity version 3 (earlier release candidate 1)</a></strong>
    </li>
    <li>
      <strong><a href="/SpiderLabs/ModSecurity/wiki/ModSecurity-version-3-RC1" class="wiki-page-link">ModSecurity version 3 RC1</a></strong>
    </li>
    <li>
      <strong><a href="/SpiderLabs/ModSecurity/wiki/ModSecurity-Wiki" class="wiki-page-link">ModSecurity Wiki</a></strong>
    </li>
    <li>
      <strong><a href="/SpiderLabs/ModSecurity/wiki/Package-Generation" class="wiki-page-link">Package Generation</a></strong>
    </li>
    <li>
      <strong><a href="/SpiderLabs/ModSecurity/wiki/Reference-Manual" class="wiki-page-link">Reference Manual</a></strong>
    </li>
    <li>
      <strong><a href="/SpiderLabs/ModSecurity/wiki/RoadMap" class="wiki-page-link">RoadMap</a></strong>
    </li>
    <li class="wiki-more-pages">
      <strong><a href="/SpiderLabs/ModSecurity/wiki/Tools" class="wiki-page-link">Tools</a></strong>
    </li>
    <li class="wiki-more-pages-link">
      <a href="#" class="js-wiki-more-pages-link">
        Show 1 more pages…
      </a>
    </li>
  </ul>
</div>

      </div>


      <h5 class="mt-0 mb-2">Clone this wiki locally</h5>
      <div class="width-full input-group js-zeroclipboard-container">
        <input type="text" class="form-control input-sm text-small text-gray input-monospace js-url-field js-zeroclipboard-target" aria-label="Clone URL for this wiki"
               value="https://github.com/SpiderLabs/ModSecurity.wiki.git" readonly="readonly">
        <span class="input-group-button">
          <button aria-label="Copy to clipboard" class="js-zeroclipboard btn btn-sm zeroclipboard-button tooltipped tooltipped-s" data-copied-hint="Copied!" type="button"><svg aria-hidden="true" class="octicon octicon-clippy" height="16" version="1.1" viewBox="0 0 14 16" width="14"><path fill-rule="evenodd" d="M2 13h4v1H2v-1zm5-6H2v1h5V7zm2 3V8l-3 3 3 3v-2h5v-2H9zM4.5 9H2v1h2.5V9zM2 12h2.5v-1H2v1zm9 1h1v2c-.02.28-.11.52-.3.7-.19.18-.42.28-.7.3H1c-.55 0-1-.45-1-1V4c0-.55.45-1 1-1h3c0-1.11.89-2 2-2 1.11 0 2 .89 2 2h3c.55 0 1 .45 1 1v5h-1V6H1v9h10v-2zM2 5h8c0-.55-.45-1-1-1H8c-.55 0-1-.45-1-1s-.45-1-1-1-1 .45-1 1-.45 1-1 1H3c-.55 0-1 .45-1 1z"/></svg></button>
        </span>
      </div>


    </div>

    <div id="wiki-body" class="wiki-body gollum-mediawiki-content instapaper_body">
        <div class="markdown-body">
          
<table summary="Contents"><tr><td>
<div><h2>
<a id="user-content-table-of-contents" class="anchor" href="#table-of-contents" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Table of Contents</h2></div>
<ul>
<li>
<a href="#ModSecurityreg_Reference_Manual">ModSecurity® Reference Manual</a><ul><li>
<a href="#Current_as_of_v2513_v26_v27_v28_v29_v30rc">Current as of v2.5.13 v2.6 v2.7 v2.8 v2.9 v3.0(rc)</a><ul><li><a href="#Copyright_copy_20042017_httpswwwtrustwavecom_Trustwave_Holdings_Inc">Copyright © 2004-2017 [https://www.trustwave.com/ Trustwave Holdings, Inc.]</a></li></ul>
</li></ul>
</li>
<li><a href="#Table_of_Contents">Table of Contents</a></li>
<li>
<a href="#Introduction">Introduction</a><ul>
<li><a href="#RealTime_Monitoring_and_Attack_Detection">Real-Time Monitoring and Attack Detection</a></li>
<li><a href="#Attack_Prevention_and_Virtual_Patching">Attack Prevention and Virtual Patching</a></li>
<li><a href="#Flexible_Rule_Engine">Flexible Rule Engine</a></li>
<li><a href="#Embeddedmode_Deployment">Embedded-mode Deployment</a></li>
<li><a href="#Networkbased_Deployment">Network-based Deployment</a></li>
<li><a href="#Portability">Portability</a></li>
<li><a href="#Licensing">Licensing</a></li>
</ul>
</li>
<li>
<a href="#OWASP_ModSecurity_Core_Rule_Set_CRS_Project">OWASP ModSecurity Core Rule Set (CRS) Project</a><ul>
<li><a href="#Overview">Overview</a></li>
<li><a href="#Core_Rules_Content">Core Rules Content</a></li>
</ul>
</li>
<li>
<a href="#Installation_for_Apache">Installation for Apache</a><ul>
<li>
<a href="#Prerequisites">Prerequisites</a><ul>
<li><a href="#ModSecurity_2x_works_only_with_Apache_20x_or_higher">ModSecurity 2.x works only with Apache 2.0.x or higher</a></li>
<li><a href="#mod_uniqueid">mod_uniqueid</a></li>
<li><a href="#libapr_and_libaprutil">libapr and libapr-util</a></li>
<li><a href="#libpcre">libpcre</a></li>
<li><a href="#libxml2">libxml2</a></li>
<li><a href="#liblua_v51x">liblua v5.1.x</a></li>
<li><a href="#libcurl_v7151_or_higher">libcurl v7.15.1 or higher</a></li>
</ul>
</li>
<li><a href="#Installation_Methods">Installation Methods</a></li>
<li><a href="#GitHub_Access">GitHub Access</a></li>
<li><a href="#Stable_Release_Download">Stable Release Download</a></li>
<li>
<a href="#Installation_Steps">Installation Steps</a><ul>
<li><a href="#UNIX">UNIX</a></li>
<li><a href="#Windows_MS_VC_8">Windows (MS VC++ 8)</a></li>
<li><a href="#Edit_the_main_Apache_httpd_config_file_usually_httpdconf">Edit the main Apache httpd config file (usually httpd.conf)</a></li>
<li><a href="#Configure_ModSecurity">Configure ModSecurity</a></li>
<li><a href="#Start_Apache_httpd">Start Apache httpd</a></li>
</ul>
</li>
</ul>
</li>
<li>
<a href="#Installation_for_NGINX">Installation for NGINX</a><ul><li>
<a href="#Manually_Installing_ModSecurity_Module_on_NGINX">Manually Installing ModSecurity Module on NGINX</a><ul>
<li><a href="#Preinstallation_Steps">Preinstallation Steps</a></li>
<li><a href="#Installation_Steps-2">Installation Steps</a></li>
<li><a href="#Configuration_Steps">Configuration Steps</a></li>
</ul>
</li></ul>
</li>
<li>
<a href="#Installation_for_Microsoft_IIS">Installation for Microsoft IIS</a><ul>
<li>
<a href="#Manually_Installing_and_Troubleshooting_Setup_of_ModSecurity_Module_on_IIS">Manually Installing and Troubleshooting Setup of ModSecurity Module on IIS</a><ul><li><a href="#Configuration">Configuration</a></li></ul>
</li>
<li><a href="#Common_Problems">Common Problems</a></li>
</ul>
</li>
<li>
<a href="#Configuration_Directives">Configuration Directives</a><ul>
<li><a href="#SecAction">SecAction</a></li>
<li><a href="#SecArgumentSeparator">SecArgumentSeparator</a></li>
<li><a href="#SecAuditEngine">SecAuditEngine</a></li>
<li><a href="#SecAuditLog">SecAuditLog</a></li>
<li><a href="#SecAuditLog2">SecAuditLog2</a></li>
<li><a href="#SecAuditLogDirMode">SecAuditLogDirMode</a></li>
<li><a href="#SecAuditLogFormat">SecAuditLogFormat</a></li>
<li><a href="#SecAuditLogFileMode">SecAuditLogFileMode</a></li>
<li><a href="#SecAuditLogParts">SecAuditLogParts</a></li>
<li><a href="#SecAuditLogRelevantStatus">SecAuditLogRelevantStatus</a></li>
<li><a href="#SecAuditLogStorageDir">SecAuditLogStorageDir</a></li>
<li><a href="#SecAuditLogType">SecAuditLogType</a></li>
<li><a href="#SecCacheTransformations">SecCacheTransformations</a></li>
<li><a href="#SecChrootDir">SecChrootDir</a></li>
<li><a href="#SecCollectionTimeout">SecCollectionTimeout</a></li>
<li><a href="#SecComponentSignature">SecComponentSignature</a></li>
<li><a href="#SecConnEngine">SecConnEngine</a></li>
<li><a href="#SecContentInjection">SecContentInjection</a></li>
<li><a href="#SecCookieFormat">SecCookieFormat</a></li>
<li><a href="#SecCookieV0Separator">SecCookieV0Separator</a></li>
<li><a href="#SecDataDir">SecDataDir</a></li>
<li><a href="#SecDebugLog">SecDebugLog</a></li>
<li><a href="#SecDebugLogLevel">SecDebugLogLevel</a></li>
<li><a href="#SecDefaultAction">SecDefaultAction</a></li>
<li><a href="#SecDisableBackendCompression">SecDisableBackendCompression</a></li>
<li><a href="#SecHashEngine">SecHashEngine</a></li>
<li><a href="#SecHashKey">SecHashKey</a></li>
<li><a href="#SecHashParam">SecHashParam</a></li>
<li><a href="#SecHashMethodRx">SecHashMethodRx</a></li>
<li><a href="#SecHashMethodPm">SecHashMethodPm</a></li>
<li><a href="#SecGeoLookupDb">SecGeoLookupDb</a></li>
<li><a href="#SecGsbLookupDb">SecGsbLookupDb</a></li>
<li><a href="#SecGuardianLog">SecGuardianLog</a></li>
<li><a href="#SecHttpBlKey">SecHttpBlKey</a></li>
<li><a href="#SecInterceptOnError">SecInterceptOnError</a></li>
<li><a href="#SecMarker">SecMarker</a></li>
<li><a href="#SecPcreMatchLimit">SecPcreMatchLimit</a></li>
<li><a href="#SecPcreMatchLimitRecursion">SecPcreMatchLimitRecursion</a></li>
<li><a href="#SecPdfProtect">SecPdfProtect</a></li>
<li><a href="#SecPdfProtectMethod">SecPdfProtectMethod</a></li>
<li><a href="#SecPdfProtectSecret">SecPdfProtectSecret</a></li>
<li><a href="#SecPdfProtectTimeout">SecPdfProtectTimeout</a></li>
<li><a href="#SecPdfProtectTokenName">SecPdfProtectTokenName</a></li>
<li><a href="#SecReadStateLimit">SecReadStateLimit</a></li>
<li><a href="#SecConnReadStateLimit">SecConnReadStateLimit</a></li>
<li><a href="#SecSensorId">SecSensorId</a></li>
<li><a href="#SecWriteStateLimit">SecWriteStateLimit</a></li>
<li><a href="#SecConnWriteStateLimit">SecConnWriteStateLimit</a></li>
<li><a href="#SecRemoteRules">SecRemoteRules</a></li>
<li><a href="#SecRemoteRulesFailAction">SecRemoteRulesFailAction</a></li>
<li><a href="#SecRequestBodyAccess">SecRequestBodyAccess</a></li>
<li><a href="#SecRequestBodyInMemoryLimit">SecRequestBodyInMemoryLimit</a></li>
<li><a href="#SecRequestBodyLimit">SecRequestBodyLimit</a></li>
<li><a href="#SecRequestBodyNoFilesLimit">SecRequestBodyNoFilesLimit</a></li>
<li><a href="#SecRequestBodyLimitAction">SecRequestBodyLimitAction</a></li>
<li><a href="#SecResponseBodyLimit">SecResponseBodyLimit</a></li>
<li><a href="#SecResponseBodyLimitAction">SecResponseBodyLimitAction</a></li>
<li><a href="#SecResponseBodyMimeType">SecResponseBodyMimeType</a></li>
<li><a href="#SecResponseBodyMimeTypesClear">SecResponseBodyMimeTypesClear</a></li>
<li><a href="#SecResponseBodyAccess">SecResponseBodyAccess</a></li>
<li><a href="#SecRule">SecRule</a></li>
<li><a href="#SecRuleInheritance">SecRuleInheritance</a></li>
<li><a href="#SecRuleEngine">SecRuleEngine</a></li>
<li><a href="#SecRulePerfTime">SecRulePerfTime</a></li>
<li><a href="#SecRuleRemoveById">SecRuleRemoveById</a></li>
<li><a href="#SecRuleRemoveByMsg">SecRuleRemoveByMsg</a></li>
<li><a href="#SecRuleRemoveByTag">SecRuleRemoveByTag</a></li>
<li><a href="#SecRuleScript">SecRuleScript</a></li>
<li><a href="#SecRuleUpdateActionById">SecRuleUpdateActionById</a></li>
<li><a href="#SecRuleUpdateTargetById">SecRuleUpdateTargetById</a></li>
<li><a href="#SecRuleUpdateTargetByMsg">SecRuleUpdateTargetByMsg</a></li>
<li><a href="#SecRuleUpdateTargetByTag">SecRuleUpdateTargetByTag</a></li>
<li><a href="#SecServerSignature">SecServerSignature</a></li>
<li><a href="#SecStatusEngine">SecStatusEngine</a></li>
<li><a href="#SecStreamInBodyInspection">SecStreamInBodyInspection</a></li>
<li><a href="#SecStreamOutBodyInspection">SecStreamOutBodyInspection</a></li>
<li><a href="#SecTmpDir">SecTmpDir</a></li>
<li><a href="#SecUnicodeMapFile">SecUnicodeMapFile</a></li>
<li><a href="#SecUnicodeCodePage">SecUnicodeCodePage</a></li>
<li><a href="#SecUploadDir">SecUploadDir</a></li>
<li><a href="#SecUploadFileLimit">SecUploadFileLimit</a></li>
<li><a href="#SecUploadFileMode">SecUploadFileMode</a></li>
<li><a href="#SecUploadKeepFiles">SecUploadKeepFiles</a></li>
<li><a href="#SecWebAppId">SecWebAppId</a></li>
<li><a href="#SecXmlExternalEntity">SecXmlExternalEntity</a></li>
</ul>
</li>
<li>
<a href="#Processing_Phases">Processing Phases</a><ul>
<li><a href="#Phase_Request_Headers">Phase Request Headers</a></li>
<li><a href="#Phase_Request_Body">Phase Request Body</a></li>
<li><a href="#Phase_Response_Headers">Phase Response Headers</a></li>
<li><a href="#Phase_Response_Body">Phase Response Body</a></li>
<li><a href="#Phase_Logging">Phase Logging</a></li>
</ul>
</li>
<li>
<a href="#Variables">Variables</a><ul>
<li><a href="#ARGS">ARGS</a></li>
<li><a href="#ARGS_COMBINED_SIZE">ARGS_COMBINED_SIZE</a></li>
<li><a href="#ARGS_GET">ARGS_GET</a></li>
<li><a href="#ARGS_GET_NAMES">ARGS_GET_NAMES</a></li>
<li><a href="#ARGS_NAMES">ARGS_NAMES</a></li>
<li><a href="#ARGS_POST">ARGS_POST</a></li>
<li><a href="#ARGS_POST_NAMES">ARGS_POST_NAMES</a></li>
<li><a href="#AUTH_TYPE">AUTH_TYPE</a></li>
<li><a href="#DURATION">DURATION</a></li>
<li><a href="#ENV">ENV</a></li>
<li><a href="#FILES">FILES</a></li>
<li><a href="#FILES_COMBINED_SIZE">FILES_COMBINED_SIZE</a></li>
<li><a href="#FILES_NAMES">FILES_NAMES</a></li>
<li><a href="#FULL_REQUEST">FULL_REQUEST</a></li>
<li><a href="#FULL_REQUEST_LENGTH">FULL_REQUEST_LENGTH</a></li>
<li><a href="#FILES_SIZES">FILES_SIZES</a></li>
<li><a href="#FILES_TMPNAMES">FILES_TMPNAMES</a></li>
<li><a href="#FILES_TMP_CONTENT">FILES_TMP_CONTENT</a></li>
<li><a href="#GEO">GEO</a></li>
<li><a href="#HIGHEST_SEVERITY">HIGHEST_SEVERITY</a></li>
<li><a href="#INBOUND_DATA_ERROR">INBOUND_DATA_ERROR</a></li>
<li><a href="#MATCHED_VAR">MATCHED_VAR</a></li>
<li><a href="#MATCHED_VARS">MATCHED_VARS</a></li>
<li><a href="#MATCHED_VAR_NAME">MATCHED_VAR_NAME</a></li>
<li><a href="#MATCHED_VARS_NAMES">MATCHED_VARS_NAMES</a></li>
<li><a href="#MODSEC_BUILD">MODSEC_BUILD</a></li>
<li><a href="#MULTIPART_CRLF_LF_LINES">MULTIPART_CRLF_LF_LINES</a></li>
<li><a href="#MULTIPART_FILENAME">MULTIPART_FILENAME</a></li>
<li><a href="#MULTIPART_NAME">MULTIPART_NAME</a></li>
<li><a href="#MULTIPART_STRICT_ERROR">MULTIPART_STRICT_ERROR</a></li>
<li><a href="#MULTIPART_UNMATCHED_BOUNDARY">MULTIPART_UNMATCHED_BOUNDARY</a></li>
<li><a href="#OUTBOUND_DATA_ERROR">OUTBOUND_DATA_ERROR</a></li>
<li><a href="#PATH_INFO">PATH_INFO</a></li>
<li><a href="#PERF_ALL">PERF_ALL</a></li>
<li><a href="#PERF_COMBINED">PERF_COMBINED</a></li>
<li><a href="#PERF_GC">PERF_GC</a></li>
<li><a href="#PERF_LOGGING">PERF_LOGGING</a></li>
<li><a href="#PERF_PHASE1">PERF_PHASE1</a></li>
<li><a href="#PERF_PHASE2">PERF_PHASE2</a></li>
<li><a href="#PERF_PHASE3">PERF_PHASE3</a></li>
<li><a href="#PERF_PHASE4">PERF_PHASE4</a></li>
<li><a href="#PERF_PHASE5">PERF_PHASE5</a></li>
<li><a href="#PERF_RULES">PERF_RULES</a></li>
<li><a href="#PERF_SREAD">PERF_SREAD</a></li>
<li><a href="#PERF_SWRITE">PERF_SWRITE</a></li>
<li><a href="#QUERY_STRING">QUERY_STRING</a></li>
<li><a href="#REMOTE_ADDR">REMOTE_ADDR</a></li>
<li><a href="#REMOTE_HOST">REMOTE_HOST</a></li>
<li><a href="#REMOTE_PORT">REMOTE_PORT</a></li>
<li><a href="#REMOTE_USER">REMOTE_USER</a></li>
<li><a href="#REQBODY_ERROR">REQBODY_ERROR</a></li>
<li><a href="#REQBODY_ERROR_MSG">REQBODY_ERROR_MSG</a></li>
<li><a href="#REQBODY_PROCESSOR">REQBODY_PROCESSOR</a></li>
<li><a href="#REQUEST_BASENAME">REQUEST_BASENAME</a></li>
<li><a href="#REQUEST_BODY">REQUEST_BODY</a></li>
<li><a href="#REQUEST_BODY_LENGTH">REQUEST_BODY_LENGTH</a></li>
<li><a href="#REQUEST_COOKIES">REQUEST_COOKIES</a></li>
<li><a href="#REQUEST_COOKIES_NAMES">REQUEST_COOKIES_NAMES</a></li>
<li><a href="#REQUEST_FILENAME">REQUEST_FILENAME</a></li>
<li><a href="#REQUEST_HEADERS">REQUEST_HEADERS</a></li>
<li><a href="#REQUEST_HEADERS_NAMES">REQUEST_HEADERS_NAMES</a></li>
<li><a href="#REQUEST_LINE">REQUEST_LINE</a></li>
<li><a href="#REQUEST_METHOD">REQUEST_METHOD</a></li>
<li><a href="#REQUEST_PROTOCOL">REQUEST_PROTOCOL</a></li>
<li><a href="#REQUEST_URI">REQUEST_URI</a></li>
<li><a href="#REQUEST_URI_RAW">REQUEST_URI_RAW</a></li>
<li><a href="#RESPONSE_BODY">RESPONSE_BODY</a></li>
<li><a href="#RESPONSE_CONTENT_LENGTH">RESPONSE_CONTENT_LENGTH</a></li>
<li><a href="#RESPONSE_CONTENT_TYPE">RESPONSE_CONTENT_TYPE</a></li>
<li><a href="#RESPONSE_HEADERS">RESPONSE_HEADERS</a></li>
<li><a href="#RESPONSE_HEADERS_NAMES">RESPONSE_HEADERS_NAMES</a></li>
<li><a href="#RESPONSE_PROTOCOL">RESPONSE_PROTOCOL</a></li>
<li><a href="#RESPONSE_STATUS">RESPONSE_STATUS</a></li>
<li><a href="#RULE">RULE</a></li>
<li><a href="#SCRIPT_BASENAME">SCRIPT_BASENAME</a></li>
<li><a href="#SCRIPT_FILENAME">SCRIPT_FILENAME</a></li>
<li><a href="#SCRIPT_GID">SCRIPT_GID</a></li>
<li><a href="#SCRIPT_GROUPNAME">SCRIPT_GROUPNAME</a></li>
<li><a href="#SCRIPT_MODE">SCRIPT_MODE</a></li>
<li><a href="#SCRIPT_UID">SCRIPT_UID</a></li>
<li><a href="#SCRIPT_USERNAME">SCRIPT_USERNAME</a></li>
<li><a href="#SDBM_DELETE_ERROR">SDBM_DELETE_ERROR</a></li>
<li><a href="#SERVER_ADDR">SERVER_ADDR</a></li>
<li><a href="#SERVER_NAME">SERVER_NAME</a></li>
<li><a href="#SERVER_PORT">SERVER_PORT</a></li>
<li><a href="#SESSION">SESSION</a></li>
<li><a href="#SESSIONID">SESSIONID</a></li>
<li><a href="#STATUS_LINE">STATUS_LINE</a></li>
<li><a href="#STREAM_INPUT_BODY">STREAM_INPUT_BODY</a></li>
<li><a href="#STREAM_OUTPUT_BODY">STREAM_OUTPUT_BODY</a></li>
<li><a href="#TIME">TIME</a></li>
<li><a href="#TIME_DAY">TIME_DAY</a></li>
<li><a href="#TIME_EPOCH">TIME_EPOCH</a></li>
<li><a href="#TIME_HOUR">TIME_HOUR</a></li>
<li><a href="#TIME_MIN">TIME_MIN</a></li>
<li><a href="#TIME_MON">TIME_MON</a></li>
<li><a href="#TIME_SEC">TIME_SEC</a></li>
<li><a href="#TIME_WDAY">TIME_WDAY</a></li>
<li><a href="#TIME_YEAR">TIME_YEAR</a></li>
<li><a href="#TX">TX</a></li>
<li><a href="#UNIQUE_ID">UNIQUE_ID</a></li>
<li><a href="#URLENCODED_ERROR">URLENCODED_ERROR</a></li>
<li><a href="#USERID">USERID</a></li>
<li><a href="#USERAGENT_IP">USERAGENT_IP</a></li>
<li><a href="#WEBAPPID">WEBAPPID</a></li>
<li><a href="#WEBSERVER_ERROR_LOG">WEBSERVER_ERROR_LOG</a></li>
<li><a href="#XML">XML</a></li>
</ul>
</li>
<li>
<a href="#Transformation_functions">Transformation functions</a><ul>
<li><a href="#base64Decode">base64Decode</a></li>
<li><a href="#sqlHexDecode">sqlHexDecode</a></li>
<li><a href="#base64DecodeExt">base64DecodeExt</a></li>
<li><a href="#base64Encode">base64Encode</a></li>
<li><a href="#cmdLine">cmdLine</a></li>
<li><a href="#compressWhitespace">compressWhitespace</a></li>
<li><a href="#cssDecode">cssDecode</a></li>
<li><a href="#escapeSeqDecode">escapeSeqDecode</a></li>
<li><a href="#hexDecode">hexDecode</a></li>
<li><a href="#hexEncode">hexEncode</a></li>
<li><a href="#htmlEntityDecode">htmlEntityDecode</a></li>
<li><a href="#jsDecode">jsDecode</a></li>
<li><a href="#length">length</a></li>
<li><a href="#lowercase">lowercase</a></li>
<li><a href="#md5">md5</a></li>
<li><a href="#none">none</a></li>
<li><a href="#normalisePath">normalisePath</a></li>
<li><a href="#normalizePath">normalizePath</a></li>
<li><a href="#normalisePathWin">normalisePathWin</a></li>
<li><a href="#normalizePathWin">normalizePathWin</a></li>
<li><a href="#parityEven7bit">parityEven7bit</a></li>
<li><a href="#parityOdd7bit">parityOdd7bit</a></li>
<li><a href="#parityZero7bit">parityZero7bit</a></li>
<li><a href="#removeNulls">removeNulls</a></li>
<li><a href="#removeWhitespace">removeWhitespace</a></li>
<li><a href="#replaceComments">replaceComments</a></li>
<li><a href="#removeCommentsChar">removeCommentsChar</a></li>
<li><a href="#removeComments">removeComments</a></li>
<li><a href="#replaceNulls">replaceNulls</a></li>
<li><a href="#urlDecode">urlDecode</a></li>
<li><a href="#uppercase">uppercase</a></li>
<li><a href="#urlDecodeUni">urlDecodeUni</a></li>
<li><a href="#urlEncode">urlEncode</a></li>
<li><a href="#utf8toUnicode">utf8toUnicode</a></li>
<li><a href="#sha1">sha1</a></li>
<li><a href="#trimLeft">trimLeft</a></li>
<li><a href="#trimRight">trimRight</a></li>
<li><a href="#trim">trim</a></li>
</ul>
</li>
<li>
<a href="#Actions">Actions</a><ul>
<li><a href="#accuracy">accuracy</a></li>
<li><a href="#allow">allow</a></li>
<li><a href="#append">append</a></li>
<li><a href="#auditlog">auditlog</a></li>
<li><a href="#block">block</a></li>
<li><a href="#capture">capture</a></li>
<li><a href="#chain">chain</a></li>
<li><a href="#ctl">ctl</a></li>
<li><a href="#deny">deny</a></li>
<li><a href="#deprecatevar">deprecatevar</a></li>
<li><a href="#drop">drop</a></li>
<li><a href="#exec">exec</a></li>
<li><a href="#expirevar">expirevar</a></li>
<li><a href="#id">id</a></li>
<li><a href="#initcol">initcol</a></li>
<li><a href="#log">log</a></li>
<li><a href="#logdata">logdata</a></li>
<li><a href="#maturity">maturity</a></li>
<li><a href="#msg">msg</a></li>
<li><a href="#multiMatch">multiMatch</a></li>
<li><a href="#noauditlog">noauditlog</a></li>
<li><a href="#nolog">nolog</a></li>
<li><a href="#pass">pass</a></li>
<li><a href="#pause">pause</a></li>
<li><a href="#phase">phase</a></li>
<li><a href="#prepend">prepend</a></li>
<li><a href="#proxy">proxy</a></li>
<li><a href="#redirect">redirect</a></li>
<li><a href="#rev">rev</a></li>
<li><a href="#sanitiseArg">sanitiseArg</a></li>
<li><a href="#sanitiseMatched">sanitiseMatched</a></li>
<li><a href="#sanitiseMatchedBytes">sanitiseMatchedBytes</a></li>
<li><a href="#sanitiseRequestHeader">sanitiseRequestHeader</a></li>
<li><a href="#sanitiseResponseHeader">sanitiseResponseHeader</a></li>
<li><a href="#severity">severity</a></li>
<li><a href="#setuid">setuid</a></li>
<li><a href="#setrsc">setrsc</a></li>
<li><a href="#setsid">setsid</a></li>
<li><a href="#setenv">setenv</a></li>
<li><a href="#setvar">setvar</a></li>
<li><a href="#skip">skip</a></li>
<li><a href="#skipAfter">skipAfter</a></li>
<li><a href="#status">status</a></li>
<li><a href="#t">t</a></li>
<li><a href="#tag">tag</a></li>
<li><a href="#ver">ver</a></li>
<li><a href="#xmlns">xmlns</a></li>
</ul>
</li>
<li>
<a href="#Operators">Operators</a><ul>
<li><a href="#beginsWith">beginsWith</a></li>
<li><a href="#contains">contains</a></li>
<li><a href="#containsWord">containsWord</a></li>
<li><a href="#detectSQLi">detectSQLi</a></li>
<li><a href="#detectXSS">detectXSS</a></li>
<li><a href="#endsWith">endsWith</a></li>
<li><a href="#fuzzyHash">fuzzyHash</a></li>
<li><a href="#eq">eq</a></li>
<li><a href="#ge">ge</a></li>
<li><a href="#geoLookup">geoLookup</a></li>
<li><a href="#gsbLookup">gsbLookup</a></li>
<li><a href="#gt">gt</a></li>
<li><a href="#inspectFile">inspectFile</a></li>
<li><a href="#ipMatch">ipMatch</a></li>
<li><a href="#ipMatchF">ipMatchF</a></li>
<li><a href="#ipMatchFromFile">ipMatchFromFile</a></li>
<li><a href="#le">le</a></li>
<li><a href="#lt">lt</a></li>
<li><a href="#noMatch">noMatch</a></li>
<li><a href="#pm">pm</a></li>
<li><a href="#pmf">pmf</a></li>
<li><a href="#pmFromFile">pmFromFile</a></li>
<li><a href="#rbl">rbl</a></li>
<li><a href="#rsub">rsub</a></li>
<li><a href="#rx">rx</a></li>
<li><a href="#streq">streq</a></li>
<li><a href="#strmatch">strmatch</a></li>
<li><a href="#unconditionalMatch">unconditionalMatch</a></li>
<li><a href="#validateByteRange">validateByteRange</a></li>
<li><a href="#validateDTD">validateDTD</a></li>
<li><a href="#validateHash">validateHash</a></li>
<li><a href="#validateSchema">validateSchema</a></li>
<li><a href="#validateUrlEncoding">validateUrlEncoding</a></li>
<li><a href="#validateUtf8Encoding">validateUtf8Encoding</a></li>
<li><a href="#verifyCC">verifyCC</a></li>
<li><a href="#verifyCPF">verifyCPF</a></li>
<li><a href="#verifySSN">verifySSN</a></li>
<li><a href="#within">within</a></li>
</ul>
</li>
<li><a href="#Macro_Expansion">Macro Expansion</a></li>
<li><a href="#Persistent_Storage">Persistent Storage</a></li>
<li>
<a href="#Miscellaneous_Topics">Miscellaneous Topics</a><ul>
<li><a href="#Logging_in_Apache_via_mod_log_config">Logging in Apache via mod_log_config</a></li>
<li><a href="#Precedence_of_ModSecurity_over_other_Apache_modules">Precedence of ModSecurity over other Apache modules</a></li>
</ul>
</li>
<li>
<a href="#A_Recommended_Base_Configuration">A Recommended Base Configuration</a><ul><li>
<a href="#Impedance_Mismatch">Impedance Mismatch</a><ul><li><a href="#Impedance_Mismatch_with_PHP_Apps">Impedance Mismatch with PHP Apps</a></li></ul>
</li></ul>
</li>
</ul>
</td></tr></table>
<h1>
<a id="user-content-modsecurity-reference-manual" class="anchor" href="#modsecurity-reference-manual" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-ModSecurityreg_Reference_Manual"></a><span>ModSecurity® Reference Manual</span>
</h1>



<h2>
<a id="user-content-current-as-of-v2513-v26-v27-v28-v29-v30rc" class="anchor" href="#current-as-of-v2513-v26-v27-v28-v29-v30rc" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-Current_as_of_v2513_v26_v27_v28_v29_v30rc"></a><span>Current as of v2.5.13 v2.6 v2.7 v2.8 v2.9 v3.0(rc)</span>
</h2>



<h3>
<a id="user-content-copyright--2004-2017-trustwave-holdings-inc" class="anchor" href="#copyright--2004-2017-trustwave-holdings-inc" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-Copyright_copy_20042017_a_hrefhttpswwwtrustwavecom_target_blankTrustwave_Holdings_Inca"></a><span>Copyright © 2004-2017 <a href="https://www.trustwave.com/">Trustwave Holdings, Inc.</a></span>
</h3>




<h1>
<a id="user-content-table-of-contents-1" class="anchor" href="#table-of-contents-1" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-Table_of_Contents"></a><span>Table of Contents</span>
</h1>



<h1>
<a id="user-content-introduction" class="anchor" href="#introduction" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-Introduction"></a><span>Introduction</span>
</h1>


<p>ModSecurity is a web application firewall (WAF). With over 70% of attacks now carried out over the web application level, organisations need all the help they can get in making their systems secure. WAFs are deployed to establish an increased external security layer to detect and/or prevent attacks before they reach web applications. ModSecurity provides protection from a range of attacks against web applications and allows for HTTP traffic monitoring and real-time analysis with little or no changes to existing infrastructure.
</p>
<p>== HTTP Traffic Logging ==SecGsbLookupDb
Web servers are typically well-equipped to log traffic in a form useful for marketing analyses, but fall short logging traffic to web applications. In particular, most are not capable of logging the request bodies. Your adversaries know this, and that is why most attacks are now carried out via POST requests, rendering your systems blind. ModSecurity makes full HTTP transaction logging possible, allowing complete requests and responses to be logged. Its logging facilities also allow fine-grained decisions to be made about exactly what is logged and when, ensuring only the relevant data is recorded. As some of the request and/or response may contain sensitive data in certain fields, ModSecurity can be configured to mask these fields before they are written to the audit log.
</p>

<h2>
<a id="user-content-real-time-monitoring-and-attack-detection" class="anchor" href="#real-time-monitoring-and-attack-detection" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-RealTime_Monitoring_and_Attack_Detection"></a><span>Real-Time Monitoring and Attack Detection</span>
</h2>


<p>In addition to providing logging facilities, ModSecurity can monitor the HTTP traffic in real time in order to detect attacks. In this case, ModSecurity operates as a web intrusion detection tool, allowing you to react to suspicious events that take place at your web systems.
</p>

<h2>
<a id="user-content-attack-prevention-and-virtual-patching" class="anchor" href="#attack-prevention-and-virtual-patching" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-Attack_Prevention_and_Virtual_Patching"></a><span>Attack Prevention and Virtual Patching</span>
</h2>


<p>ModSecurity can also act immediately to prevent attacks from reaching your web applications. There are three commonly used approaches:



</p><ol>
<li>Negative security model. A negative security model monitors requests for anomalies, unusual behaviour, and common web application attacks. It keeps anomaly scores for each request, IP addresses, application sessions, and user accounts. Requests with high anomaly scores are either logged or rejected altogether.</li>
<li>Positive security model. When a positive security model is deployed, only requests that are known to be valid are accepted, with everything else rejected. This model requires knowledge of the web applications you are protecting. Therefore a positive security model works best with applications that are heavily used but rarely updated so that maintenance of the model is minimized.</li>
<li>Known weaknesses and vulnerabilities. Its rule language makes ModSecurity an ideal external patching tool. External patching (sometimes referred to as Virtual Patching) is about reducing the window of opportunity. Time needed to patch application vulnerabilities often runs to weeks in many organisations. With ModSecurity, applications can be patched from the outside, without touching the application source code (and even without any access to it), making your systems secure until a proper patch is applied to the application.</li>
</ol>


<h2>
<a id="user-content-flexible-rule-engine" class="anchor" href="#flexible-rule-engine" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-Flexible_Rule_Engine"></a><span>Flexible Rule Engine</span>
</h2>


<p>A flexible rule engine sits in the heart of ModSecurity. It implements the ModSecurity Rule Language, which is a specialised programming language designed to work with HTTP transaction data. The ModSecurity Rule Language is designed to be easy to use, yet flexible: common operations are simple while complex operations are possible. Certified ModSecurity Rules, included with ModSecurity, contain a comprehensive set of rules that implement general-purpose hardening, protocol validation and detection of common web application security issues. Heavily commented, these rules can be used as a learning tool.
</p>

<h2>
<a id="user-content-embedded-mode-deployment" class="anchor" href="#embedded-mode-deployment" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-Embeddedmode_Deployment"></a><span>Embedded-mode Deployment</span>
</h2>


<p>ModSecurity is an embeddable web application firewall, which means it can be deployed as part of your existing web server infrastructure provided your web servers are either Apache, IIS7 or Nginx. This deployment method has certain advantages:
</p>





<ol>
<li>No changes to existing network. It only takes a few minutes to add ModSecurity to your existing web servers. And because it was designed to be completely passive by default, you are free to deploy it incrementally and only use the features you need. It is equally easy to remove or deactivate it if required.</li>
<li>No single point of failure. Unlike with network-based deployments, you will not be introducing a new point of failure to your system.</li>
<li>Implicit load balancing and scaling. Because it works embedded in web servers, ModSecurity will automatically take advantage of the additional load balancing and scalability features. You will not need to think of load balancing and scaling unless your existing system needs them.</li>
<li>Minimal overhead. Because it works from inside the web server process there is no overhead for network communication and minimal overhead in parsing and data exchange.</li>
<li>No problem with encrypted or compressed content. Many IDS systems have difficulties analysing SSL traffic. This is not a problem for ModSecurity because it is positioned to work when the traffic is decrypted and decompressed.</li>
</ol>


<h2>
<a id="user-content-network-based-deployment" class="anchor" href="#network-based-deployment" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-Networkbased_Deployment"></a><span>Network-based Deployment</span>
</h2>


<p>ModSecurity works equally well when deployed as part of a reverse proxy server, and many of our customers choose to do so. In this scenario, one installation of ModSecurity can protect any number of back-end web servers.
</p>

<h2>
<a id="user-content-portability" class="anchor" href="#portability" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-Portability"></a><span>Portability</span>
</h2>


<p>ModSecurity is known to work well on a wide range of operating systems. Our customers are successfully running it on Linux, Windows, Solaris, FreeBSD, OpenBSD, NetBSD, AIX, Mac OS X, and HP-UX.
</p>

<h2>
<a id="user-content-licensing" class="anchor" href="#licensing" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-Licensing"></a><span>Licensing</span>
</h2>


<p>ModSecurity is available under the Apache Software License v2 <a href="http://www.apache.org/licenses/LICENSE-2.0.txt">http://www.apache.org/licenses/LICENSE-2.0.txt</a>
</p>

<dl><dt>Note : ModSecurity, mod_security, ModSecurity Pro, and ModSecurity Core Rules are trademarks or registered trademarks of Trustwave Holdings, Inc.</dt></dl>


<h1>
<a id="user-content-owasp-modsecurity-core-rule-set-crs-project" class="anchor" href="#owasp-modsecurity-core-rule-set-crs-project" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-OWASP_ModSecurity_Core_Rule_Set_CRS_Project"></a><span>OWASP ModSecurity Core Rule Set (CRS) Project</span>
</h1>



<h2>
<a id="user-content-overview" class="anchor" href="#overview" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-Overview"></a><span>Overview</span>
</h2>


<p>ModSecurity is a web application firewall engine that provides very little protection on its own. In order to become useful, ModSecurity must be configured with rules. In order to enable users to take full advantage of ModSecurity out of the box, Trustwave's SpiderLabs created the OWASP ModSecurity Core Rule Set (CRS) Project. Unlike intrusion detection and prevention systems, which rely on signatures specific to known vulnerabilities, the CRS provide generic protection from unknown vulnerabilities often found in web applications, which are in most cases custom coded. The CRS is heavily commented to allow it to be used as a step-by-step deployment guide for ModSecurity. The latest rules packages can be found at the <a href="http://www.owasp.org/index.php/Category:OWASP_ModSecurity_Core_Rule_Set_Project">OWASP ModSecurity CRS Project Site</a>.
</p>

<h2>
<a id="user-content-core-rules-content" class="anchor" href="#core-rules-content" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-Core_Rules_Content"></a><span>Core Rules Content</span>
</h2>


<p>In order to provide generic web applications protection, the CRS use some of the following example techniques:
</p>





<ul>
<li>HTTP protection - detecting violations of the HTTP protocol and a locally defined usage policy.</li>
<li>Common Web Attacks Protection - detecting common web application security attack.</li>
<li>Automation detection - Detecting bots, crawlers, scanners and other surface malicious activity.</li>
<li>Trojan Protection - Detecting access to Trojans horses.</li>
<li>Error Hiding - Disguising error messages sent by the server.</li>
</ul>


<h1>
<a id="user-content-installation-for-apache" class="anchor" href="#installation-for-apache" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-Installation_for_Apache"></a><span>Installation for Apache</span>
</h1>



<h2>
<a id="user-content-prerequisites" class="anchor" href="#prerequisites" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-Prerequisites"></a><span>Prerequisites</span>
</h2>




<h3>
<a id="user-content-modsecurity-2x-works-only-with-apache-20x-or-higher" class="anchor" href="#modsecurity-2x-works-only-with-apache-20x-or-higher" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-ModSecurity_2x_works_only_with_Apache_20x_or_higher"></a><span>ModSecurity 2.x works only with Apache 2.0.x or higher</span>
</h3>


<p>The ModSecurity team works hard to ensure that ModSecurity version 2.x will work with all versions of Apache 2.x and higher. If you find incompatibilities on any version (2.2.x, 2.4.x, or 2.6.x) please immediately inform the ModSecurity team
</p>

<h3>
<a id="user-content-mod_uniqueid" class="anchor" href="#mod_uniqueid" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-mod_uniqueid"></a><span>mod_uniqueid</span>
</h3>


<p>Make sure you have <code>mod_unique_id</code> installed.
mod_unique_id is packaged with Apache httpd.
</p>

<h3>
<a id="user-content-libapr-and-libapr-util" class="anchor" href="#libapr-and-libapr-util" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-libapr_and_libaprutil"></a><span>libapr and libapr-util</span>
</h3>


<p>libapr and libapr-util - <a href="http://apr.apache.org/">http://apr.apache.org/</a>
</p>

<h3>
<a id="user-content-libpcre" class="anchor" href="#libpcre" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-libpcre"></a><span>libpcre</span>
</h3>


<p><a href="http://www.pcre.org/">http://www.pcre.org/</a>
</p>

<h3>
<a id="user-content-libxml2" class="anchor" href="#libxml2" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-libxml2"></a><span>libxml2</span>
</h3>


<p><a href="http://xmlsoft.org/downloads.html">http://xmlsoft.org/downloads.html</a>
</p>

<h3>
<a id="user-content-liblua-v51x" class="anchor" href="#liblua-v51x" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-liblua_v51x"></a><span>liblua v5.1.x</span>
</h3>


<p>This library is optional and only needed if you will be using the new Lua engine - <a href="http://www.lua.org/download.html">http://www.lua.org/download.html</a>
</p>

<dl><dt>Note : that ModSecurity requires the dynamic libraries. These are not built by default in the source distribution, so the binary distribution is recommended.</dt></dl>


<h3>
<a id="user-content-libcurl-v7151-or-higher" class="anchor" href="#libcurl-v7151-or-higher" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-libcurl_v7151_or_higher"></a><span>libcurl v7.15.1 or higher</span>
</h3>



<p>If you will be using the ModSecurity Log Collector (mlogc) to send audit logs to a central repository, then you will also need the curl library.
</p>
<p><a href="http://curl.haxx.se/libcurl/">http://curl.haxx.se/libcurl/</a>
</p>

<dl><dt>Note : Many have had issues with libcurl linked with the GnuTLS library for SSL/TLS support. It is recommended that the openssl library be used for SSL/TLS support in libcurl.</dt></dl>


<h2>
<a id="user-content-installation-methods" class="anchor" href="#installation-methods" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-Installation_Methods"></a><span>Installation Methods</span>
</h2>


<p>Before you begin with installation you will need to choose your preferred installation method. First you need to choose whether to install the latest version of ModSecurity directly from git (best features, but possibly unstable) or use the latest stable release (recommended). If you choose a stable release, it might be possible to install ModSecurity from binary. It is always possible to compile it from source code.
</p>
<p>The following few pages will give you more information on benefits of choosing one method over another.
</p>

<h2>
<a id="user-content-github-access" class="anchor" href="#github-access" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-GitHub_Access"></a><span>GitHub Access</span>
</h2>



<p>If you want to access the latest version of the module you need to get it from the git repository. The list of changes made since the last stable release is normally available on the web site (and in the file CHANGES). The git repository for ModSecurity is hosted by GitHub (<a href="http://www.github.com">http://www.github.com</a>). You can access it directly or view if through web using this address: <a href="https://github.com/SpiderLabs/ModSecurity">https://github.com/SpiderLabs/ModSecurity</a>
</p>
<p>To download the lastest TRUNK source code to your computer you need to execute the following command:
</p>
<p><b>git</b>
</p><pre>$git clone git://github.com/SpiderLabs/ModSecurity.git
$git checkout remotes/trunk
</pre>


<p>For v2.6.0 and above, the installation process has changed.  Follow these steps:






</p><ol>
<li>cd into the directory - <code>$cd ModSecurity</code></li>
<li>Run autogen.sh script - <code>$./autogen.sh</code></li>
<li>Run configure script - <code>$./configure</code></li>
<li>Run make - <code>$make</code></li>
<li>Run make install - <code>$make install</code></li>
<li>Copy the new mod_security2.so file into the proper Apache modules directory - <code>$cp /usr/local/modsecurity/lib/mod_security2.so /usr/local/apache/modules/</code></li>
</ol>


<h2>
<a id="user-content-stable-release-download" class="anchor" href="#stable-release-download" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-Stable_Release_Download"></a><span>Stable Release Download</span>
</h2>


<p>To download the stable release go to <a href="http://www.modsecurity.org/download/">http://www.modsecurity.org/download/</a>. Binary distributions are sometimes available. If they are, they are listed on the download page. If not download the source code distribution.
</p>

<h2>
<a id="user-content-installation-steps" class="anchor" href="#installation-steps" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-Installation_Steps"></a><span>Installation Steps</span>
</h2>






<ul>
<li>Stop Apache httpd</li>
<li>Unpack the ModSecurity archive</li>
<li>Build</li>
</ul>
Building differs for UNIX (or UNIX-like) operating systems and Windows.

<h3>
<a id="user-content-unix" class="anchor" href="#unix" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-UNIX"></a><span>UNIX</span>
</h3>


<p>Run the configure script to generate a Makefile. Typically no options are needed.
</p><pre>./configure</pre>
Options are available for more customization (use ./configure --help for a full list), but typically you will only need to specify the location of the apxs command installed by Apache httpd with the --with-apxs option.
<pre>./configure --with-apxs=/path/to/httpd-2.x.y/bin/apxs</pre>

<dl><dt>Note : There are certain configure options that are meant for debugging an other development use. If enabled, these options can substantially impact performance. These options include all --debug-* options as well as the --enable-performance-measurements options.</dt></dl>
Compile with:
<pre>make</pre>
Optionally test with: 
<pre>make CFLAGS=-DMSC_TEST test</pre>

<dl><dt>Note : This is step is still a bit experimental. If you have problems, please send the full output and error from the build to the support list. Most common issues are related to not finding the required headers and/or libraries.</dt></dl>
Optionally build the ModSecurity Log Collector with: 
<pre>make mlogc</pre>
Optionally install mlogc: Review the INSTALL file included in the apache2/mlogc-src directory in the distribution.
Install the ModSecurity module with:
<pre>make install</pre>


<h3>
<a id="user-content-windows-ms-vc-8" class="anchor" href="#windows-ms-vc-8" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-Windows_MS_VC_8"></a><span>Windows (MS VC++ 8)</span>
</h3>


<p>Edit Makefile.win to configure the Apache base and library paths.
Compile with: <code>nmake -f Makefile.win</code>
Install the ModSecurity module with: <code>nmake -f Makefile.win install</code>
Copy the libxml2.dll and lua5.1.dll to the Apache bin directory. Alternatively you can follow the step below for using LoadFile to load these libraries.

</p><dl><dt>Note : Users should follow the steps present in README_WINDOWS.txt into ModSecurity tarball.</dt></dl>


<h3>
<a id="user-content-edit-the-main-apache-httpd-config-file-usually-httpdconf" class="anchor" href="#edit-the-main-apache-httpd-config-file-usually-httpdconf" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-Edit_the_main_Apache_httpd_config_file_usually_httpdconf"></a><span>Edit the main Apache httpd config file (usually httpd.conf)</span>
</h3>


<p>On UNIX (and Windows if you did not copy the DLLs as stated above) you must load libxml2 and lua5.1 before ModSecurity with something like this:
</p><pre>LoadFile /usr/lib/libxml2.so
LoadFile /usr/lib/liblua5.1.so
</pre>
Load the ModSecurity module with:
<pre>LoadModule security2_module modules/mod_security2.so
</pre>

<h3>
<a id="user-content-configure-modsecurity" class="anchor" href="#configure-modsecurity" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-Configure_ModSecurity"></a><span>Configure ModSecurity</span>
</h3>



<h3>
<a id="user-content-start-apache-httpd" class="anchor" href="#start-apache-httpd" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-Start_Apache_httpd"></a><span>Start Apache httpd</span>
</h3>


<p>You should now have ModSecurity 2.x up and running.
</p>

<dl><dt>Note : If you have compiled Apache yourself you might experience problems compiling ModSecurity against PCRE. This is because Apache bundles PCRE but this library is also typically provided by the operating system. I would expect most (all) vendor-packaged Apache distributions to be configured to use an external PCRE library (so this should not be a problem).</dt></dl>


<dl><dd>You want to avoid Apache using the bundled PCRE library and ModSecurity linking against the one provided by the operating system. The easiest way to do this is to compile Apache against the PCRE library provided by the operating system (or you can compile it against the latest PCRE version you downloaded from the main PCRE distribution site). You can do this at configure time using the --with-pcre switch. If you are not in a position to recompile Apache, then, to compile ModSecurity successfully, you'd still need to have access to the bundled PCRE headers (they are available only in the Apache source code) and change the include path for ModSecurity (as you did in step 7 above) to point to them (via the --with-pcre ModSecurity configure option).</dd></dl>


<dl><dd>Do note that if your Apache is using an external PCRE library you can compile ModSecurity with WITH_PCRE_STUDY defined,which would possibly give you a slight performance edge in regular expression processing.</dd></dl>


<dl><dd>Non-gcc compilers may have problems running out-of-the-box as the current build system was designed around the gcc compiler and some compiler/linker flags may differ. To use a non-gcc compiler you may need some manual Makefile tweaks if issues cannot be solved by exporting custom CFLAGS and CPPFLAGS environment variables.</dd></dl>


<dl><dd>If you are upgrading from ModSecurity 1.x, please refer to the migration matrix at <a href="http://www.modsecurity.org/documentation/ModSecurity-Migration-Matrix.pdf">http://www.modsecurity.org/documentation/ModSecurity-Migration-Matrix.pdf</a></dd></dl>






<dl><dd>Starting with ModSecurity 2.7.0 there are a few important configuration options</dd></dl><ol>
<li>
<b>--enable-pcre-jit</b> - Enables JIT support from pcre &gt;= 8.20 that can improve regex performance.</li>
<li>
<b>--enable-lua-cache</b> - Enables lua vm caching that can improve lua script performance. Difference just appears if ModSecurity must run more than one script per transaction.</li>
<li>
<b>--enable-request-early</b> - On ModSecurity 2.6 phase one has been moved to phase 2 hook, if you want to play around it use this option.</li>
<li>
<b>--enable-htaccess-config</b> - It will allow the follow directives to be used into .htaccess files when AllowOverride Options is set :</li>
</ol>
<pre>        - SecAction
        - SecRule

        - SecRuleRemoveByMsg
        - SecRuleRemoveByTag
        - SecRuleRemoveById

        - SecRuleUpdateActionById
        - SecRuleUpdateTargetById
        - SecRuleUpdateTargetByTag
        - SecRuleUpdateTargetByMsg
</pre>


<h1>
<a id="user-content-installation-for-nginx" class="anchor" href="#installation-for-nginx" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-Installation_for_NGINX"></a><span>Installation for NGINX</span>
</h1>


<p>The extensibility model of the nginx server does not include dynamically loaded modules, thus ModSecurity must be compiled with the source code of the main server.  Since nginx is available on multiple Unix-based platforms (and also on Windows), for now the recommended way of obtaining ModSecurity for nginx is compilation in the designated environment.
</p>
<h2>
<a id="user-content-manually-installing-modsecurity-module-on-nginx" class="anchor" href="#manually-installing-modsecurity-module-on-nginx" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-Manually_Installing_ModSecurity_Module_on_NGINX"></a><span>Manually Installing ModSecurity Module on NGINX</span>
</h2>


<p>The first step in obtaining nginx server with built-in ModSecurity module is building of standalone library containing full ModSecurity with a set of intermediate APIs (this layer is a common base for IIS version, nginx version, and server-less command line version of ModSecurity). First prepare the build environment for ModSecurity and then follow the installation steps below.
The standalone ModSecurity is located at <a href="https://www.modsecurity.org/download.html">https://www.modsecurity.org/download.html</a>.
</p>
<h3>
<a id="user-content-preinstallation-steps" class="anchor" href="#preinstallation-steps" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-Preinstallation_Steps"></a><span>Preinstallation Steps</span>
</h3>


<p>To build the standalone module from source on a GNU/Linux platform, you need to install the standard and development packages for apache and prce. For example:
</p><pre># RHEL/CentOS style install. You may also need systemd-devel on newer versions

sudo yum install httpd httpd-devel pcre pcre-devel libxml2-devel 
</pre>
<pre># Debian style install
apt-get install apache2-threaded-dev libxml2-dev
</pre>
For details on why compiling ModSecurity for nginx requires these packages, see <a href="https://github.com/SpiderLabs/ModSecurity/issues/603">issue 603</a>.

<h3>
<a id="user-content-installation-steps-1" class="anchor" href="#installation-steps-1" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-Installation_Steps-2"></a><span>Installation Steps</span>
</h3>


<p>1. - Compile standalone module:
</p><pre>~/mod_security$ ./configure --enable-standalone-module --disable-mlogc
~/mod_security$ make
</pre>
Note that the path and name of the mod_security folder will differ based on what version and where you download the tarball from <a href="https://www.modsecurity.org/download.html">modsecurity.org</a>. 

<p>2. - Once the standalone library is built successfully, one can follow with building the nginx server, following the steps from the nginx build tutorial:
</p><pre>~/nginx-1.2.0$ ./configure --add-module=../mod_security/nginx/modsecurity
~/nginx-1.2.0$ make
~/nginx-1.2.0$ sudo make install
</pre>
The last command performs server installation on the local machine, which can be either customized or omitted with built binaries packaged or moved to alternative server.

<h3>
<a id="user-content-configuration-steps" class="anchor" href="#configuration-steps" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-Configuration_Steps"></a><span>Configuration Steps</span>
</h3>


<p>3. The ModSecurity configuration file must be linked in nginx.conf file using the following directives defined by Nginx’s ModSecurity extension module. This configures ModSecurity as an Nginx request handler(The current request flow is:
request -&gt; modsecurity handler -&gt; backend). The configuration file will look similar to the following:
</p><pre>location / {
           ModSecurityEnabled on;
           ModSecurityConfig modsecurity.conf;
           # Only needed if including proxies
           proxy_pass http://localhost:8011;
           proxy_read_timeout 180s;
       }
</pre>
A recommended sample of modSecurity.conf file can be found in the ModSecurity git repository (<a href="https://raw.githubusercontent.com/SpiderLabs/ModSecurity/master/modsecurity.conf-recommended">https://raw.githubusercontent.com/SpiderLabs/ModSecurity/master/modsecurity.conf-recommended</a>). Note that this file makes a reference to a unicode.mapping file, which is also found in the same repository (<a href="https://raw.githubusercontent.com/SpiderLabs/ModSecurity/master/unicode.mapping">https://raw.githubusercontent.com/SpiderLabs/ModSecurity/master/unicode.mapping</a>). 

<p>4. Adding other configuration files (Optional):
Because Nginx only supports one 'ModSecurityConfig' directive if you want to use a multiple configuration files (for instance OWASP CRS), you simply need to use the 'Include' directive from within the file specified in your 'ModSecurityConfig'. This directive is provided by APR and is not documented in this guide but is simple enough to use. Adding the following at the bottom of modsecurity.conf will include a file from the same directory called test.conf:
</p><pre>Include test.conf
</pre>
The include directive also supports wildcard characters (*) and full paths. It should be easy to add something like the following (assuming CRS has been downloaded and installed to this path):
<pre>Include /opt/owasp-modsecurity-crs/modsecurity_crs_10_setup.conf
Include /opt/owasp-modsecurity-crs/rules/*.conf
</pre>

<p><b>Note</b>: Prior to version 2.7.2 Nginx used the ModSecurityPass directive to control proxying connections, this has been removed in favor of the aforementioned version. If you are running ModSecurity 2.7.1 or before your configuration should appear similar to the following: 
</p><pre>location / {
           ModSecurityEnabled on;
           ModSecurityConfig modsecurity.conf;
           ModSecurityPass @backend;
       }

location @backend {
           proxy_pass http://localhost:8011;
           proxy_read_timeout 180s;
       }
</pre>
<p>When deploying via this method you will need to modify the @backend definition to point to your correct back-end web application that Nginx is proxying to. Again, Starting with ModSecurity 2.7.2 the ModSecurityPass option was removed.
</p>

<h1>
<a id="user-content-installation-for-microsoft-iis" class="anchor" href="#installation-for-microsoft-iis" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-Installation_for_Microsoft_IIS"></a><span>Installation for Microsoft IIS</span>
</h1>


<p>Before installing ModSecurity make sure you have Visual Studio 2013 Runtime (vcredist) installed.
Vcredist can be downloaded here: <a href="http://www.visualstudio.com/downloads/download-visual-studio-vs">http://www.visualstudio.com/downloads/download-visual-studio-vs</a>
(note that, there are two different versions 32 and 64b).
</p>
<p>The source code of ModSecurity’s IIS components is fully published and the binary building process is described (see README_WINDOWS.TXT). For quick installation it is highly recommended to use standard MSI installer available from SourceForge files repository of ModSecurity project or use binary package and follow the manual installation steps.
</p>
<p>Any installation errors or warning messages are logged in the application event log under 'ModSecurityIIS Installer' source.
</p>
<p>The OWASP CRS is also installed on the system drive, on the selected folder.
It can be included in any website by adding the following line to the web.config file, in system.webServer section:
</p>
<pre>        &lt;ModSecurity enabled="true" configFile="c:\path\to\owasp_crs\modsecurity_iis.conf" /&gt;
</pre>

<p>(relative path can also be used accordingly)
</p>
<h2>
<a id="user-content-manually-installing-and-troubleshooting-setup-of-modsecurity-module-on-iis" class="anchor" href="#manually-installing-and-troubleshooting-setup-of-modsecurity-module-on-iis" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-Manually_Installing_and_Troubleshooting_Setup_of_ModSecurity_Module_on_IIS"></a><span>Manually Installing and Troubleshooting Setup of ModSecurity Module on IIS</span>
</h2>




<h3>
<a id="user-content-configuration" class="anchor" href="#configuration" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-Configuration"></a><span>Configuration</span>
</h3>



<dl><dd>After the installation the module will be running in all websites by default. To remove it from a website add to web.config:</dd></dl>
<pre>&lt;modules&gt;
    &lt;remove name="ModSecurityIIS" /&gt;
&lt;/modules&gt;</pre>

<dl><dd>To configure module in a website add to web.config:</dd></dl>
<pre>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;configuration&gt;
    &lt;system.webServer&gt;
        &lt;ModSecurity enabled="true" configFile="c:\inetpub\wwwroot\xss.conf" /&gt;
    &lt;/system.webserver&gt;
&lt;/configuration&gt;</pre>

<dl><dd>where configFile is standard ModSecurity config file.</dd></dl>
<br>

<dl><dd>Events from the module will show up in "Application" Windows log.</dd></dl>


<h2>
<a id="user-content-common-problems" class="anchor" href="#common-problems" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-Common_Problems"></a><span>Common Problems</span>
</h2>




<dl><dd>If after installation protected website responds with HTTP 503 error and event ID 2280 keeps getting logged in the application event log:</dd></dl>

<pre>Log Name:      Application
Source:        Microsoft-Windows-IIS-W3SVC-WP
Event ID:      2280
Task Category: None
Level:         Error
Keywords:      Classic
User:          N/A
Description:
The Module DLL C:\Windows\system32\inetsrv\modsecurityiis.dll failed to load.  The data is the error.
</pre>

<p>most likely it means that the installation process has failed and the ModSecurityIIS.dll module is missing one or more libraries that it depends on. Repeating installation of the prerequisites and the module files should fix the problem. The dependency walker tool:
</p>

<ul><li>
<a href="http://www.dependencywalker.com/">http://www.dependencywalker.com/</a></li></ul>

<p>can be used to figure out which library is missing or cannot be loaded.
</p>

<h1>
<a id="user-content-configuration-directives" class="anchor" href="#configuration-directives" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-Configuration_Directives"></a><span>Configuration Directives</span>
</h1>


<p>The following section outlines all of the ModSecurity directives. Most of the ModSecurity directives can be used inside the various Apache Scope Directives such as VirtualHost, Location, LocationMatch, Directory, etc... There are others, however, that can only be used once in the main configuration file. This information is specified in the Scope sections below. The first version to use a given directive is given in the Version sections below.
</p>
<p>These rules, along with the Core rules files, should be contained in files outside of the httpd.conf file and called up with Apache "Include" directives. This allows for easier updating/migration of the rules. If you create your own custom rules that you would like to use with the Core rules, you should create a file called - modsecurity_crs_15_customrules.conf and place it in the same directory as the Core rules files. By using this file name, your custom rules will be called up after the standard ModSecurity Core rules configuration file but before the other Core rules. This allows your rules to be evaluated first which can be useful if you need to implement specific "allow" rules or to correct any false positives in the Core rules as they are applied to your site.
</p>


<dl><dt>Note : It is highly encouraged that you do not edit the Core rules files themselves but rather place all changes (such as SecRuleRemoveByID, etc...) in your custom rules file. This will allow for easier upgrading as newer Core rules are released.</dt></dl>
<h2>
<a id="user-content-secaction" class="anchor" href="#secaction" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-SecAction"></a><span>SecAction</span>
</h2>


<p><b>Description:</b> Unconditionally processes the action list it receives as the first and only parameter. The syntax of the parameter is identical to that of the third parameter of <code>SecRule</code>.
</p>
<p><b>Syntax:</b> <code>SecAction "action1,action2,action3,...“</code>
</p>
<p><b>Scope:</b> Any
</p>
<p><b>Version:</b> 2.0.0
</p>
<p>This directive is commonly used to set variables and initialize persistent collections using the initcol action. For example:
</p><pre>SecAction nolog,phase:1,initcol:RESOURCE=%{REQUEST_FILENAME}</pre>

<h2>
<a id="user-content-secargumentseparator" class="anchor" href="#secargumentseparator" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-SecArgumentSeparator"></a><span>SecArgumentSeparator</span>
</h2>


<p><b>Description:</b> Specifies which character to use as the separator for application/x-www-form- urlencoded content.
</p>
<p><b>Syntax:</b> <code>SecArgumentSeparator character</code>
</p>
<p><b>Default:</b> &amp; 
</p>
<p><b>Scope:</b> Main(&lt; 2.7.0), Any(2.7.0)
</p>
<p><b>Version:</b> 2.0.0
</p>
<p>This directive is needed if a backend web application is using a nonstandard argument separator. Applications are sometimes (very rarely) written to use a semicolon separator. You should not change the default setting unless you establish that the application you are working with requires a different separator. If this directive is not set properly for each web application, then ModSecurity will not be able to parse the arguments appropriately and the effectiveness of the rule matching will be significantly decreased.
</p>

<h2>
<a id="user-content-secauditengine" class="anchor" href="#secauditengine" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-SecAuditEngine"></a><span>SecAuditEngine</span>
</h2>


<p><b>Description:</b> Configures the audit logging engine. 
</p>
<p><b>Syntax:</b> <code>SecAuditEngine RelevantOnly</code> 
</p>
<p><b>Default:</b> Off 
</p>
<p><b>Scope:</b> Any
</p>
<p><b>Version:</b> 2.0.0
</p>
<p>The SecAuditEngine directive is used to configure the audit engine, which logs complete transactions. ModSecurity is currently able to log most, but not all transactions. Transactions involving errors (e.g., 400 and 404 transactions) use a different execution path, which ModSecurity does not support.
</p>
<p>The possible values for the audit log engine are as follows:



</p><ul>
<li>
<b>On</b>: log all transactions</li>
<li>
<b>Off</b>: do not log any transactions</li>
<li>
<b>RelevantOnly</b>: only the log transactions that have triggered a warning or an error, or have a status code that is considered to be relevant (as determined by the SecAuditLogRelevantStatus directive)</li>
</ul>


<dl><dt>Note : If you need to change the audit log engine configuration on a per-transaction basis (e.g., in response to some transaction data), use the ctl action.</dt></dl>

<p>The following example demonstrates how SecAuditEngine is used:
</p><pre>SecAuditEngine RelevantOnly
SecAuditLog logs/audit/audit.log
SecAuditLogParts ABCFHZ 
SecAuditLogType concurrent 
SecAuditLogStorageDir logs/audit 
SecAuditLogRelevantStatus ^(?:5|4(?!04))
</pre>


<h2>
<a id="user-content-secauditlog" class="anchor" href="#secauditlog" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-SecAuditLog"></a><span>SecAuditLog</span>
</h2>


<p><b>Description:</b> Defines the path to the main audit log file (serial logging format) or the concurrent logging index file (concurrent logging format). When used in combination with mlogc (only possible with concurrent logging), this directive defines the mlogc location and command line.
</p>
<p><b>Syntax:</b> <code>SecAuditLog /path/to/audit.log</code> 
</p>
<p><b>Scope:</b> Any Version: 2.0.0
</p>
<p>This file will be used to store the audit log entries if serial audit logging format is used. If concurrent audit logging format is used this file will be used as an index, and contain a record of all audit log files created. If you are planning to use concurrent audit logging to send your audit log data off to a remote server you will need to deploy the ModSecurity Log Collector (mlogc), like this:
</p><pre>SecAuditLog "|/path/to/mlogc /path/to/mlogc.conf"
</pre>

<dl><dt>Note : This audit log file is opened on startup when the server typically still runs as root. You should not allow non-root users to have write privileges for this file or for the directory.</dt></dl>


<h2>
<a id="user-content-secauditlog2" class="anchor" href="#secauditlog2" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-SecAuditLog2"></a><span>SecAuditLog2</span>
</h2>


<p><b>Description:</b> Defines the path to the secondary audit log index file when concurrent logging is enabled. See SecAuditLog for more details.
</p>
<p><b>Syntax:</b> <code>SecAuditLog2 /path/to/audit.log</code> 
</p>
<p><b>Scope:</b> Any 
</p>
<p><b>Version:</b> 2.1.2
</p>
<p>The purpose of SecAuditLog2 is to make logging to two remote servers possible, which is typically achieved by running two instances of the mlogc tool, each with a different configuration (in addition, one of the instances will need to be instructed not to delete the files it submits). This directive can be used only if SecAuditLog was previously configured and only if concurrent logging format is used.
</p>

<h2>
<a id="user-content-secauditlogdirmode" class="anchor" href="#secauditlogdirmode" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-SecAuditLogDirMode"></a><span>SecAuditLogDirMode</span>
</h2>


<p><b>Description:</b> Configures the mode (permissions) of any directories created for the concurrent audit logs, using an octal mode value as parameter (as used in chmod).
</p>
<p><b>Syntax:</b> <code>SecAuditLogDirMode octal_mode|"default"</code> 
</p>
<p><b>Default:</b> 0600 
</p>
<p><b>Scope:</b> Any 
</p>
<p><b>Version:</b> 2.5.10
</p>
<p>The default mode for new audit log directories (0600) only grants read/write access to the owner (typically the account under which Apache is running, for example apache). If access from other accounts is needed (e.g., for use with mpm-itk), then you may use this directive to grant additional read and/or write privileges. You should use this directive with caution to avoid exposing potentially sensitive data to unauthorized users. Using the value default as parameter reverts the configuration back to the default setting. This feature is not available on operating systems not supporting octal file modes.
</p>
<p>Example:
</p><pre>SecAuditLogDirMode 02750</pre>

<dl><dt>Note : The process umask may still limit the mode if it is being more restrictive than the mode set using this directive.</dt></dl>


<h2>
<a id="user-content-secauditlogformat" class="anchor" href="#secauditlogformat" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-SecAuditLogFormat"></a><span>SecAuditLogFormat</span>
</h2>


<p><b>Description:</b> Select the output format of the AuditLogs. The format can be either the native AuditLogs format or JSON.
</p>
<p><b>Syntax:</b> <code>SecAuditLogFormat JSON|Native</code> 
</p>
<p><b>Default:</b> Native
</p>
<p><b>Scope:</b> Any 
</p>
<p><b>Version:</b> 2.9.1
</p>

<dl><dt>Note : The JSON format is only available if ModSecurity was compiled with support to JSON via the YAJL library. During the compilation time, the yajl-dev package (or similar) must be part of the system. The configure scripts provides information if the YAJL support was enabled or not.</dt></dl>


<h2>
<a id="user-content-secauditlogfilemode" class="anchor" href="#secauditlogfilemode" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-SecAuditLogFileMode"></a><span>SecAuditLogFileMode</span>
</h2>


<p><b>Description:</b> Configures the mode (permissions) of any files created for concurrent audit logs using an octal mode (as used in chmod). See SecAuditLogDirMode for controlling the mode of created audit log directories.
</p>
<p><b>Syntax:</b> <code>SecAuditLogFileMode octal_mode|"default"</code> 
</p>
<p><b>Default:</b> 0600
</p>
<p><b>Scope:</b> Any 
</p>
<p><b>Version:</b> 2.5.10
</p>
<p><b>Example Usage:</b> <code>SecAuditLogFileMode 00640</code> 
</p>
<p>This feature is not available on operating systems not supporting octal file modes. The default mode (0600) only grants read/write access to the account writing the file. If access from another account is needed (using mpm-itk is a good example), then this directive may be required. However, use this directive with caution to avoid exposing potentially sensitive data to unauthorized users. Using the value “default” will revert back to the default setting.
</p>

<dl><dt>Note : The process umask may still limit the mode if it is being more restrictive than the mode set using this directive.</dt></dl>


<h2>
<a id="user-content-secauditlogparts" class="anchor" href="#secauditlogparts" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-SecAuditLogParts"></a><span>SecAuditLogParts</span>
</h2>


<p><b>Description:</b> Defines which parts of each transaction are going to be recorded in the audit log. Each part is assigned a single letter; when a letter appears in the list then the equivalent part will be recorded. See below for the list of all parts.
</p>
<p><b>Syntax:</b> <code>SecAuditLogParts PARTLETTERS</code>
</p>
<p><b>Example Usage:</b> <code>SecAuditLogParts ABCFHZ</code> 
</p>
<p><b>Scope:</b> Any Version: 2.0.0
</p>
<p><b>Default:</b> ABCFHZ Note
</p>
<p>The format of the audit log format is documented in detail in the Audit Log Data Format Documentation.
</p>
<p>Available audit log parts:












</p><ul>
<li>A: Audit log header (mandatory).</li>
<li>B: Request headers.</li>
<li>C: Request body (present only if the request body exists and ModSecurity is configured to intercept it. This would require SecRequestBodyAccess to be set to on).</li>
<li>D: Reserved for intermediary response headers; not implemented yet.</li>
<li>E: Intermediary response body (present only if ModSecurity is configured to intercept response bodies, and if the audit log engine is configured to record it. Intercepting response bodies requires SecResponseBodyAccess to be enabled). Intermediary response body is the same as the actual response body unless ModSecurity intercepts the intermediary response body, in which case the actual response body will contain the error message (either the Apache default error message, or the ErrorDocument page).</li>
<li>F: Final response headers (excluding the Date and Server headers, which are always added by Apache in the late stage of content delivery).</li>
<li>G: Reserved for the actual response body; not implemented yet.</li>
<li>H: Audit log trailer.</li>
<li>I: This part is a replacement for part C. It will log the same data as C in all cases except when multipart/form-data encoding in used. In this case, it will log a fake application/x-www-form-urlencoded body that contains the information about parameters but not about the files. This is handy if you don’t want to have (often large) files stored in your audit logs.</li>
<li>J: This part contains information about the files uploaded using multipart/form-data encoding.</li>
<li>K: This part contains a full list of every rule that matched (one per line) in the order they were matched. The rules are fully qualified and will thus show inherited actions and default operators. Supported as of v2.5.0.</li>
<li>Z: Final boundary, signifies the end of the entry (mandatory).</li>
</ul>


<h2>
<a id="user-content-secauditlogrelevantstatus" class="anchor" href="#secauditlogrelevantstatus" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-SecAuditLogRelevantStatus"></a><span>SecAuditLogRelevantStatus</span>
</h2>


<p><b>Description:</b> Configures which response status code is to be considered relevant for the purpose of audit logging.
</p>
<p><b>Syntax:</b> <code>SecAuditLogRelevantStatus REGEX</code> 
</p>
<p><b>Example Usage:</b> <code>SecAuditLogRelevantStatus "^(?:5|4(?!04))"</code> 
</p>
<p><b>Scope:</b> Any 
</p>
<p><b>Version:</b> 2.0.0
</p>
<p><b>Dependencies/Notes:</b> Must have SecAuditEngine set to RelevantOnly. Additionally, the auditlog action is present by default in rules, this will make the engine bypass the 'SecAuditLogRelevantStatus' and send rule matches to the audit log regardless of status. You must specify noauditlog in the rules manually or set it in SecDefaultAction.
</p>
<p>The main purpose of this directive is to allow you to configure audit logging for only the transactions that have the status code that matches the supplied regular expression. The example provided would log all 5xx and 4xx level status codes, except for 404s. Although you could achieve the same effect with a rule in phase 5, SecAuditLogRelevantStatus is sometimes better, because it continues to work even when SecRuleEngine is disabled.
</p>

<h2>
<a id="user-content-secauditlogstoragedir" class="anchor" href="#secauditlogstoragedir" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-SecAuditLogStorageDir"></a><span>SecAuditLogStorageDir</span>
</h2>


<p><b>Description:</b> Configures the directory where concurrent audit log entries are to be stored. 
</p>
<p><b>Syntax</b>: <code>SecAuditLogStorageDir /path/to/storage/dir</code>
</p>
<p><b>Example Usage:</b> <code>SecAuditLogStorageDir /usr/local/apache/logs/audit </code>
</p>
<p><b>Scope:</b> Any
</p>
<p><b>Version:</b> 2.0.0
</p>
<p>This directive is only needed when concurrent audit logging is used. The directory must already exist and must be writable by the web server user. Audit log entries are created at runtime, after Apache switches to a non-root account.
As with all logging mechanisms, ensure that you specify a file system location that has adequate disk space and is not on the main system partition.
</p>

<h2>
<a id="user-content-secauditlogtype" class="anchor" href="#secauditlogtype" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-SecAuditLogType"></a><span>SecAuditLogType</span>
</h2>


<p><b>Description:</b> Configures the type of audit logging mechanism to be used. 
</p>
<p><b>Syntax:</b> <code>SecAuditLogType Serial|Concurrent|HTTPS </code>
</p>
<p><b>Example Usage:</b> <code>SecAuditLogType Serial</code>
</p>
<p><b>Scope:</b> Any
</p>
<p><b>Version:</b> 2.0.0 
</p>
<p>The possible values are:


</p><dl>
<dt>Serial : Audit log entries will be stored in a single file, specified by SecAuditLog. This is conve- nient for casual use, but it can slow down the server, because only one audit log entry can be written to the file at any one time.</dt>
<dt>Concurrent : One file per transaction is used for audit logging. This approach is more scalable when heavy logging is required (multiple transactions can be recorded in parallel). It is also the only choice if you need to use remote logging.</dt>
</dl>


<dl><dt>HTTPS : This functionality is only available on libModSecurity and its currently in testing phase. Depending on the amount of request that you have, it may be suitable. Use the URL of your endpoint instead of the path to a file.</dt></dl>


<dl><dt>Note : HTTPS audit log type is currently only supported on libModSecurity.</dt></dl>


<h2>
<a id="user-content-seccachetransformations" class="anchor" href="#seccachetransformations" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-SecCacheTransformations"></a><span>SecCacheTransformations</span>
</h2>


<p><b>Description:</b> Controls the caching of transformations, which may speed up the processing of complex rule sets. Caching is off by default starting with 2.5.6, when it was deprecated and downgraded back to experimental.
</p>
<p><b>Syntax:</b> <code>SecCacheTransformations On|Off [options] </code>
</p>
<p><b>Example Usage:</b> <code>SecCacheTransformations On "minlen:64,maxlen:0" </code>
</p>
<p><b>Scope:</b> Any 
</p>
<p><b>Version:</b> 2.5.0; deprecated in 2.5.6.
</p>
<p><b>Supported on libModSecurity:</b> No (Deprecated)
</p>
<p>The first directive parameter can be one of the following:


</p><ul>
<li>
<b>On</b>: Cache transformations (per transaction, per phase) allowing identical transforma- tions to be performed only once.</li>
<li>
<b>Off</b>: Do not cache any transformations, leaving all transformations to be performed every time they are needed.</li>
</ul>

<p>The following options are allowed (multiple options must be comma-separated): 




</p><ul>
<li>
<b>incremental:on|off</b>: Enabling this option will cache every transformation instead of just the final transformation. The default is off.</li>
<li>
<b>maxitems:N</b>: Do not allow more than N transformations to be cached. Cache will be disabled once this number is reached. A zero value is interpreted as unlimited. This option may be useful to limit caching for a form with a large number of variables. The default value is 512.</li>
<li>
<b>minlen:N</b>: Do not cache the transformation if the variable’s length is less than N bytes. The default setting is 32.</li>
<li>
<b>maxlen:N</b>: Do not cache the transformation if the variable’s length is more than N bytes. A zero value is interpreted as unlimited. The default setting is 1024.</li>
</ul>


<h2>
<a id="user-content-secchrootdir" class="anchor" href="#secchrootdir" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-SecChrootDir"></a><span>SecChrootDir</span>
</h2>


<p><b>Description:</b> Configures the directory path that will be used to jail the web server process. 
</p>
<p><b>Syntax:</b> <code>SecChrootDir /path/to/chroot/dir </code>
</p>
<p><b>Example Usage:</b> <code>SecChrootDir /chroot </code>
</p>
<p><b>Scope:</b> Main
</p>
<p><b>Version:</b> 2.0.0-2.9.x
</p>
<p><b>Supported on libModSecurity:</b> TBI
</p>
<p>This feature is not available on Windows builds. The internal chroot functionality provided by ModSecurity works great for simple setups. One example of a simple setup is Apache serving only static files, or running applications using built-in modules. Some problems you might encounter with more complex setups:



</p><ol>
<li>DNS lookups do not work (this is because this feature requires a shared library that is loaded on demand, after chroot takes place).</li>
<li>You cannot send email from PHP, because it wants to use sendmail and sendmail re- sides outside the jail.</li>
<li>In some cases, when you separate Apache from its configuration, restarts and graceful reloads no longer work.</li>
</ol>

<p>The best way to use SecChrootDir is the following: 




</p><ol>
<li>Create /chroot to be your main jail directory.</li>
<li>Create /chroot/opt/apache inside jail.</li>
<li>Create a symlink from /opt/apache to /chroot/opt/apache. </li>
<li>Now install Apache into /chroot/opt/apache.</li>
</ol>

<p>You should be aware that the internal chroot feature might not be 100% reliable. Due to the large number of default and third-party modules available for the Apache web server, it is not possible to verify the internal chroot works reliably with all of them. A module, working from within Apache, can do things that make it easy to break out of the jail. In particular, if you are using any of the modules that fork in the module initialisation phase (e.g., mod_fastcgi, mod_fcgid, mod_cgid), you are advised to examine each Apache process and observe its current working directory, process root, and the list of open files. Consider what your options are and make your own decision.
</p>

<dl><dt>Note : This directive is not allowed inside VirtualHosts. If enabled, it must be placed in a global server-wide configuration file such as your default modsecurity.conf.</dt></dl>


<h2>
<a id="user-content-seccollectiontimeout" class="anchor" href="#seccollectiontimeout" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-SecCollectionTimeout"></a><span>SecCollectionTimeout</span>
</h2>


<p><b>Description:</b> Specifies the collections timeout. Default is 3600 seconds.
</p>
<p><b>Syntax:</b> <code>SecCollectionTimeout seconds</code>
</p>
<p><b>Default:</b> 3600 
</p>
<p><b>Scope:</b> Any
</p>
<p><b>Version:</b> 2.6.3
</p>
<p><b>Supported on libModSecurity:</b> Yes
</p>

<h2>
<a id="user-content-seccomponentsignature" class="anchor" href="#seccomponentsignature" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-SecComponentSignature"></a><span>SecComponentSignature</span>
</h2>


<p><b>Description:</b> Appends component signature to the ModSecurity signature. 
</p>
<p><b>Syntax:</b> <code>SecComponentSignature "COMPONENT_NAME/X.Y.Z (COMMENT)" </code>
</p>
<p><b>Example usage</b>: <code>SecComponentSignature "core ruleset/2.1.3"</code>
</p>
<p><b>Scope:</b> Main 
</p>
<p><b>Version:</b> 2.5.0
</p>
<p><b>Supported on libModSecurity:</b> Yes
</p>
<p>This directive should be used to make the presence of significant rule sets known. The entire signature will be recorded in the transaction audit log.
</p>

<h2>
<a id="user-content-secconnengine" class="anchor" href="#secconnengine" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-SecConnEngine"></a><span>SecConnEngine</span>
</h2>


<p><b>Description:</b> Configures the connections engine. This directive affect the directives: SecConnReadStateLimit and SecConnWriteStateLimit.
</p>
<p><b>Syntax:</b> <code>SecConnEngine On|Off|DetectionOnly </code>
</p>
<p><b>Example Usage:</b> <code>SecConnEngine On </code>
</p>
<p><b>Scope:</b> Any
</p>
<p><b>Version:</b> 2.8.0-2.9.x
</p>
<p><b>Supported on libModSecurity:</b> TBI
</p>
<p>Possible values are (Same as SecRuleEngine): 



</p><ul>
<li>
<b>On</b>: process SecConn[Read|Write]StateLimit.</li>
<li>
<b>Off</b>: Ignore the directives SecConn[Read|Write]StateLimit</li>
<li>
<b>DetectionOnly</b>: process SecConn[Read|Write]StateLimit definitions in verbose mode but never executes any disruptive actions</li>
</ul>


<h2>
<a id="user-content-seccontentinjection" class="anchor" href="#seccontentinjection" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-SecContentInjection"></a><span>SecContentInjection</span>
</h2>


<p><b>Description:</b> Enables content injection using actions append and prepend. 
</p>
<p><b>Syntax:</b> <code>SecContentInjection On|Off </code>
</p>
<p><b>Example Usage:</b> <code>SecContentInjection On </code>
</p>
<p><b>Scope:</b> Any
</p>
<p><b>Version:</b> 2.5.0-2.9.x
</p>
<p><b>Supported on libModSecurity:</b> TBI
</p>
<p>This directive provides an easy way to control content injection, no matter what the rules want to do. It is not necessary to have response body buffering enabled in order to use content injection.
</p>

<dl><dt>Note : This directive must ben enabled if you want to use @rsub + the STREAM_ variables to manipulate live transactional data.</dt></dl>


<h2>
<a id="user-content-seccookieformat" class="anchor" href="#seccookieformat" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-SecCookieFormat"></a><span>SecCookieFormat</span>
</h2>


<p><b>Description:</b> Selects the cookie format that will be used in the current configuration context. 
</p>
<p><b>Syntax:</b> <code>SecCookieFormat 0|1 </code>
</p>
<p><b>Example Usage:</b> <code>SecCookieFormat 0 </code>
</p>
<p><b>Scope:</b> Any
</p>
<p><b>Version:</b> 2.0.0 
</p>
<p><b>Supported on libModSecurity:</b> Yes
</p>
<p>The possible values are:


</p><ul>
<li>
<b>0</b>: Use version 0 (Netscape) cookies. This is what most applications use. It is the default value.</li>
<li>
<b>1</b>: Use version 1 cookies.</li>
</ul>


<h2>
<a id="user-content-seccookiev0separator" class="anchor" href="#seccookiev0separator" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-SecCookieV0Separator"></a><span>SecCookieV0Separator</span>
</h2>


<p><b>Description:</b> Specifies which character to use as the separator for cookie v0 content.
</p>
<p><b>Syntax:</b> <code>SecCookieV0Separator character</code>
</p>
<p><b>Scope:</b> Any
</p>
<p><b>Version:</b> 2.7.0-2.9.x
</p>
<p><b>Supported on libModSecurity:</b> TBI
</p>

<h2>
<a id="user-content-secdatadir" class="anchor" href="#secdatadir" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-SecDataDir"></a><span>SecDataDir</span>
</h2>


<p><b>Description:</b> Path where persistent data (e.g., IP address data, session data, and so on) is to be stored.
</p>
<p><b>Syntax:</b> <code>SecDataDir /path/to/dir </code>
</p>
<p><b>Example Usage:</b> <code>SecDataDir /usr/local/apache/logs/data </code>
</p>
<p><b>Scope:</b> Main
</p>
<p><b>Version:</b> 2.0.0
</p>
<p><b>Supported on libModSecurity:</b> Yes
</p>
<p>This directive must be provided before initcol, setsid, and setuid can be used. The directory to which the directive points must be writable by the web server user.
</p>

<dl><dt>Note : This directive is not allowed inside VirtualHosts. If enabled, it must be placed in a global server-wide configuration file such as your default modsecurity.conf.</dt></dl>


<h2>
<a id="user-content-secdebuglog" class="anchor" href="#secdebuglog" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-SecDebugLog"></a><span>SecDebugLog</span>
</h2>


<p><b>Description</b>: Path to the ModSecurity debug log file. 
</p>
<p><b>Syntax:</b> <code>SecDebugLog /path/to/modsec-debug.log </code>
</p>
<p><b>Example Usage:</b> <code>SecDebugLog /usr/local/apache/logs/modsec-debug.log </code>
</p>
<p><b>Scope:</b> Any 
</p>
<p><b>Version:</b> 2.0.0
</p>
<p><b>Supported on libModSecurity:</b> Yes
</p>

<h2>
<a id="user-content-secdebugloglevel" class="anchor" href="#secdebugloglevel" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-SecDebugLogLevel"></a><span>SecDebugLogLevel</span>
</h2>


<p><b>Description:</b> Configures the verboseness of the debug log data. 
</p>
<p><b>Syntax</b>: <code>SecDebugLogLevel 0|1|2|3|4|5|6|7|8|9</code>
</p>
<p><b>Example Usage:</b> <code>SecDebugLogLevel 4 </code>
</p>
<p><b>Scope:</b> Any
</p>
<p><b>Version:</b> 2.0.0
</p>
<p><b>Supported on libModSecurity:</b> Yes
</p>
<p>Messages at levels 1–3 are always copied to the Apache error log. Therefore you can always use level 0 as the default logging level in production if you are very concerned with performance. Having said that, the best value to use is 3. Higher logging levels are not recommended in production, because the heavy logging affects performance adversely.
</p>
<p>The possible values for the debug log level are: 







</p><ul>
<li>0: no logging </li>
<li>1: errors (intercepted requests) only </li>
<li>2: warnings</li>
<li>3: notices </li>
<li>4: details of how transactions are handled </li>
<li>5: as above, but including information about each piece of information handled </li>
<li>9: log everything, including very detailed debugging information</li>
</ul>


<h2>
<a id="user-content-secdefaultaction" class="anchor" href="#secdefaultaction" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-SecDefaultAction"></a><span>SecDefaultAction</span>
</h2>


<p><b>Description</b>: Defines the default list of actions, which will be inherited by the rules in the same configuration context.
</p>
<p><b>Syntax:</b> <code>SecDefaultAction "action1,action2,action3“ </code>
</p>
<p><b>Example Usage:</b> <code>SecDefaultAction "phase:2,log,auditlog,deny,status:403,tag:'SLA 24/7'“ </code>
</p>
<p><b>Scope:</b> Any 
</p>
<p><b>Version:</b> 2.0.0
</p>
<p><b>Supported on libModSecurity:</b> Yes
</p>
<p><b>Default:</b> phase:2,log,auditlog,pass
</p>
<p>Every rule following a previous <code>SecDefaultAction</code> directive in the same configuration context will inherit its settings unless more specific actions are used. Every <code>SecDefaultAction</code> directive must specify a disruptive action and a processing phase and cannot contain metadata actions.
</p>

<dl><dt>Warning : <code>SecDefaultAction</code> is not inherited across configuration contexts. (For an example of why this may be a problem, read the following ModSecurity Blog entry <a href="http://blog.spiderlabs.com/2008/07/three-modsecurity-rule-language-annoyances.html">http://blog.spiderlabs.com/2008/07/three-modsecurity-rule-language-annoyances.html</a> .)</dt></dl>


<h2>
<a id="user-content-secdisablebackendcompression" class="anchor" href="#secdisablebackendcompression" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-SecDisableBackendCompression"></a><span>SecDisableBackendCompression</span>
</h2>


<p><b>Description:</b> Disables backend compression while leaving the frontend compression enabled. 
</p>
<p><b>Syntax:</b> <code>SecDisableBackendCompression On|Off </code>
</p>
<p><b>Scope:</b> Any 
</p>
<p><b>Version:</b> 2.6.0-2.9.x
</p>
<p><b>Supported on libModSecurity:</b> TBI
</p>
<p><b>Default:</b> Off
</p>
<p>This directive is necessary in reverse proxy mode when the backend servers support response compression, but you wish to inspect response bodies. Unless you disable backend compression, ModSecurity will only see compressed content, which is not very useful. This directive is not necessary in embedded mode, because ModSecurity performs inspection before response compression takes place.
</p>

<h2>
<a id="user-content-sechashengine" class="anchor" href="#sechashengine" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-SecHashEngine"></a><span>SecHashEngine</span>
</h2>


<p><b>Description:</b> Configures the hash engine. 
</p>
<p><b>Syntax:</b> <code>SecHashEngine On|Off</code>
</p>
<p><b>Example Usage:</b> <code>SecHashEngine On </code>
</p>
<p><b>Scope</b>: Any 
</p>
<p><b>Version:</b> 2.7.1-2.9.x
</p>
<p><b>Supported on libModSecurity:</b> TBI
</p>
<p><b>Default:</b> Off
</p>
<p>The possible values are: 


</p><ul>
<li>
<b>On</b>: Hash engine can process the request/response data.</li>
<li>
<b>Off</b>: Hash engine will not process any data. </li>
</ul>


<dl><dt>Note : Users must enable stream output variables and content injection.</dt></dl>


<h2>
<a id="user-content-sechashkey" class="anchor" href="#sechashkey" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-SecHashKey"></a><span>SecHashKey</span>
</h2>


<p><b>Description:</b> Define the key that will be used by HMAC. 
</p>
<p><b>Syntax:</b> <code>SecHashKey rand|TEXT KeyOnly|SessionID|RemoteIP</code>
</p>
<p><b>Example Usage:</b> <code>SecHashKey "this_is_my_key" KeyOnly</code>
</p>
<p><b>Scope</b>: Any 
</p>
<p><b>Version:</b> 2.7.1-2.9.x
</p>
<p><b>Supported on libModSecurity:</b> TBI
</p>
<p>ModSecurity hash engine will append, if specified, the user's session id or remote ip to the key before the MAC operation. If the first parameter is "rand" then a random key will be generated and used by the engine.
</p>


<h2>
<a id="user-content-sechashparam" class="anchor" href="#sechashparam" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-SecHashParam"></a><span>SecHashParam</span>
</h2>


<p><b>Description:</b> Define the parameter name that will receive the MAC hash. 
</p>
<p><b>Syntax:</b> <code>SecHashParam TEXT</code>
</p>
<p><b>Example Usage:</b> <code>SecHashParam "hmac"</code>
</p>
<p><b>Scope</b>: Any 
</p>
<p><b>Version:</b> 2.7.1-2.9.x
</p>
<p><b>Supported on libModSecurity:</b> TBI
</p>
<p>ModSecurity hash engine will add a new parameter to protected HTML elements containing the MAC hash.
</p>

<h2>
<a id="user-content-sechashmethodrx" class="anchor" href="#sechashmethodrx" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-SecHashMethodRx"></a><span>SecHashMethodRx</span>
</h2>


<p><b>Description:</b> Configures what kind of HTML data the hash engine should sign based on regular expression.
</p>
<p><b>Syntax:</b> <code>SecHashMethodRx TYPE REGEX</code> 
</p>
<p><b>Example Usage</b>: <code>SecHashMethodRx HashHref "product_info|list_product"</code>
</p>
<p><b>Scope:</b> Any
</p>
<p><b>Version:</b> 2.7.1-2.9.x
</p>
<p><b>Supported on libModSecurity:</b> TBI
</p>
<p>As a initial support is possible to protect HREF, FRAME, IFRAME and FORM ACTION html elements as well response Location header when http redirect code are sent.
</p>
<p>The possible values for TYPE are:





</p><ul>
<li>
<b>HashHref</b>: Used to sign href= html elements</li>
<li>
<b>HashFormAction</b>: Used to sign form action= html elements</li>
<li>
<b>HashIframeSrc</b>: Used to sign iframe src= html elements</li>
<li>
<b>HashframeSrc</b>: Used to sign frame src= html elements </li>
<li>
<b>HashLocation</b>: Used to sign Location response header</li>
</ul>


<dl><dt>Note : This directive is used to sign the elements however user must use the @validateHash operator to enforce data integrity.</dt></dl>



<h2>
<a id="user-content-sechashmethodpm" class="anchor" href="#sechashmethodpm" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-SecHashMethodPm"></a><span>SecHashMethodPm</span>
</h2>


<p><b>Description:</b> Configures what kind of HTML data the hash engine should sign based on string search algoritm.
</p>
<p><b>Syntax:</b> <code>SecHashMethodPm TYPE "string1 string2 string3..."</code> 
</p>
<p><b>Example Usage</b>: <code>SecHashMethodPm HashHref "product_info list_product"</code>
</p>
<p><b>Scope:</b> Any
</p>
<p><b>Version:</b> 2.7.1-2.9.x
</p>
<p><b>Supported on libModSecurity:</b> TBI
</p>
<p>As a initial support is possible to protect HREF, FRAME, IFRAME and FORM ACTION html elements as well response Location header when http redirect code are sent.
</p>
<p>The possible values for TYPE are:





</p><ul>
<li>
<b>HashHref</b>: Used to sign href= html elements</li>
<li>
<b>HashFormAction</b>: Used to sign form action= html elements</li>
<li>
<b>HashIframeSrc</b>: Used to sign iframe src= html elements</li>
<li>
<b>HashframeSrc</b>: Used to sign frame src= html elements </li>
<li>
<b>HashLocation</b>: Used to sign Location response header</li>
</ul>


<dl><dt>Note : This directive is used to sign the elements however user must use the @validateHash operator to enforce data integrity.</dt></dl>


<h2>
<a id="user-content-secgeolookupdb" class="anchor" href="#secgeolookupdb" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-SecGeoLookupDb"></a><span>SecGeoLookupDb</span>
</h2>


<p><b>Description</b>: Defines the path to the database that will be used for geolocation lookups. 
</p>
<p><b>Syntax:</b> <code>SecGeoLookupDb /path/to/db </code>
</p>
<p><b>Example Usage</b>: <code>SecGeoLookupDb /path/to/GeoLiteCity.dat</code>
</p>
<p><b>Scope:</b> Any
</p>
<p><b>Version:</b> 2.5.0
</p>
<p><b>Supported on libModSecurity:</b> Yes
</p>
<p>ModSecurity relies on the free geolocation databases (GeoLite City and GeoLite Country) that can be obtained from MaxMind <a href="http://www.maxmind.com">http://www.maxmind.com</a>. Currently ModSecurity only supports the legacy GeoIP format. Maxmind's newer GeoIP2 format is not yet currently supported. 
</p>

<h2>
<a id="user-content-secgsblookupdb" class="anchor" href="#secgsblookupdb" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-SecGsbLookupDb"></a><span>SecGsbLookupDb</span>
</h2>


<p><b>Description</b>: Defines the path to the database that will be used for Google Safe Browsing (GSB) lookups. 
</p>
<p><b>Syntax:</b> <code>SecGsbLookupDb /path/to/db </code>
</p>
<p><b>Example Usage</b>: <code>SecGsbLookupDb /path/to/GsbMalware.dat</code>
</p>
<p><b>Scope:</b> Any
</p>
<p><b>Version:</b> 2.6.0
</p>
<p><b>Supported on libModSecurity:</b> TBD
</p>
<p>ModSecurity relies on the free Google Safe Browsing database that can be obtained from the Google GSB API <a href="http://code.google.com/apis/safebrowsing/">http://code.google.com/apis/safebrowsing/</a>.
</p>

<dl><dt>Note : Deprecated in 2.7.0 after Google dev team decided to not allow the database download anymore. After registering and obtaining a Safe Browsing API key, you can automatically download the GSB using a tool like wget. For further information on how to proceed with the download, please visit Google's website: <a href="https://developers.google.com/safe-browsing/v3/update-guide">https://developers.google.com/safe-browsing/v3/update-guide</a></dt></dl>


<h2>
<a id="user-content-secguardianlog" class="anchor" href="#secguardianlog" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-SecGuardianLog"></a><span>SecGuardianLog</span>
</h2>


<p><b>Description:</b> Configures an external program that will receive the information about every transaction via piped logging.
</p>
<p><b>Syntax:</b> <code>SecGuardianLog |/path/to/httpd-guardian </code>
</p>
<p><b>Example Usage:</b> <code>SecGuardianLog |/usr/local/apache/bin/httpd-guardian </code>
</p>
<p><b>Scope:</b> Main 
</p>
<p><b>Version:</b> 2.0.0-2.9.x
</p>
<p><b>Supported on libModSecurity:</b> TBI
</p>
<p>Guardian logging is designed to send the information about every request to an external program. Because Apache is typically deployed in a multiprocess fashion, which makes information sharing between processes difficult, the idea is to deploy a single external process to observe all requests in a stateful manner, providing additional protection.
</p>
<p>Currently the only tool known to work with guardian logging is httpd-guardian, which is part of the Apache httpd tools project <a href="http://apache-tools.cvs.sourceforge.net/viewvc/apache-tools/apache-tools/">http://apache-tools.cvs.sourceforge.net/viewvc/apache-tools/apache-tools/</a>. The httpd-guardian tool is designed to defend against denial of service attacks. It uses the blacklist tool (from the same project) to interact with an iptables-based (on a Linux system) or pf-based (on a BSD system) firewall, dynamically blacklisting the offending IP addresses. It can also interact with SnortSam <a href="http://www.snortsam.net">http://www.snortsam.net</a>. Assuming httpd-guardian is already configured (look into the source code for the detailed instructions), you only need to add one line to your Apache configuration to deploy it:
</p><pre>SecGuardianLog |/path/to/httpd-guardian</pre>


<dl><dt>Note : This directive is not allowed inside VirtualHosts. If enabled, it must be placed in a global server-wide configuration file such as your default modsecurity.conf.</dt></dl>


<h2>
<a id="user-content-sechttpblkey" class="anchor" href="#sechttpblkey" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-SecHttpBlKey"></a><span>SecHttpBlKey</span>
</h2>


<p><b>Description:</b> Configures the user's registered Honeypot Project HTTP BL API Key to use with @rbl.
</p>
<p><b>Syntax:</b> <code>SecHttpBlKey [12 char access key] </code>
</p>
<p><b>Example Usage:</b> <code>SecHttpBlKey whdkfieyhtnf </code>
</p>
<p><b>Scope:</b> Main 
</p>
<p><b>Version:</b> 2.7.0
</p>
<p><b>Supported on libModSecurity:</b> Yes
</p>
<p>If the @rbl operator uses the dnsbl.httpbl.org RBL (<a href="http://www.projecthoneypot.org/httpbl_api.php">http://www.projecthoneypot.org/httpbl_api.php</a>) you must provide an API key.  This key is registered to individual users and is included within the RBL DNS requests.
</p>

<h2>
<a id="user-content-secinterceptonerror" class="anchor" href="#secinterceptonerror" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-SecInterceptOnError"></a><span>SecInterceptOnError</span>
</h2>


<p><b>Description:</b> Configures how to respond when rule processing fails.
</p>
<p><b>Syntax:</b> <code>SecInterceptOnError On|Off </code>
</p>
<p><b>Example Usage:</b> <code>SecInterceptOnError On </code>
</p>
<p><b>Scope:</b> Main 
</p>
<p><b>Version:</b> 2.6-2.9.x
</p>
<p><b>Supported on libModSecurity:</b> TBI
</p>
<p>When an operator execution fails, that is it returns greater than 0, this directive configures how to react.  When set to "Off", the rule is just ignored and the engine will continue executing the rules in phase.  When set to "On", the rule will be just dropped and no more rules will be executed in the same phase, also no interception is made.
</p>

<h2>
<a id="user-content-secmarker" class="anchor" href="#secmarker" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-SecMarker"></a><span>SecMarker</span>
</h2>


<p><b>Description:</b> Adds a fixed rule marker that can be used as a target in a skipAfter action. A SecMarker directive essentially creates a rule that does nothing and whose only purpose is to carry the given ID.
</p>
<p><b>Syntax:</b> <code>SecMarker ID|TEXT </code>
</p>
<p><b>Example Usage</b>: <code>SecMarker 9999 </code>
</p>
<p><b>Scope:</b> Any 
</p>
<p><b>Version:</b> 2.5.0
</p>
<p>The value can be either a number or a text string.  The SecMarker directive is available to allow you to choose the best way to implement a skip-over. Here is an example used from the Core Rule Set:
</p><pre>SecMarker BEGIN_HOST_CHECK

        SecRule &amp;REQUEST_HEADERS:Host "@eq 0" \
                "skipAfter:END_HOST_CHECK,phase:2,rev:'2.1.1',t:none,block,msg:'Request Missing a Host Header',id:'960008',tag:'PROTOCOL_VIOLATION/MISSING_HEADER_HOST',tag:'WASCTC/WASC-21',tag:'OWASP_TOP_10/A7',tag:'PCI/6.5.10',severity:'5',setvar:'tx.msg=%{rule.msg}',setvar:tx.anomaly_score=+%{tx.notice_anomaly_score},setvar:tx.protocol_violation_score=+%{tx.notice_anomaly_score},setvar:tx.%{rule.id}-PROTOCOL_VIOLATION/MISSING_HEADER-%{matched_var_name}=%{matched_var}"
        SecRule REQUEST_HEADERS:Host "^$" \
                "phase:2,rev:'2.1.1',t:none,block,msg:'Request Missing a Host Header',id:'960008',tag:'PROTOCOL_VIOLATION/MISSING_HEADER_HOST',tag:'WASCTC/WASC-21',tag:'OWASP_TOP_10/A7',tag:'PCI/6.5.10',severity:'5',setvar:'tx.msg=%{rule.msg}',setvar:tx.anomaly_score=+%{tx.notice_anomaly_score},setvar:tx.protocol_violation_score=+%{tx.notice_anomaly_score},setvar:tx.%{rule.id}-PROTOCOL_VIOLATION/MISSING_HEADER-%{matched_var_name}=%{matched_var}"

SecMarker END_HOST_CHECK
</pre>


<h2>
<a id="user-content-secpcrematchlimit" class="anchor" href="#secpcrematchlimit" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-SecPcreMatchLimit"></a><span>SecPcreMatchLimit</span>
</h2>


<p><b>Description</b>: Sets the match limit in the PCRE library. 
</p>
<p><b>Syntax:</b> <code>SecPcreMatchLimit value </code>
</p>
<p><b>Example Usage</b>: <code>SecPcreMatchLimit 1500 </code>
</p>
<p><b>Scope:</b> Main
</p>
<p><b>Version</b>: 2.5.12
</p>
<p><b>Supported on libModSecurity:</b> Yes
</p>
<p><b>Default:</b> 1500
</p>
<p>The default can be changed when ModSecurity is prepared for compilation: the --enable-pcre-match-limit=val configure option will set a custom default and the --disable-pcre-match-limit option will revert back to the default of the PCRE library.
For more information, refer to the pcre_extra field in the pcreapi man page.
</p>

<dl><dt>Note : This directive is not allowed inside VirtualHosts. If enabled, it must be placed in a global server-wide configuration file such as your default modsecurity.conf.</dt></dl>


<h2>
<a id="user-content-secpcrematchlimitrecursion" class="anchor" href="#secpcrematchlimitrecursion" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-SecPcreMatchLimitRecursion"></a><span>SecPcreMatchLimitRecursion</span>
</h2>


<p><b>Description:</b> Sets the match limit recursion in the PCRE library. 
</p>
<p><b>Syntax:</b> <code>SecPcreMatchLimitRecursion value </code>
</p>
<p><b>Example Usage:</b> <code>SecPcreMatchLimitRecursion 1500 </code>
</p>
<p><b>Scope:</b> Main
</p>
<p><b>Version:</b> 2.5.12
</p>
<p><b>Supported on libModSecurity:</b> Yes
</p>
<p><b>Default:</b> 1500
</p>
<p>The default can be changed when ModSecurity is prepared for compilation: the --enable-pcre-match-limit-recursion=val configure option will set a custom default and the --disable-pcre-match-limit-recursion option will revert back to the default of the PCRE library.
For more information, refer to the pcre_extra field in the pcreapi man page.
</p>

<dl><dt>Note : This directive is not allowed inside VirtualHosts. If enabled, it must be placed in a global server-wide configuration file such as your default modsecurity.conf.</dt></dl>


<h2>
<a id="user-content-secpdfprotect" class="anchor" href="#secpdfprotect" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-SecPdfProtect"></a><span>SecPdfProtect</span>
</h2>


<p><b>Description:</b> Enables the PDF XSS protection functionality. 
</p>
<p><b>Syntax:</b> <code>SecPdfProtect On|Off </code>
</p>
<p><b>Example Usage:</b> <code>SecPdfProtect On </code>
</p>
<p><b>Scope:</b> Any 
</p>
<p><b>Version:</b> 2.5.0; removed from trunk
</p>
<p><b>Supported on libModSecurity:</b> No (Deprecated)
</p>
<p>Once enabled access to PDF files is tracked. Direct access attempts are redirected to links that contain one-time tokens. Requests with valid tokens are allowed through, unmodified. Requests with invalid tokens are also allowed through, but with forced download of the PDF files. This implementation uses response headers to detect PDF files and thus can be used with dynamically generated PDF files that do not have the .pdf extension in the request URI.
</p>

<h2>
<a id="user-content-secpdfprotectmethod" class="anchor" href="#secpdfprotectmethod" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-SecPdfProtectMethod"></a><span>SecPdfProtectMethod</span>
</h2>


<p><b>Description</b>: Configure desired protection method to be used when requests for PDF files are detected. 
</p>
<p><b>Syntax:</b> <code>SecPdfProtectMethod method </code>
</p>
<p><b>Example Usage</b>: <code>SecPdfProtectMethod TokenRedirection </code>
</p>
<p><b>Scope</b>: Any 
</p>
<p><b>Version:</b> 2.5.0; removed from trunk
</p>
<p><b>Supported on libModSecurity:</b> No (Deprecated)
</p>
<p><b>Default:</b> TokenRedirection
</p>
<p>Possible values are TokenRedirection and ForcedDownload. The token redirection approach will attempt to redirect with tokens where possible. This allows PDF files to continue to be opened inline but works only for GET requests. Forced download always causes PDF files to be delivered as opaque binaries and attachments. The latter will always be used for non-GET requests. Forced download is considered to be more secure but may cause usability problems for users (“This PDF won’t open anymore!”).
</p>

<h2>
<a id="user-content-secpdfprotectsecret" class="anchor" href="#secpdfprotectsecret" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-SecPdfProtectSecret"></a><span>SecPdfProtectSecret</span>
</h2>


<p><b>Description:</b> Defines the secret that will be used to construct one-time tokens. 
</p>
<p><b>Syntax:</b> <code>SecPdfProtectSecret secret </code>
</p>
<p><b>Example Usage:</b> <code>SecPdfProtectSecret MyRandomSecretString</code>
</p>
<p><b>Scope:</b> Any 
</p>
<p><b>Version:</b> 2.5.0; removed from trunk
</p>
<p><b>Supported on libModSecurity:</b> No (Deprecated)
</p>
<p>You should use a reasonably long value for the secret (e.g., 16 characters is good). Once selected, the secret should not be changed, as it will break the tokens that were sent prior to change. But it’s not a big deal even if you change it. It will just force download of PDF files with tokens that were issued in the last few seconds.
</p>

<h2>
<a id="user-content-secpdfprotecttimeout" class="anchor" href="#secpdfprotecttimeout" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-SecPdfProtectTimeout"></a><span>SecPdfProtectTimeout</span>
</h2>


<p><b>Description</b>: Defines the token timeout. 
</p>
<p><b>Syntax:</b> <code>SecPdfProtectTimeout timeout </code>
</p>
<p><b>Example Usage</b>: <code>SecPdfProtectTimeout 10 </code>
</p>
<p><b>Scope:</b> Any 
</p>
<p><b>Version:</b> 2.5.0; removed from trunk
</p>
<p><b>Supported on libModSecurity:</b> No (Deprecated)
</p>
<p><b>Default:</b> 10
</p>
<p>After token expires, it can no longer be used to allow access to a PDF file. Request will be allowed through but the PDF will be delivered as an attachment.
</p>

<h2>
<a id="user-content-secpdfprotecttokenname" class="anchor" href="#secpdfprotecttokenname" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-SecPdfProtectTokenName"></a><span>SecPdfProtectTokenName</span>
</h2>


<p><b>Description</b>: Defines the name of the token. 
</p>
<p><b>Syntax</b>: <code>SecPdfProtectTokenName name </code>
</p>
<p><b>Example Usage</b>: <code>SecPdfProtectTokenName PDFTOKEN </code>
</p>
<p><b>Scope</b>: Any 
</p>
<p><b>Version</b>: 2.5.0; removed from trunk
</p>
<p><b>Supported on libModSecurity:</b> No (Deprecated)
</p>
<p><b>Default:</b> PDFTOKEN
</p>
<p>The only reason you would want to change the name of the token is if you wanted to hide the fact that you are running ModSecurity. It’s a good reason, but it won’t really help, as the adversary can look into the algorithm used for PDF protection and figure it out anyway. It does raise the bar slightly, so go ahead if you want to.
</p>

<h2>
<a id="user-content-secreadstatelimit" class="anchor" href="#secreadstatelimit" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-SecReadStateLimit"></a><span>SecReadStateLimit</span>
</h2>


<p><b>Description:</b> Establishes a per-IP address limit of how many connections are allowed to be in SERVER_BUSY_READ state. 
</p>
<p><b>Syntax:</b> <code>SecReadStateLimit LIMIT </code>
</p>
<p><b>Example Usage</b>: <code>SecReadStateLimit 50 </code>
</p>
<p><b>Scope</b>: Main 
</p>
<p><b>Version</b>: 2.5.13, DEPRECATED as of v2.8.0.
</p>
<p><b>Supported on libModSecurity:</b> No (Deprecated)
</p>
<p><b>Default:</b> 0 (no limit)
</p>
<p>For v2.8.0 or newest refer to SecConnReadStateLimit.
</p>

<h2>
<a id="user-content-secconnreadstatelimit" class="anchor" href="#secconnreadstatelimit" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-SecConnReadStateLimit"></a><span>SecConnReadStateLimit</span>
</h2>


<p><b>Description:</b> Establishes a per-IP address limit of how many connections are allowed to be in SERVER_BUSY_READ state. 
</p>
<p><b>Syntax:</b> <code>SecConnReadStateLimit LIMIT OPTIONAL_IP_MATCH_OPERATOR</code>
</p>
<p><b>Example Usage</b>: <code>SecConnReadStateLimit 50 "!@ipMatch 127.0.0.1"</code>
</p>
<p><b>Scope</b>: Main 
</p>
<p><b>Version</b>: v2.8.0-2.9.x (Apache only)
</p>
<p><b>Supported on libModSecurity:</b> TBI
</p>
<p><b>Default:</b> 0 (no limit)
</p>
<p>This measure is effective against Slowloris-style attacks from a single IP address, but it may not be as good against modified attacks that work by slowly sending request body content. This is because Apache to switches state to SERVER_BUSY_WRITE once request headers have been read. As an alternative, consider mod_reqtimeout (part of Apache as of 2.2.15), which is expected be effective against both attack types.  See Blog post on mitigating slow DoS attacks - <a href="http://blog.spiderlabs.com/2010/11/advanced-topic-of-the-week-mitigating-slow-http-dos-attacks.html">http://blog.spiderlabs.com/2010/11/advanced-topic-of-the-week-mitigating-slow-http-dos-attacks.html</a>. v2.8.0 and newest supports the @ipMatch, @ipMatchF and @ipMatchFromFile operator along with the its negative (e.g. !@ipMatch) these were used to create suspicious or whitelist. When a suspicious list is informed, just the IPs that belongs to the list will be filtered. A combination of suspicious and whitelist is possible by using multiple definitions of SecConnReadStateLimit, note, however, that the limit will be always overwrite by its successor.
</p>
<p><b>Note:</b> This functionality is Apache only.
</p>
<p><b>Note 2:</b> Make sure <a class="internal present" href="/SpiderLabs/ModSecurity/wiki/Reference-Manual#secconnengine">Reference-Manual#secconnengine</a> is on prior to use this feature.
</p>

<h2>
<a id="user-content-secsensorid" class="anchor" href="#secsensorid" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-SecSensorId"></a><span>SecSensorId</span>
</h2>


<p><b>Description:</b> Define a sensor ID that will be present into log part H. 
</p>
<p><b>Syntax:</b> <code>SecSensorId TEXT </code>
</p>
<p><b>Example Usage</b>: <code>SecSensorId WAFSensor01 </code>
</p>
<p><b>Scope</b>: Main 
</p>
<p><b>Version</b>: 2.7.0-2.9.x
</p>
<p><b>Supported on libModSecurity:</b> TBI 
</p>

<h2>
<a id="user-content-secwritestatelimit" class="anchor" href="#secwritestatelimit" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-SecWriteStateLimit"></a><span>SecWriteStateLimit</span>
</h2>


<p><b>Description:</b> Establishes a per-IP address limit of how many connections are allowed to be in SERVER_BUSY_WRITE state. 
</p>
<p><b>Syntax:</b> <code>SecWriteStateLimit LIMIT </code>
</p>
<p><b>Example Usage</b>: <code>SecWriteStateLimit 50 </code>
</p>
<p><b>Scope</b>: Main 
</p>
<p><b>Version</b>: 2.6.0, DEPRECATED as of v2.8.0.
</p>
<p><b>Supported on libModSecurity:</b> No (Deprecated)
</p>
<p><b>Default:</b> 0 (no limit)
</p>
<p>For v2.8.0 or newest refer to SecConnWriteStateLimit.
</p>

<h2>
<a id="user-content-secconnwritestatelimit" class="anchor" href="#secconnwritestatelimit" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-SecConnWriteStateLimit"></a><span>SecConnWriteStateLimit</span>
</h2>


<p><b>Description:</b> Establishes a per-IP address limit of how many connections are allowed to be in SERVER_BUSY_WRITE state. 
</p>
<p><b>Syntax:</b> <code>SecConnWriteStateLimit LIMIT OPTIONAL_IP_MATCH_OPERATOR</code>
</p>
<p><b>Example Usage</b>: <code>SecConnWriteStateLimit 50 "!ipMatch 127.0.0.1"</code>
</p>
<p><b>Scope</b>: Main 
</p>
<p><b>Version</b>: 2.6.0-2.9.x (Apache only)
</p>
<p><b>Supported on libModSecurity:</b> TBI
</p>
<p><b>Default:</b> 0 (no limit)
</p>
<p>This measure is effective against Slow DoS request body attacks. v2.8.0 and newest supports the @ipMatch, @ipMatchF and @ipMatchFromFile operator along with the its negative (e.g. !@ipMatch) these were used to create suspicious or whitelist. When a suspicious list is informed, just the IPs that belongs to the list will be filtered. A combination of suspicious and whitelist is possible by using multiple definitions of SecConnReadStateLimit, note, however, that the limit will be always overwrite by its successor.
</p>
<p><b>Note:</b> This functionality is Apache only.
</p>
<p><b>Note 2:</b> Make sure <a class="internal present" href="/SpiderLabs/ModSecurity/wiki/Reference-Manual#secconnengine">Reference-Manual#secconnengine</a> is on prior to use this feature.
</p>

<h2>
<a id="user-content-secremoterules" class="anchor" href="#secremoterules" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-SecRemoteRules"></a><span>SecRemoteRules</span>
</h2>


<p><b>Description</b>: Load rules from a given file hosted on a HTTPS site.
</p>
<p><b>Syntax:</b> <code>SecRemoteRules [crypto] key https://url </code>
</p>
<p><b>Example Usage</b>: <code>SecRemoteRules some-key https://www.yourserver.com/plain-text-rules.txt</code>
</p>
<p><b>Scope:</b> Any 
</p>
<p><b>Version:</b> 2.9.0-RC1+
</p>
<p><b>Supported on libModSecurity:</b> Yes
</p>
<p>This is an optional directive that allow the user to load rules from a remote server. Notice that besides the URL the user also needs to supply a key, which could be used by the target server to provide different content for different keys. 
</p>
<p>Along with the key, supplied by the users, ModSecurity will also send its Unique ID and the `status call' in the format of headers to the target web server. The following headers are used:
</p>
<pre> - ModSec-status
 - ModSec-unique-id
 - ModSec-key
</pre>


<p>The optional option "crypto" tells ModSecurity to expect some encrypted content from server. The utilization of SecRemoteRules is only allowed over TLS, thus, this option may not be necessary.
</p>

<dl><dt>Note : A valid and trusted digital certificate is expected on the end server. It is also expected that the server uses TLS, preferable TLS 1.2. </dt></dl>


<h2>
<a id="user-content-secremoterulesfailaction" class="anchor" href="#secremoterulesfailaction" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-SecRemoteRulesFailAction"></a><span>SecRemoteRulesFailAction</span>
</h2>


<p><b>Description</b>: Action that will be taken if SecRemoteRules specify an URL that ModSecurity was not able to download.
</p>
<p><b>Syntax:</b> <code>SecRemoteRulesFailAction Abort|Warn </code>
</p>
<p><b>Example Usage</b>: <code>SecRemoteRulesFailAction Abort</code>
</p>
<p><b>Scope:</b> Any 
</p>
<p><b>Version:</b> 2.9.0-RC1+
</p>
<p><b>Supported on libModSecurity:</b> Yes
</p>
<p>The default action is to Abort whenever there is a problem downloading a given URL.
</p>

<dl><dt>Note : This directive also influences the behaviour of @ipMatchFromFile when used with a HTTPS URI to retrieve the remote file.</dt></dl>


<h2>
<a id="user-content-secrequestbodyaccess" class="anchor" href="#secrequestbodyaccess" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-SecRequestBodyAccess"></a><span>SecRequestBodyAccess</span>
</h2>


<p><b>Description</b>: Configures whether request bodies will be buffered and processed by ModSecurity.
</p>
<p><b>Syntax:</b> <code>SecRequestBodyAccess On|Off </code>
</p>
<p><b>Example Usage</b>: <code>SecRequestBodyAccess On</code>
</p>
<p><b>Scope:</b> Any 
</p>
<p><b>Version:</b> 2.0.0
</p>
<p><b>Supported on libModSecurity:</b> Yes
</p>
<p>This directive is required if you want to inspect the data transported request bodies (e.g., POST parameters). Request buffering is also required in order to make reliable blocking possible.  The possible values are:


</p><ul>
<li>On: buffer request bodies</li>
<li>Off: do not buffer request bodies</li>
</ul>


<h2>
<a id="user-content-secrequestbodyinmemorylimit" class="anchor" href="#secrequestbodyinmemorylimit" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-SecRequestBodyInMemoryLimit"></a><span>SecRequestBodyInMemoryLimit</span>
</h2>


<p><b>Description</b>: Configures the maximum request body size that ModSecurity will store in memory.
</p>
<p><b>Syntax:</b> <code>SecRequestBodyInMemoryLimit LIMIT_IN_BYTES </code>
</p>
<p><b>Example Usage:</b> <code>SecRequestBodyInMemoryLimit 131072 </code>
</p>
<p><b>Scope:</b> Any 
</p>
<p><b>Version:</b> 2.0.0-2.9.x
</p>
<p><b>Supported on libModSecurity:</b> No
</p>
<p><b>Default:</b> 131072 (128 KB) 
</p>
<p>When a multipart/form-data request is being processed, once the in-memory limit is reached, the request body will start to be streamed into a temporary file on disk.
</p>

<dl><dt>Note : libModSecurity is able to deal with request body in a file or in a buffer (chunked or not). Web servers have properties which controls whenever a request should be saved to a file or used as a buffer (e.g. client_body_buffer_size <a href="https://nginx.org/en/docs/http/ngx_http_core_module.html#client_body_buffer_size">https://nginx.org/en/docs/http/ngx_http_core_module.html#client_body_buffer_size</a>) . If it is a file, ModSecurity will use the file to perform the inspection. If not, the buffer will be used.</dt></dl>


<h2>
<a id="user-content-secrequestbodylimit" class="anchor" href="#secrequestbodylimit" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-SecRequestBodyLimit"></a><span>SecRequestBodyLimit</span>
</h2>


<p><b>Description:</b> Configures the maximum request body size ModSecurity will accept for buffering.
</p>
<p><b>Syntax:</b> <code>SecRequestBodyLimit LIMIT_IN_BYTES </code>
</p>
<p><b>Example Usage:</b> <code>SecRequestBodyLimit 134217728 </code>
</p>
<p><b>Scope:</b> Any 
</p>
<p><b>Version:</b> 2.0.0
</p>
<p><b>Supported on libModSecurity:</b> Yes
</p>
<p><b>Default:</b> 134217728 (131072 KB) 
</p>
<p>Anything over the limit will be rejected with status code 413 (Request Entity Too Large). There is a hard limit of 1 GB.

</p><dl><dt>Note : In ModSecurity 2.5.x and earlier, SecRequestBodyLimit works only when used in the main server configuration, or a VirtualHost container. In these versions, request body limit is enforced immediately after phase 1, but before phase 2 configuration (i.e. whatever is placed in a Location container) is resolved.  You can work around this limitation by using a phase 1 rule that changes the request body limit dynamically, using the ctl:requestBodyLimit action. ModSecurity 2.6.x (currently in the trunk only) and better do not have this limitation.</dt></dl>


<h2>
<a id="user-content-secrequestbodynofileslimit" class="anchor" href="#secrequestbodynofileslimit" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-SecRequestBodyNoFilesLimit"></a><span>SecRequestBodyNoFilesLimit</span>
</h2>


<p><b>Description</b>: Configures the maximum request body size ModSecurity will accept for buffering, excluding the size of any files being transported in the request. This directive is useful to reduce susceptibility to DoS attacks when someone is sending request bodies of very large sizes. Web applications that require file uploads must configure SecRequestBodyLimit to a high value, but because large files are streamed to disk, file uploads will not increase memory consumption. However, it’s still possible for someone to take advantage of a large request body limit and send non-upload requests with large body sizes. This directive eliminates that loophole.
</p>
<p><b>Syntax:</b> <code>SecRequestBodyNoFilesLimit NUMBER_IN_BYTES </code>
</p>
<p><b>Example Usage:</b> <code>SecRequestBodyNoFilesLimit 131072 </code>
</p>
<p><b>Scope:</b> Any 
</p>
<p><b>Version</b>: 2.5.0
</p>
<p><b>Supported on libModSecurity:</b> Yes
</p>
<p><b>Default:</b> 1048576 (1 MB)
</p>
<p>Generally speaking, the default value is not small enough. For most applications, you should be able to reduce it down to 128 KB or lower. Anything over the limit will be rejected with status code 413 (Request Entity Too Large). There is a hard limit of 1 GB.
</p>

<h2>
<a id="user-content-secrequestbodylimitaction" class="anchor" href="#secrequestbodylimitaction" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-SecRequestBodyLimitAction"></a><span>SecRequestBodyLimitAction</span>
</h2>


<p><b>Description</b>: Controls what happens once a request body limit, configured with SecRequestBodyLimit, is encountered
</p>
<p><b>Syntax:</b> <code>SecRequestBodyLimitAction Reject|ProcessPartial </code>
</p>
<p><b>Example Usage:</b> <code>SecRequestBodyLimitAction ProcessPartial</code>
</p>
<p><b>Scope:</b> Any 
</p>
<p><b>Version</b>: 2.6.0
</p>
<p><b>Supported on libModSecurity:</b> Yes
</p>
<p>By default, ModSecurity will reject a request body that is longer than specified.  This is problematic especially when ModSecurity is being run in DetectionOnly mode and the intent is to be totally passive and not take any disruptive actions against the transaction. With the ability to choose what happens once a limit is reached, site administrators can choose to inspect only the first part of the request, the part that can fit into the desired limit, and let the rest through.  This is not ideal from a possible evasion issue perspective, however it may be acceptable under certain circumstances.
</p>

<dl><dt>Note : When the SecRuleEngine is set to DetectionOnly, SecRequestBodyLimitAction is automatically set to ProcessPartial in order to not cause any disruptions.  If you want to know if/when a request body size is over your limit, you can create a rule to check for the existence of the INBOUND_ERROR_DATA variable.</dt></dl>


<h2>
<a id="user-content-secresponsebodylimit" class="anchor" href="#secresponsebodylimit" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-SecResponseBodyLimit"></a><span>SecResponseBodyLimit</span>
</h2>


<p><b>Description:</b> Configures the maximum response body size that will be accepted for buffering.
</p>
<p><b>Syntax:</b> <code>SecResponseBodyLimit LIMIT_IN_BYTES </code>
</p>
<p><b>Example Usage:</b> <code>SecResponseBodyLimit 524228 </code>
</p>
<p><b>Scope:</b> Any 
</p>
<p><b>Version:</b> 2.0.0
</p>
<p><b>Supported on libModSecurity:</b> Yes
</p>
<p><b>Default</b>: 524288 (512 KB)
</p>
<p>Anything over this limit will be rejected with status code 500 (Internal Server Error). This setting will not affect the responses with MIME types that are not selected for buffering. There is a hard limit of 1 GB.
</p>

<h2>
<a id="user-content-secresponsebodylimitaction" class="anchor" href="#secresponsebodylimitaction" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-SecResponseBodyLimitAction"></a><span>SecResponseBodyLimitAction</span>
</h2>


<p><b>Description:</b> Controls what happens once a response body limit, configured with SecResponseBodyLimit, is encountered. 
</p>
<p><b>Syntax:</b> <code>SecResponseBodyLimitAction Reject|ProcessPartial </code>
</p>
<p><b>Example Usage:</b> <code>SecResponseBodyLimitAction ProcessPartial </code>
</p>
<p><b>Scope:</b> Any 
</p>
<p><b>Version:</b> 2.5.0
</p>
<p><b>Supported on libModSecurity:</b> Yes
</p>
<p>By default, ModSecurity will reject a response body that is longer than specified. Some web sites, however, will produce very long responses, making it difficult to come up with a reasonable limit. Such sites would have to raise the limit significantly to function properly, defying the purpose of having the limit in the first place (to control memory consumption). With the ability to choose what happens once a limit is reached, site administrators can choose to inspect only the first part of the response, the part that can fit into the desired limit, and let the rest through. Some could argue that allowing parts of responses to go uninspected is a weakness. This is true in theory, but applies only to cases in which the attacker controls the output (e.g., can make it arbitrary long). In such cases, however, it is not possible to prevent leakage anyway. The attacker could compress, obfuscate, or even encrypt data before it is sent back, and therefore bypass any monitoring device.
</p>

<h2>
<a id="user-content-secresponsebodymimetype" class="anchor" href="#secresponsebodymimetype" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-SecResponseBodyMimeType"></a><span>SecResponseBodyMimeType</span>
</h2>


<p><b>Description:</b> Configures which MIME types are to be considered for response body buffering. 
</p>
<p><b>Syntax:</b> <code>SecResponseBodyMimeType MIMETYPE MIMETYPE ... </code>
</p>
<p><b>Example Usage</b>: <code>SecResponseBodyMimeType text/plain text/html text/xml</code>
</p>
<p><b>Scope:</b> Any
</p>
<p><b>Version:</b> 2.0.0
</p>
<p><b>Supported on libModSecurity:</b> Yes
</p>
<p><b>Default:</b> text/plain text/html
</p>
<p>Multiple SecResponseBodyMimeType directives can be used to add MIME types. Use SecResponseBodyMimeTypesClear to clear previously configured MIME types and start over.
</p>

<h2>
<a id="user-content-secresponsebodymimetypesclear" class="anchor" href="#secresponsebodymimetypesclear" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-SecResponseBodyMimeTypesClear"></a><span>SecResponseBodyMimeTypesClear</span>
</h2>


<p><b>Description:</b> Clears the list of MIME types considered for response body buffering, allowing you to start populating the list from scratch.
</p>
<p><b>Syntax:</b> <code>SecResponseBodyMimeTypesClear </code>
</p>
<p><b>Example Usage:</b> <code>SecResponseBodyMimeTypesClear </code>
</p>
<p><b>Scope:</b> Any 
</p>
<p><b>Version:</b> 2.0.0-2.9.x
</p>
<p><b>Supported on libModSecurity:</b> TBI
</p>

<h2>
<a id="user-content-secresponsebodyaccess" class="anchor" href="#secresponsebodyaccess" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-SecResponseBodyAccess"></a><span>SecResponseBodyAccess</span>
</h2>


<p><b>Description:</b> Configures whether response bodies are to be buffered. 
</p>
<p><b>Syntax:</b> <code>SecResponseBodyAccess On|Off </code>
</p>
<p><b>Example Usage:</b> <code>SecResponseBodyAccess On </code>
</p>
<p><b>Scope:</b> Any
</p>
<p><b>Version:</b> 2.0.0
</p>
<p><b>Supported on libModSecurity:</b> Yes
</p>
<p><b>Default:</b> Off
</p>
<p>This directive is required if you plan to inspect HTML responses and implement response blocking.  Possible values are: 


</p><ul>
<li>On: buffer response bodies (but only if the response MIME type matches the list configured with SecResponseBodyMimeType). </li>
<li>Off: do not buffer response bodies.</li>
</ul>


<h2>
<a id="user-content-secrule" class="anchor" href="#secrule" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-SecRule"></a><span>SecRule</span>
</h2>


<p><b>Description:</b> Creates a rule that will analyze the selected variables using the selected operator. 
</p>
<p><b>Syntax:</b> <code>SecRule VARIABLES OPERATOR [ACTIONS] </code>
</p>
<p><b>Example Usage:</b> <code>SecRule ARGS "@rx attack" "phase:1,log,deny,id:1" </code>
</p>
<p><b>Scope:</b> Any
</p>
<p><b>Version:</b> 2.0.0
</p>
<p><b>Supported on libModSecurity:</b> Yes
</p>
<p>Every rule must provide one or more variables along with the operator that should be used to inspect them. If no actions are provided, the default list will be used. (There is always a default list, even if one was not explicitly set with SecDefaultAction.) If there are actions specified in a rule, they will be merged with the default list to form the final actions that will be used. (The actions in the rule will overwrite those in the default list.) Refer to SecDefaultAction for more information.
</p>

<h2>
<a id="user-content-secruleinheritance" class="anchor" href="#secruleinheritance" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-SecRuleInheritance"></a><span>SecRuleInheritance</span>
</h2>


<p><b>Description:</b> Configures whether the current context will inherit the rules from the parent context.
</p>
<p><b>Syntax:</b> <code>SecRuleInheritance On|Off </code>
</p>
<p><b>Example Usage:</b> <code>SecRuleInheritance Off </code>
</p>
<p><b>Scope:</b> Any 
</p>
<p><b>Version:</b> 2.0.0-2.9.x
</p>
<p><b>Supported on libModSecurity:</b> TBI
</p>
<p><b>Default:</b> On
</p>
<p>Sometimes when you create a more specific configuration context (for example using the  container), you may wish to use a different set of rules than those used in the parent context. By setting SecRuleInheritance to Off, you prevent the parent rules to be inherited, which allows you to start from scratch. In ModSecurity 2.5.x it is not possible to override phase 1 rules from a  configuration context. There are no limitations in that respect in the current development version (and there won’t be in the next major version).
</p>
<p>The possible values are: 



</p><ul>
<li>On: inherit rules from the parent context </li>
<li>Off: do not inherit rules from the parent context</li>
</ul><dl><dt>Note : Configuration contexts are an Apache concept. Directives , , , and  are all used to create configuration contexts. For more information, please go to the Apache documentation, under Configuration Sections <a href="http://httpd.apache.org/docs/2.0/sections.html">http://httpd.apache.org/docs/2.0/sections.html</a>. This directive does not affect how configuration options are inherited.
</dt></dl>


<h2>
<a id="user-content-secruleengine" class="anchor" href="#secruleengine" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-SecRuleEngine"></a><span>SecRuleEngine</span>
</h2>


<p><b>Description:</b> Configures the rules engine. 
</p>
<p><b>Syntax:</b> <code>SecRuleEngine On|Off|DetectionOnly</code>
</p>
<p><b>Example Usage:</b> <code>SecRuleEngine On </code>
</p>
<p><b>Scope</b>: Any 
</p>
<p><b>Version:</b> 2.0.0
</p>
<p><b>Supported on libModSecurity:</b> Yes
</p>
<p><b>Default:</b> Off
</p>
<p>The possible values are: 



</p><ul>
<li>
<b>On</b>: process rules</li>
<li>
<b>Off</b>: do not process rules </li>
<li>
<b>DetectionOnly</b>: process rules but never executes any disruptive actions (block, deny, drop, allow, proxy and redirect)</li>
</ul>


<h2>
<a id="user-content-secruleperftime" class="anchor" href="#secruleperftime" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-SecRulePerfTime"></a><span>SecRulePerfTime</span>
</h2>


<p><b>Description:</b> Set a performance threshold for rules. Rules that spend at least the time defined will be logged into audit log Part H as Rules-Performance-Info in the format id=usec, comma separated. 
</p>
<p><b>Syntax:</b> <code>SecRulePerfTime USECS </code>
</p>
<p><b>Example Usage:</b> <code>SecRulePerfTime 1000 </code>
</p>
<p><b>Scope:</b> Any
</p>
<p><b>Version:</b> 2.7-2.9.x
</p>
<p><b>Supported on libModSecurity:</b> TBI
</p>
<p>The rules hitting the threshold can be accessed via the collection PERF_RULES.
</p>

<h2>
<a id="user-content-secruleremovebyid" class="anchor" href="#secruleremovebyid" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-SecRuleRemoveById"></a><span>SecRuleRemoveById</span>
</h2>


<p><b>Description:</b> Removes the matching rules from the current configuration context. 
</p>
<p><b>Syntax:</b> <code>SecRuleRemoveById ID ID RANGE ... </code>
</p>
<p><b>Example Usage:</b> <code>SecRuleRemoveByID 1 2 "9000-9010" </code>
</p>
<p><b>Scope:</b> Any
</p>
<p><b>Version:</b> 2.0.0 - 3.x(pre)
</p>
<p><b>Supported on libModSecurity:</b> Yes
</p>
<p>This directive supports multiple parameters, each of which can be a rule ID or a range. Parameters that contain spaces must be delimited using double quotes.
</p>

<dl><dt>Note : <b>This directive must be specified after the rule in which it is disabling</b>.  This should be used within local custom rule files that are processed after third party rule sets.  Example file - modsecurity_crs_60_customrules.conf.</dt></dl>


<h2>
<a id="user-content-secruleremovebymsg" class="anchor" href="#secruleremovebymsg" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-SecRuleRemoveByMsg"></a><span>SecRuleRemoveByMsg</span>
</h2>


<p><b>Description:</b> Removes the matching rules from the current configuration context. 
</p>
<p><b>Syntax:</b> <code>SecRuleRemoveByMsg REGEX </code>
</p>
<p><b>Example Usage:</b> <code>SecRuleRemoveByMsg "FAIL" </code>
</p>
<p><b>Scope:</b> Any
</p>
<p><b>Version:</b> 2.0.0-2.9.x
</p>
<p><b>Supported on libModSecurity:</b> TBI
</p>
<p>Normally, you would use SecRuleRemoveById to remove rules, but that requires the rules to have IDs defined. If they don’t, then you can remove them with SecRuleRemoveByMsg, which matches a regular expression against rule messages.
</p>

<dl><dt>Note : This directive must be specified after the rule in which it is disabling. This should be used within local custom rule files that are processed after third party rule sets. Example file - modsecurity_crs_60_customrules.conf.</dt></dl>


<h2>
<a id="user-content-secruleremovebytag" class="anchor" href="#secruleremovebytag" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-SecRuleRemoveByTag"></a><span>SecRuleRemoveByTag</span>
</h2>


<p><b>Description:</b> Removes the matching rules from the current configuration context. 
</p>
<p><b>Syntax:</b> <code>SecRuleRemoveByTag REGEX </code>
</p>
<p><b>Example Usage:</b> <code>SecRuleRemoveByTag "WEB_ATTACK/XSS" </code>
</p>
<p><b>Scope:</b> Any
</p>
<p><b>Version:</b> 2.6-2.9.x
</p>
<p><b>Supported on libModSecurity:</b> TBI
</p>
<p>Normally, you would use SecRuleRemoveById to remove rules, but that requires the rules to have IDs defined. If they don’t, then you can remove them with SecRuleRemoveByTag, which matches a regular expression against rule tag data.  This is useful if you want to disable entire groups of rules based on tag data.  Example tags used in the OWASP ModSecurity CRS include:

















</p><ul>
<li>AUTOMATION/MALICIOUS</li>
<li>AUTOMATION/MISC</li>
<li>AUTOMATION/SECURITY_SCANNER</li>
<li>LEAKAGE/SOURCE_CODE_ASP_JSP</li>
<li>LEAKAGE/SOURCE_CODE_CF</li>
<li>LEAKAGE/SOURCE_CODE_PHP</li>
<li>WEB_ATTACK/CF_INJECTION</li>
<li>WEB_ATTACK/COMMAND_INJECTION</li>
<li>WEB_ATTACK/FILE_INJECTION</li>
<li>WEB_ATTACK/HTTP_RESPONSE_SPLITTING</li>
<li>WEB_ATTACK/LDAP_INJECTION</li>
<li>WEB_ATTACK/PHP_INJECTION</li>
<li>WEB_ATTACK/REQUEST_SMUGGLING</li>
<li>WEB_ATTACK/SESSION_FIXATION</li>
<li>WEB_ATTACK/SQL_INJECTION</li>
<li>WEB_ATTACK/SSI_INJECTION</li>
<li>WEB_ATTACK/XSS</li>
</ul>


<dl><dt>Note : This directive must be specified after the rule in which it is disabling. This should be used within local custom rule files that are processed after third party rule sets. Example file - modsecurity_crs_60_customrules.conf.</dt></dl>


<h2>
<a id="user-content-secrulescript" class="anchor" href="#secrulescript" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-SecRuleScript"></a><span>SecRuleScript</span>
</h2>


<p>Description: This directive creates a special rule that executes a Lua script to decide whether to match or not. The main difference from SecRule is that there are no targets nor operators. The script can fetch any variable from the ModSecurity context and use any (Lua) operator to test them. The second optional parameter is the list of actions whose meaning is identical to that of SecRule.
</p>
<p><b>Syntax:</b> <code>SecRuleScript /path/to/script.lua [ACTIONS]</code>
</p>
<p><b>Example Usage:</b> <code>SecRuleScript "/path/to/file.lua" "block"</code>
</p>
<p><b>Scope:</b> Any
</p>
<p><b>Version:</b> 2.5.0-2.9.x
</p>
<p><b>Supported on libModSecurity:</b> TBI
</p>

<dl><dt>Note : All Lua scripts are compiled at configuration time and cached in memory. To reload scripts you must reload the entire ModSecurity configuration by restarting Apache.</dt></dl>

<p>Example script:
</p><pre>-- Your script must define the main entry
-- point, as below.
function main()
    -- Log something at level 1. Normally you shouldn't be
    -- logging anything, especially not at level 1, but this is
    -- just to show you can. Useful for debugging.
    m.log(1, "Hello world!");

    -- Retrieve one variable.
    local var1 = m.getvar("REMOTE_ADDR");

    -- Retrieve one variable, applying one transformation function.
    -- The second parameter is a string.
    local var2 = m.getvar("ARGS", "lowercase");

    -- Retrieve one variable, applying several transformation functions.
    -- The second parameter is now a list. You should note that m.getvar()
    -- requires the use of comma to separate collection names from
    -- variable names. This is because only one variable is returned.
    local var3 = m.getvar("ARGS.p", { "lowercase", "compressWhitespace" } );

    -- If you want this rule to match return a string
    -- containing the error message. The message must contain the name
    -- of the variable where the problem is located.
    -- return "Variable ARGS:p looks suspicious!"

    -- Otherwise, simply return nil.
    return nil;
end
</pre>
<p>In this first example we were only retrieving one variable at the time. In this case the name of the variable is known to you. In many cases, however, you will want to examine variables whose names you won't know in advance, for example script parameters.
</p>
<p>Example showing use of m.getvars() to retrieve many variables at once:
</p><pre>function main()
    -- Retrieve script parameters.
    local d = m.getvars("ARGS", { "lowercase", "htmlEntityDecode" } );

    -- Loop through the paramters.
    for i = 1, #d do
        -- Examine parameter value.
        if (string.find(d[i].value, "&lt;script")) then
            -- Always specify the name of the variable where the
            -- problem is located in the error message.
            return ("Suspected XSS in variable " .. d[i].name .. ".");
        end
    end

    -- Nothing wrong found.
    return nil;
end
</pre>

<dl><dt>Note : Go to <a href="http://www.lua.org/">http://www.lua.org/</a> to find more about the Lua programming language. The reference manual too is available online, at <a href="http://www.lua.org/manual/5.1/">http://www.lua.org/manual/5.1/</a>.</dt></dl>


<dl><dt>Note : Lua support is marked as experimental as the way the progamming interface may continue to evolve while we are working for the best implementation style. Any user input into the programming interface is appreciated.</dt></dl>


<h2>
<a id="user-content-secruleupdateactionbyid" class="anchor" href="#secruleupdateactionbyid" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-SecRuleUpdateActionById"></a><span>SecRuleUpdateActionById</span>
</h2>


<p><b>Description:</b> Updates the action list of the specified rule.
</p>
<p><b>Syntax:</b> <code>SecRuleUpdateActionById RULEID[:offset] ACTIONLIST</code>
</p>
<p><b>Example Usage:</b> <code>SecRuleUpdateActionById 12345 "deny,status:403"</code>
</p>
<p><b>Scope:</b> Any
</p>
<p><b>Version:</b> 2.6.0-2.9.x
</p>
<p><b>Supported on libModSecurity:</b> TBI
</p>
<p>This directive will overwrite the action list of the specified rule with the actions provided in the second parameter. It has two limitations: it cannot be used to change the ID or phase of a rule. Only the actions that can appear only once are overwritten. The actions that are allowed to appear multiple times in a list, will be appended to the end of the list.
</p><pre>SecRule ARGS attack "phase:2,id:12345,t:lowercase,log,pass,msg:'Message text'"
SecRuleUpdateActionById 12345 "t:none,t:compressWhitespace,deny,status:403,msg:'New message text'"
</pre>
The effective resulting rule in the previous example will be as follows:
<pre>SecRule ARGS attack "phase:2,id:12345,t:lowercase,t:none,t:compressWhitespace,deny,status:403,msg:'New Message text'"
</pre>
The addition of t:none will neutralize any previous transformation functions specified (t:lowercase, in the example).


<dl><dt>Note : If the target rule is a chained rule, you must currently specify chain in the SecRuleUpdateActionById action list as well.  This will be fixed in a future version.</dt></dl>


<h2>
<a id="user-content-secruleupdatetargetbyid" class="anchor" href="#secruleupdatetargetbyid" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-SecRuleUpdateTargetById"></a><span>SecRuleUpdateTargetById</span>
</h2>


<p><b>Description:</b> Updates the target (variable) list of the specified rule.
</p>
<p><b>Syntax:</b> <code>SecRuleUpdateTargetById RULEID TARGET1[,TARGET2,TARGET3] REPLACED_TARGET</code>
</p>
<p><b>Example Usage:</b> <code>SecRuleUpdateTargetById 12345 "!ARGS:foo"</code>
</p>
<p><b>Scope:</b> Any
</p>
<p><b>Version:</b> 2.6-3.0(pre)
</p>
<p><b>Supported on libModSecurity:</b> Yes
</p>
<p>This directive will append (or replace) variables to the current target list of the specified rule with the targets provided in the second parameter. Starting with 2.7.0 this feature supports id range.
</p>
<p><b>Explicitly Appending Targets</b>
</p>
<p>This is useful for implementing exceptions where you want to externally update a target list to exclude inspection of specific variable(s).
</p><pre>SecRule REQUEST_FILENAME|ARGS_NAMES|ARGS|XML:/* "[\;\|\`]\W*?\bmail\b" \
     "phase:2,rev:'2.1.1',capture,t:none,t:htmlEntityDecode,t:compressWhitespace,t:lowercase,ctl:auditLogParts=+E,block,msg:'System Command Injection',id:'958895',tag:'WEB_ATTACK/COMMAND_INJECTION',tag:'WASCTC/WASC-31',tag:'OWASP_TOP_10/A1',tag:'PCI/6.5.2',logdata:'%{TX.0}',severity:'2',setvar:'tx.msg=%{rule.msg}',setvar:tx.anomaly_score=+%{tx.critical_anomaly_score},setvar:tx.command_injection_score=+%{tx.critical_anomaly_score},setvar:tx.%{rule.id}-WEB_ATTACK/COMMAND_INJECTION-%{matched_var_name}=%
{tx.0}"

SecRuleUpdateTargetById 958895 !ARGS:email
</pre>
<p>The effective resulting rule in the previous example will append the target to the end of the variable list as follows:
</p><pre>SecRule REQUEST_FILENAME|ARGS_NAMES|ARGS|XML:/*|!ARGS:email "[\;\|\`]\W*?\bmail\b" \
     "phase:2,rev:'2.1.1',capture,t:none,t:htmlEntityDecode,t:compressWhitespace,t:lowercase,ctl:auditLogParts=+E,block,msg:'System Command Injection',id:'958895',tag:'WEB_ATTACK/COMMAND_INJECTION',tag:'WASCTC/WASC-31',tag:'OWASP_TOP_10/A1',tag:'PCI/6.5.2',logdata:'%{TX.0}',severity:'2',setvar:'tx.msg=%{rule.msg}',setvar:tx.anomaly_score=+%{tx.critical_anomaly_score},setvar:tx.command_injection_score=+%{tx.critical_anomaly_score},setvar:tx.%{rule.id}-WEB_ATTACK/COMMAND_INJECTION-%{matched_var_name}=%
{tx.0}""
</pre>

<p>Note that is is also possible to use regular expressions in the target specification:
</p>
<pre>SecRuleUpdateTargetById 981172 "!REQUEST_COOKIES:/^appl1_.*/"
</pre>



<p><b>Explicitly Replacing Targets</b>
</p>
<p>You can also entirely replace the target list to something more appropriate for your environment.  For example, lets say you want to inspect REQUEST_URI instead of REQUEST_FILENAME, you could do this:
</p><pre>SecRule REQUEST_FILENAME|ARGS_NAMES|ARGS|XML:/* "[\;\|\`]\W*?\bmail\b" \
     "phase:2,rev:'2.1.1',capture,t:none,t:htmlEntityDecode,t:compressWhitespace,t:lowercase,ctl:auditLogParts=+E,block,msg:'System Command Injection',id:'958895',tag:'WEB_ATTACK/COMMAND_INJECTION',tag:'WASCTC/WASC-31',tag:'OWASP_TOP_10/A1',tag:'PCI/6.5.2',logdata:'%{TX.0}',severity:'2',setvar:'tx.msg=%{rule.msg}',setvar:tx.anomaly_score=+%{tx.critical_anomaly_score},setvar:tx.command_injection_score=+%{tx.critical_anomaly_score},setvar:tx.%{rule.id}-WEB_ATTACK/COMMAND_INJECTION-%{matched_var_name}=%
{tx.0}"

SecRuleUpdateTargetById 958895 REQUEST_URI REQUEST_FILENAME
</pre>
<p>The effective resulting rule in the previous example replaces the target in the begin of the variable list as follows:
</p><pre>SecRule REQUEST_URI|ARGS_NAMES|ARGS|XML:/* "[\;\|\`]\W*?\bmail\b" \
     "phase:2,rev:'2.1.1',capture,t:none,t:htmlEntityDecode,t:compressWhitespace,t:lowercase,ctl:auditLogParts=+E,block,msg:'System Command Injection',id:'958895',tag:'WEB_ATTACK/COMMAND_INJECTION',tag:'WASCTC/WASC-31',tag:'OWASP_TOP_10/A1',tag:'PCI/6.5.2',logdata:'%{TX.0}',severity:'2',setvar:'tx.msg=%{rule.msg}',setvar:tx.anomaly_score=+%{tx.critical_anomaly_score},setvar:tx.command_injection_score=+%{tx.critical_anomaly_score},setvar:tx.%{rule.id}-WEB_ATTACK/COMMAND_INJECTION-%{matched_var_name}=%
{tx.0}""
</pre>


<dl><dt>Note : You could also do the same by using the ctl action with the ruleRemoveById directive. That would be useful if you want to only update the targets for a particular URL, thus conditionally appending targets.</dt></dl>


<h2>
<a id="user-content-secruleupdatetargetbymsg" class="anchor" href="#secruleupdatetargetbymsg" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-SecRuleUpdateTargetByMsg"></a><span>SecRuleUpdateTargetByMsg</span>
</h2>


<p><b>Description:</b> Updates the target (variable) list of the specified rule by rule message.
</p>
<p><b>Syntax:</b> <code>SecRuleUpdateTargetByMsg TEXT TARGET1[,TARGET2,TARGET3] REPLACED_TARGET</code>
</p>
<p><b>Example Usage:</b> <code>SecRuleUpdateTargetByMsg "Cross-site Scripting (XSS) Attack" "!ARGS:foo"</code>
</p>
<p><b>Scope:</b> Any
</p>
<p><b>Version:</b> 2.7-2.9.x
</p>
<p><b>Supported on libModSecurity:</b> TBI
</p>
<p>This directive will append (or replace) variables to the current target list of the specified rule with the targets provided in the second parameter.
</p>
<p><b>Explicitly Appending Targets</b>
</p>
<p>This is useful for implementing exceptions where you want to externally update a target list to exclude inspection of specific variable(s).
</p><pre>SecRule REQUEST_FILENAME|ARGS_NAMES|ARGS|XML:/* "[\;\|\`]\W*?\bmail\b" \
     "phase:2,rev:'2.1.1',capture,t:none,t:htmlEntityDecode,t:compressWhitespace,t:lowercase,ctl:auditLogParts=+E,block,msg:'System Command Injection',id:'958895',tag:'WEB_ATTACK/COMMAND_INJECTION',tag:'WASCTC/WASC-31',tag:'OWASP_TOP_10/A1',tag:'PCI/6.5.2',logdata:'%{TX.0}',severity:'2',setvar:'tx.msg=%{rule.msg}',setvar:tx.anomaly_score=+%{tx.critical_anomaly_score},setvar:tx.command_injection_score=+%{tx.critical_anomaly_score},setvar:tx.%{rule.id}-WEB_ATTACK/COMMAND_INJECTION-%{matched_var_name}=%
{tx.0}"

SecRuleUpdateTargetByMsg "System Command Injection" !ARGS:email
</pre>
<p>The effective resulting rule in the previous example will append the target to the end of the variable list as follows:
</p><pre>SecRule REQUEST_FILENAME|ARGS_NAMES|ARGS|XML:/*|!ARGS:email "[\;\|\`]\W*?\bmail\b" \
     "phase:2,rev:'2.1.1',capture,t:none,t:htmlEntityDecode,t:compressWhitespace,t:lowercase,ctl:auditLogParts=+E,block,msg:'System Command Injection',id:'958895',tag:'WEB_ATTACK/COMMAND_INJECTION',tag:'WASCTC/WASC-31',tag:'OWASP_TOP_10/A1',tag:'PCI/6.5.2',logdata:'%{TX.0}',severity:'2',setvar:'tx.msg=%{rule.msg}',setvar:tx.anomaly_score=+%{tx.critical_anomaly_score},setvar:tx.command_injection_score=+%{tx.critical_anomaly_score},setvar:tx.%{rule.id}-WEB_ATTACK/COMMAND_INJECTION-%{matched_var_name}=%
{tx.0}""
</pre>
<b>Explicitly Replacing Targets</b>

<p>You can also entirely replace the target list to something more appropriate for your environment.  For example, lets say you want to inspect REQUEST_URI instead of REQUEST_FILENAME, you could do this:
</p><pre>SecRule REQUEST_FILENAME|ARGS_NAMES|ARGS|XML:/* "[\;\|\`]\W*?\bmail\b" \
     "phase:2,rev:'2.1.1',capture,t:none,t:htmlEntityDecode,t:compressWhitespace,t:lowercase,ctl:auditLogParts=+E,block,msg:'System Command Injection',id:'958895',tag:'WEB_ATTACK/COMMAND_INJECTION',tag:'WASCTC/WASC-31',tag:'OWASP_TOP_10/A1',tag:'PCI/6.5.2',logdata:'%{TX.0}',severity:'2',setvar:'tx.msg=%{rule.msg}',setvar:tx.anomaly_score=+%{tx.critical_anomaly_score},setvar:tx.command_injection_score=+%{tx.critical_anomaly_score},setvar:tx.%{rule.id}-WEB_ATTACK/COMMAND_INJECTION-%{matched_var_name}=%
{tx.0}"

SecRuleUpdateTargetByMsg "System Command Injection" REQUEST_URI REQUEST_FILENAME
</pre>
<p>The effective resulting rule in the previous example will append the target to the end of the variable list as follows:
</p><pre>SecRule REQUEST_URI|ARGS_NAMES|ARGS|XML:/* "[\;\|\`]\W*?\bmail\b" \
     "phase:2,rev:'2.1.1',capture,t:none,t:htmlEntityDecode,t:compressWhitespace,t:lowercase,ctl:auditLogParts=+E,block,msg:'System Command Injection',id:'958895',tag:'WEB_ATTACK/COMMAND_INJECTION',tag:'WASCTC/WASC-31',tag:'OWASP_TOP_10/A1',tag:'PCI/6.5.2',logdata:'%{TX.0}',severity:'2',setvar:'tx.msg=%{rule.msg}',setvar:tx.anomaly_score=+%{tx.critical_anomaly_score},setvar:tx.command_injection_score=+%{tx.critical_anomaly_score},setvar:tx.%{rule.id}-WEB_ATTACK/COMMAND_INJECTION-%{matched_var_name}=%
{tx.0}""
</pre>


<h2>
<a id="user-content-secruleupdatetargetbytag" class="anchor" href="#secruleupdatetargetbytag" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-SecRuleUpdateTargetByTag"></a><span>SecRuleUpdateTargetByTag</span>
</h2>


<p><b>Description:</b> Updates the target (variable) list of the specified rule by rule tag.
</p>
<p><b>Syntax:</b> <code>SecRuleUpdateTargetByTag TEXT TARGET1[,TARGET2,TARGET3] REPLACED_TARGET</code>
</p>
<p><b>Example Usage:</b> <code>SecRuleUpdateTargetByTag "WEB_ATTACK/XSS" "!ARGS:foo"</code>
</p>
<p><b>Scope:</b> Any
</p>
<p><b>Version:</b> 2.7-3.0(pre)
</p>
<p><b>Supported on libModSecurity:</b> Yes
</p>
<p>This directive will append (or replace) variables to the current target list of the specified rule with the targets provided in the second parameter.
</p>
<p><b>Explicitly Appending Targets</b>
</p>
<p>This is useful for implementing exceptions where you want to externally update a target list to exclude inspection of specific variable(s).
</p><pre>SecRule REQUEST_FILENAME|ARGS_NAMES|ARGS|XML:/* "[\;\|\`]\W*?\bmail\b" \
     "phase:2,rev:'2.1.1',capture,t:none,t:htmlEntityDecode,t:compressWhitespace,t:lowercase,ctl:auditLogParts=+E,block,msg:'System Command Injection',id:'958895',tag:'WEB_ATTACK/COMMAND_INJECTION',tag:'WASCTC/WASC-31',tag:'OWASP_TOP_10/A1',tag:'PCI/6.5.2',logdata:'%{TX.0}',severity:'2',setvar:'tx.msg=%{rule.msg}',setvar:tx.anomaly_score=+%{tx.critical_anomaly_score},setvar:tx.command_injection_score=+%{tx.critical_anomaly_score},setvar:tx.%{rule.id}-WEB_ATTACK/COMMAND_INJECTION-%{matched_var_name}=%
{tx.0}"

SecRuleUpdateTargetByTag "WASCTC/WASC-31" !ARGS:email
</pre>
<p>The effective resulting rule in the previous example will append the target to the end of the variable list as follows:
</p><pre>SecRule REQUEST_FILENAME|ARGS_NAMES|ARGS|XML:/*|!ARGS:email "[\;\|\`]\W*?\bmail\b" \
     "phase:2,rev:'2.1.1',capture,t:none,t:htmlEntityDecode,t:compressWhitespace,t:lowercase,ctl:auditLogParts=+E,block,msg:'System Command Injection',id:'958895',tag:'WEB_ATTACK/COMMAND_INJECTION',tag:'WASCTC/WASC-31',tag:'OWASP_TOP_10/A1',tag:'PCI/6.5.2',logdata:'%{TX.0}',severity:'2',setvar:'tx.msg=%{rule.msg}',setvar:tx.anomaly_score=+%{tx.critical_anomaly_score},setvar:tx.command_injection_score=+%{tx.critical_anomaly_score},setvar:tx.%{rule.id}-WEB_ATTACK/COMMAND_INJECTION-%{matched_var_name}=%
{tx.0}""
</pre>
<b>Explicitly Replacing Targets</b>

<p>You can also entirely replace the target list to something more appropriate for your environment.  For example, lets say you want to inspect REQUEST_URI instead of REQUEST_FILENAME, you could do this:
</p><pre>SecRule REQUEST_FILENAME|ARGS_NAMES|ARGS|XML:/* "[\;\|\`]\W*?\bmail\b" \
     "phase:2,rev:'2.1.1',capture,t:none,t:htmlEntityDecode,t:compressWhitespace,t:lowercase,ctl:auditLogParts=+E,block,msg:'System Command Injection',id:'958895',tag:'WEB_ATTACK/COMMAND_INJECTION',tag:'WASCTC/WASC-31',tag:'OWASP_TOP_10/A1',tag:'PCI/6.5.2',logdata:'%{TX.0}',severity:'2',setvar:'tx.msg=%{rule.msg}',setvar:tx.anomaly_score=+%{tx.critical_anomaly_score},setvar:tx.command_injection_score=+%{tx.critical_anomaly_score},setvar:tx.%{rule.id}-WEB_ATTACK/COMMAND_INJECTION-%{matched_var_name}=%
{tx.0}"

SecRuleUpdateTargetByTag "WASCTC/WASC-31" REQUEST_URI REQUEST_FILENAME
</pre>
<p>The effective resulting rule in the previous example will append the target to the end of the variable list as follows:
</p><pre>SecRule REQUEST_URI|ARGS_NAMES|ARGS|XML:/* "[\;\|\`]\W*?\bmail\b" \
     "phase:2,rev:'2.1.1',capture,t:none,t:htmlEntityDecode,t:compressWhitespace,t:lowercase,ctl:auditLogParts=+E,block,msg:'System Command Injection',id:'958895',tag:'WEB_ATTACK/COMMAND_INJECTION',tag:'WASCTC/WASC-31',tag:'OWASP_TOP_10/A1',tag:'PCI/6.5.2',logdata:'%{TX.0}',severity:'2',setvar:'tx.msg=%{rule.msg}',setvar:tx.anomaly_score=+%{tx.critical_anomaly_score},setvar:tx.command_injection_score=+%{tx.critical_anomaly_score},setvar:tx.%{rule.id}-WEB_ATTACK/COMMAND_INJECTION-%{matched_var_name}=%
{tx.0}""
</pre>


<h2>
<a id="user-content-secserversignature" class="anchor" href="#secserversignature" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-SecServerSignature"></a><span>SecServerSignature</span>
</h2>


<p><b>Description:</b> Instructs ModSecurity to change the data presented in the "Server:" response header token.
</p>
<p><b>Syntax:</b> <code>SecServerSignature "WEB SERVER SOFTWARE"</code>
</p>
<p><b>Example Usage:</b> <code>SecServerSignature "Microsoft-IIS/6.0"</code>
</p>
<p><b>Scope:</b> Main
</p>
<p><b>Version:</b> 2.0.0-2.9.x
</p>
<p><b>Supported on libModSecurity:</b> TBI
</p>
<p>In order for this directive to work, you must set the Apache ServerTokens directive to Full. ModSecurity will overwrite the server signature data held in this memory space with the data set in this directive. If ServerTokens is not set to Full, then the memory space is most likely not large enough to hold the new data we are looking to insert.
</p>

<dl><dt>Note : This directive is not allowed inside VirtualHosts. If enabled, it must be placed in a global server-wide configuration file such as your default modsecurity.conf.</dt></dl>


<h2>
<a id="user-content-secstatusengine" class="anchor" href="#secstatusengine" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-SecStatusEngine"></a><span>SecStatusEngine</span>
</h2>


<p><b>Description:</b> Controls Status Reporting functionality.  Uses DNS-based reporting to send software version information to the ModSecurity Project team.
</p>
<p><b>Syntax:</b> <code>SecStatusEngine On|Off</code>
</p>
<p><b>Example Usage:</b> <code>SecStatusEngine On</code>
</p>
<p><b>Scope:</b> Any
</p>
<p><b>Version:</b> 2.8.0-2.9.x
</p>
<p><b>Supported on libModSecurity:</b> Yes
</p>
<p><b>Default:</b> Off
</p>
<p>If SecStatusEngine directive is not present, it is disabled.  If SecStatusEngine is marked as On, the following information will be shared with the ModSecurity project team when the web server is started:
</p>








<ul>
<li>Anonymous unique id for the server</li>
<li>Version of:<ul>
<li>ModSecurity</li>
<li>Web Server Software (Apache, IIS, Nginx, Java)</li>
<li>APR</li>
<li>Libxml2</li>
<li>Lua</li>
<li>PCRE</li>
</ul>
</li>
</ul>


<dl><dt>Note : This is an example of the information presented in the Apache error_log representing what data will be sent:</dt></dl>
<pre>[Mon Jan 20 10:55:22.001020 2014] [:notice] [pid 18231:tid 140735189168512] ModSecurity: StatusEngine call: "2.7.7,Apache/2.4.4 (Unix),1.4.6/1.4.6, 8.32 /8.32 2012-11-30,Lua 5.1/(null),2.7.8/(null),96ce9ba3c2fb71f7a8bb92a88d560d44dbe459b8"
[Mon Jan 20 10:55:22.089012 2014] [:notice] [pid 18231:tid 140735189168512] ModSecurity: StatusEngine call successfully submitted.
</pre>


<h2>
<a id="user-content-secstreaminbodyinspection" class="anchor" href="#secstreaminbodyinspection" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-SecStreamInBodyInspection"></a><span>SecStreamInBodyInspection</span>
</h2>


<p><b>Description:</b> Configures the ability to use stream inspection for inbound request data in a re-allocable buffer. For security reasons we are still buffering the stream. 
</p>
<p><b>Syntax:</b> <code>SecStreamInBodyInspection On|Off</code>
</p>
<p><b>Example Usage:</b> <code>SecStreamInBodyInspection On</code>
</p>
<p><b>Scope:</b> Any
</p>
<p><b>Version:</b> 2.6.0-2.9.x
</p>
<p><b>Default:</b> Off
</p>
<p><b>Supported on libModSecurity:</b> No
</p>
<p>This feature enables the creation of the STREAM_INPUT_BODY variable and is useful for data modification or to match data in raw data for any content-types.
</p>

<dl><dt>Note : This directive provides full access to REQUEST_BODY payload data.  It does not include REQUEST_URI or REQUEST_HEADER data. Also it provides data to all kind of content types, different than REQUEST_BODY.</dt></dl>


<dl><dt>Note : This directive is NOT supported for libModSecurity (v3). Naturally, STREAM_INPUT_BODY is also NOT supported on libModSecurity.</dt></dl>


<dl><dt>Note : This directive may significantly impact file upload times. The impact depends on server resources and the nature of operations being performed on the request bodies being streamed in.</dt></dl>


<h2>
<a id="user-content-secstreamoutbodyinspection" class="anchor" href="#secstreamoutbodyinspection" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-SecStreamOutBodyInspection"></a><span>SecStreamOutBodyInspection</span>
</h2>


<p><b>Description:</b> Configures the ability to use stream inspection for outbound request data in a re-allocable buffer.  For security reasons we are still buffering the stream.
</p>
<p><b>Syntax:</b> <code>SecStreamOutBodyInspection On|Off</code>
</p>
<p><b>Example Usage:</b> <code>SecStreamOutBodyInspection On</code>
</p>
<p><b>Scope:</b> Any
</p>
<p><b>Version:</b> 2.6.0-2.9.x
</p>
<p><b>Supported on libModSecurity:</b> TBD
</p>
<p><b>Default:</b> Off
</p>
<p>This feature enables the creation of the STREAM_OUTPUT_BODY variable and is useful when you need to do data modification into response body.
</p>

<dl><dt>Note : This directive provides access to RESPONSE_BODY payload data. It does not include RESPONSE_HEADER data.</dt></dl>


<h2>
<a id="user-content-sectmpdir" class="anchor" href="#sectmpdir" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-SecTmpDir"></a><span>SecTmpDir</span>
</h2>


<p><b>Description:</b> Configures the directory where temporary files will be created.
</p>
<p><b>Syntax:</b> <code>SecTmpDir /path/to/dir</code>
</p>
<p><b>Example Usage:</b> <code>SecTmpDir /tmp</code>
</p>
<p><b>Scope:</b> Any
</p>
<p><b>Version:</b> 2.0.0-2.9.x
</p>
<p><b>Supported on libModSecurity:</b> TBI
</p>
<p>The location specified needs to be writable by the Apache user process. This is the directory location where ModSecurity will swap data to disk if it runs out of memory (more data than what was specified in the SecRequestBodyInMemoryLimit directive) during inspection.
</p>

<h2>
<a id="user-content-secunicodemapfile" class="anchor" href="#secunicodemapfile" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-SecUnicodeMapFile"></a><span>SecUnicodeMapFile</span>
</h2>


<p><b>Description:</b> Defines the path to the file that will be used by the urlDecodeUni transformation function to map Unicode code points during normalization and specifies the Code Point to use.
</p>
<p><b>Syntax:</b> <code>SecUnicodeMapFile /path/to/unicode.mapping CODEPOINT</code>
</p>
<p><b>Example Usage:</b> <code>SecUnicodeMapFile unicode.mapping 20127</code>
</p>
<p><b>Scope:</b> Any
</p>
<p><b>Version:</b> 2.6.1-2.9.x
</p>
<p><b>Supported on libModSecurity:</b> TBI
</p>

<h2>
<a id="user-content-secunicodecodepage" class="anchor" href="#secunicodecodepage" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-SecUnicodeCodePage"></a><span>SecUnicodeCodePage</span>
</h2>


<p><b>Description:</b> Defines which Unicode code point will be used by the urlDecodeUni transformation function during normalization.
</p>
<p><b>Syntax:</b> <code>SecUnicodeCodePage XXXXX</code>
</p>
<p><b>Example Usage:</b> <code>SecUnicodeCodePage 20127</code>
</p>
<p><b>Scope:</b> Any
</p>
<p><b>Version:</b> 2.6.1 - DEPRECATED
</p>
<p><b>Supported on libModSecurity:</b> No (Deprecated)
</p>

<h2>
<a id="user-content-secuploaddir" class="anchor" href="#secuploaddir" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-SecUploadDir"></a><span>SecUploadDir</span>
</h2>


<p><b>Description:</b> Configures the directory where intercepted files will be stored.
</p>
<p><b>Syntax:</b> <code>SecUploadDir /path/to/dir</code>
</p>
<p><b>Example Usage:</b> <code>SecUploadDir /tmp</code>
</p>
<p><b>Scope:</b> Any
</p>
<p><b>Version:</b> 2.0.0
</p>
<p><b>Supported on libModSecurity:</b> Yes
</p>
<p>This directory must be on the same filesystem as the temporary directory defined with SecTmpDir. This directive is used with SecUploadKeepFiles.
</p>

<h2>
<a id="user-content-secuploadfilelimit" class="anchor" href="#secuploadfilelimit" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-SecUploadFileLimit"></a><span>SecUploadFileLimit</span>
</h2>


<p><b>Description:</b> Configures the maximum number of file uploads processed in a multipart POST.
</p>
<p><b>Syntax:</b> <code>SecUploadFileLimit number</code>
</p>
<p><b>Example Usage:</b> <code>SecUploadFileLimit 10</code>
</p>
<p><b>Scope:</b> Any
</p>
<p><b>Version:</b> 2.5.12
</p>
<p><b>Supported on libModSecurity:</b> Yes
</p>
<p>The default is set to 100 files, but you are encouraged to reduce this value. Any file over the limit will not be extracted and the MULTIPART_FILE_LIMIT_EXCEEDED and MULTIPART_STRICT_ERROR flags will be set. To prevent bypassing any file checks, you must check for one of these flags.
</p>

<dl><dt>Note : If the limit is exceeded, the part name and file name will still be recorded in FILES_NAME and FILES, the file size will be recorded in FILES_SIZES, but there will be no record in FILES_TMPNAMES as a temporary file was not created.</dt></dl>


<h2>
<a id="user-content-secuploadfilemode" class="anchor" href="#secuploadfilemode" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-SecUploadFileMode"></a><span>SecUploadFileMode</span>
</h2>


<p><b>Description:</b> Configures the mode (permissions) of any uploaded files using an octal mode (as used in chmod).
</p>
<p><b>Syntax:</b> <code>SecUploadFileMode octal_mode|"default"</code>
</p>
<p><b>Example Usage:</b> <code>SecUploadFileMode 0640</code>
</p>
<p><b>Scope:</b> Any
</p>
<p><b>Version:</b> 2.1.6
</p>
<p><b>Supported on libModSecurity:</b> Yes
</p>
<p>This feature is not available on operating systems not supporting octal file modes. The default mode (0600) only grants read/write access to the account writing the file. If access from another account is needed (using clamd is a good example), then this directive may be required. However, use this directive with caution to avoid exposing potentially sensitive data to unauthorized users. Using the value "default" will revert back to the default setting.
</p>

<dl><dt>Note : The process umask may still limit the mode if it is being more restrictive than the mode set using this directive.</dt></dl>


<h2>
<a id="user-content-secuploadkeepfiles" class="anchor" href="#secuploadkeepfiles" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-SecUploadKeepFiles"></a><span>SecUploadKeepFiles</span>
</h2>


<p><b>Description:</b> Configures whether or not the intercepted files will be kept after transaction is processed.
</p>
<p><b>Syntax:</b> <code>SecUploadKeepFiles On|Off|RelevantOnly</code>
</p>
<p><b>Example Usage:</b> <code>SecUploadKeepFiles On</code>
</p>
<p><b>Scope:</b> Any
</p>
<p><b>Version:</b> 2.0.0
</p>
<p><b>Supported on libModSecurity:</b> Yes
</p>
<p>This directive requires the storage directory to be defined (using SecUploadDir).
</p>
<p>Possible values are:
</p>



<ul>
<li>
<b>On</b> - Keep uploaded files.</li>
<li>
<b>Off</b> - Do not keep uploaded files.</li>
<li>
<b>RelevantOnly</b> - This will keep only those files that belong to requests that are deemed relevant.</li>
</ul>


<h2>
<a id="user-content-secwebappid" class="anchor" href="#secwebappid" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-SecWebAppId"></a><span>SecWebAppId</span>
</h2>


<p><b>Description:</b> Creates an application namespace, allowing for separate persistent session and user storage.
</p>
<p><b>Syntax:</b> <code>SecWebAppId "NAME" </code>
</p>
<p><b>Example Usage:</b> <code>SecWebAppId "WebApp1" </code>
</p>
<p><b>Scope:</b> Any 
</p>
<p><b>Version:</b> 2.0.0-2.9.x
</p>
<p><b>Supported on libModSecurity:</b> TBI
</p>
<p><b>Default:</b> default
</p>
<p>Application namespaces are used to avoid collisions between session IDs and user IDs when multiple applications are deployed on the same server. If it isn’t used, a collision between session IDs might occur.
</p><pre>&lt;VirtualHost *:80&gt; 
ServerName app1.example.com 
SecWebAppId "App1" ...
&lt;/virtualhost&gt;

&lt;VirtualHost *:80&gt; 
ServerName app2.example.com 
SecWebAppId "App2" ...
&lt;/virtualhost&gt;
</pre>
<p>In the two examples configurations shown, SecWebAppId is being used in conjunction with the Apache VirtualHost directives. Applications namespace information is also recorded in the audit logs (using the WebApp-Info header of the H part).
</p>

<h2>
<a id="user-content-secxmlexternalentity" class="anchor" href="#secxmlexternalentity" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-SecXmlExternalEntity"></a><span>SecXmlExternalEntity</span>
</h2>


<p><b>Description:</b> Enable or Disable the loading process of xml external entity. Loading external entity without correct verifying process can lead to a security issue.
</p>
<p><b>Syntax:</b> <code>SecXmlExternalEntity On|Off </code>
</p>
<p><b>Example Usage:</b> <code>SecXmlExternalEntity Off </code>
</p>
<p><b>Scope:</b> Any 
</p>
<p><b>Version:</b> 2.7.3
</p>
<p><b>Supported on libModSecurity:</b> Yes
</p>
<p><b>Default:</b> default is Off
</p>
<p><b>NOTE:</b> You must enable this directive if you need to use the <code>@validateSchema</code> or <code>@validateDtd</code> operators.
</p>

<h1>
<a id="user-content-processing-phases" class="anchor" href="#processing-phases" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-Processing_Phases"></a><span>Processing Phases</span>
</h1>


<p>ModSecurity 2.x allows rules to be placed in one of the following five phases of the Apache request cycle:





</p><ul>
<li>Request headers (REQUEST_HEADERS)</li>
<li>Request body (REQUEST_BODY)</li>
<li>Response headers (RESPONSE_HEADERS)</li>
<li>Response body (RESPONSE_BODY)</li>
<li>Logging (LOGGING)</li>
</ul>

<p>Below is a diagram of the standard Apache Request Cycle. In the diagram, the 5 ModSecurity processing phases are shown.
</p>
<p><img src="https://camo.githubusercontent.com/8c6d225b0c7fbb4a8a6ac1a98ead9a1d57d22fbf/687474703a2f2f7777772e6d6f6473656375726974792e6f72672f67726170686963732f6d6f647365632d726f746174696f6e2e6a7067" data-canonical-src="http://www.modsecurity.org/graphics/modsec-rotation.jpg">
</p>

<p>In order to select the phase a rule executes during, use the phase action either directly in the rule or in using the SecDefaultAction directive:
</p><pre>SecDefaultAction "log,pass,phase:2,id:4"
SecRule REQUEST_HEADERS:Host "!^$" "deny,phase:1,id:5"
</pre>


<dl>
<dt>Note : The data available in each phase is cumulative.  This means that as you move onto later phases, you have access to more and more data from the transaction.</dt>
<dt>Note : Keep in mind that rules are executed according to phases, so even if two rules are adjacent in a configuration file, but are set to execute in different phases, they would not happen one after the other. The order of rules in the configuration file is important only within the rules of each phase. This is especially important when using the skip and skipAfter actions.</dt>
</dl>



<dl><dt>Note : The LOGGING phase is special. It is executed at the end of each transaction no matter what happened in the previous phases. This means it will be processed even if the request was intercepted or the allow action was used to pass the transaction through.</dt></dl>
<h2>
<a id="user-content-phase-request-headers" class="anchor" href="#phase-request-headers" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-Phase_Request_Headers"></a><span>Phase Request Headers</span>
</h2>


<p>Rules in this phase are processed immediately after Apache completes reading the request headers (post-read-request phase). At this point the request body has not been read yet, meaning not all request arguments are available. Rules should be placed in this phase if you need to have them run early (before Apache does something with the request), to do something before the request body has been read, determine whether or not the request body should be buffered, or decide how you want the request body to be processed (e.g. whether to parse it as XML or not).
</p>

<dl><dt>Note : Rules in this phase can not leverage Apache scope directives (Directory, Location, LocationMatch, etc...) as the post-read-request hook does not have this information yet. The exception here is the VirtualHost directive. If you want to use ModSecurity rules inside Apache locations, then they should run in Phase 2. Refer to the Apache Request Cycle/ModSecurity Processing Phases diagram.</dt></dl>


<h2>
<a id="user-content-phase-request-body" class="anchor" href="#phase-request-body" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-Phase_Request_Body"></a><span>Phase Request Body</span>
</h2>


<p>This is the general-purpose input analysis phase. Most of the application-oriented rules should go here. In this phase you are guaranteed to have received the request arguments (provided the request body has been read). ModSecurity supports three encoding types for the request body phase:



</p><ul>
<li>
<b>application/x-www-form-urlencoded</b> - used to transfer form data</li>
<li>
<b>multipart/form-data</b> - used for file transfers</li>
<li>
<b>text/xml</b> - used for passing XML data</li>
</ul>

<p>Other encodings are not used by most web applications.
</p>

<dl><dt>Note : In order to access the Request Body phase data, you must have SecRequestBodyAccess set to On.</dt></dl>


<h2>
<a id="user-content-phase-response-headers" class="anchor" href="#phase-response-headers" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-Phase_Response_Headers"></a><span>Phase Response Headers</span>
</h2>


<p>This phase takes place just before response headers are sent back to the client. Run here if you want to observe the response before that happens, and if you want to use the response headers to determine if you want to buffer the response body. Note that some response status codes (such as 404) are handled earlier in the request cycle by Apache and my not be able to be triggered as expected. Additionally, there are some response headers that are added by Apache at a later hook (such as Date, Server and Connection) that we would not be able to trigger on or sanitize. This should work appropriately in a proxy setup or within phase:5 (logging).
</p>

<h2>
<a id="user-content-phase-response-body" class="anchor" href="#phase-response-body" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-Phase_Response_Body"></a><span>Phase Response Body</span>
</h2>


<p>This is the general-purpose output analysis phase. At this point you can run rules against the response body (provided it was buffered, of course). This is the phase where you would want to inspect the outbound HTML for information disclosure, error messages or failed authentication text.
</p>

<dl><dt>Note : In order to access the Response Body phase data, you must have SecResponseBodyAccess set to On</dt></dl>


<h2>
<a id="user-content-phase-logging" class="anchor" href="#phase-logging" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-Phase_Logging"></a><span>Phase Logging</span>
</h2>


<p>This phase is run just before logging takes place. The rules placed into this phase can only affect how the logging is performed. This phase can be used to inspect the error messages logged by Apache. You cannot deny/block connections in this phase as it is too late. This phase also allows for inspection of other response headers that weren't available during phase:3 or phase:4. Note that you must be careful not to inherit a disruptive action into a rule in this phase as this is a configuration error in ModSecurity 2.5.0 and later versions
</p>

<h1>
<a id="user-content-variables" class="anchor" href="#variables" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-Variables"></a><span>Variables</span>
</h1>


<p>The following variables are supported in ModSecurity 2.x:
</p>

<h2>
<a id="user-content-args" class="anchor" href="#args" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-ARGS"></a><span>ARGS</span>
</h2>


<p>ARGS is a collection and can be used on its own (means all arguments including the POST Payload), with a static parameter (matches arguments with that name), or with a regular expression (matches all arguments with name that matches the regular expression). To look at only the query string or body arguments, see the ARGS_GET and ARGS_POST collections.
</p>
<p>Some variables are actually collections, which are expanded into more variables at runtime. The following example will examine all request arguments:
</p>
<p><code>SecRule ARGS dirty "id:7"</code>
</p>
<p>Sometimes, however, you will want to look only at parts of a collection. This can be achieved with the help of the selection operator(colon). The following example will only look at the arguments named p (do note that, in general, requests can contain multiple arguments with the same name):
</p>
<p><code>SecRule ARGS:p dirty "id:8"</code>
</p>
<p>It is also possible to specify exclusions. The following will examine all request arguments for the word dirty, except the ones named z (again, there can be zero or more arguments named z):
</p>
<p><code>SecRule ARGS|!ARGS:z dirty "id:9"</code>
</p>
<p>There is a special operator that allows you to count how many variables there are in a collection. The following rule will trigger if there is more than zero arguments in the request (ignore the second parameter for the time being):
</p>
<p><code>SecRule &amp;ARGS !^0$ "id:10"</code>
</p>
<p>And sometimes you need to look at an array of parameters, each with a slightly different name. In this case you can specify a regular expression in the selection operator itself. The following rule will look into all arguments whose names begin with id_:
</p>
<p><code>SecRule ARGS:/^id_/ dirty "id:11"</code>
</p>

<dl><dt>Note : Using ARGS:p will not result in any invocations against the operator if argument p does not exist.</dt></dl>

<p>In ModSecurity 1.X, the ARGS variable stood for QUERY_STRING + POST_PAYLOAD, whereas now it expands to individual variables.
</p>

<h2>
<a id="user-content-args_combined_size" class="anchor" href="#args_combined_size" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-ARGS_COMBINED_SIZE"></a><span>ARGS_COMBINED_SIZE</span>
</h2>


<p>Contains the combined size of all request parameters. Files are excluded from the calculation. This variable can be useful, for example, to create a rule to ensure that the total size of the argument data is below a certain threshold. The following rule detects a request whose para- meters are more than 2500 bytes long:
</p>
<p><code>SecRule ARGS_COMBINED_SIZE "@gt 2500" "id:12"</code>
</p>

<h2>
<a id="user-content-args_get" class="anchor" href="#args_get" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-ARGS_GET"></a><span>ARGS_GET</span>
</h2>


<p>ARGS_GET is similar to ARGS, but contains only query string parameters.
</p>

<h2>
<a id="user-content-args_get_names" class="anchor" href="#args_get_names" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-ARGS_GET_NAMES"></a><span>ARGS_GET_NAMES</span>
</h2>


<p>ARGS_GET_NAMES is similar to ARGS_NAMES, but contains only the names of query string parameters.
</p>

<h2>
<a id="user-content-args_names" class="anchor" href="#args_names" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-ARGS_NAMES"></a><span>ARGS_NAMES</span>
</h2>


<p>Contains all request parameter names. You can search for specific parameter names that you want to inspect. In a positive policy scenario, you can also whitelist (using an inverted rule with the exclamation mark) only the authorized argument names.
This example rule allows only two argument names: p and a: 
</p>
<p><code>SecRule ARGS_NAMES "!^(p|a)$" "id:13"</code>
</p>

<h2>
<a id="user-content-args_post" class="anchor" href="#args_post" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-ARGS_POST"></a><span>ARGS_POST</span>
</h2>


<p>ARGS_POST is similar to ARGS, but only contains arguments from the POST body.
</p>

<h2>
<a id="user-content-args_post_names" class="anchor" href="#args_post_names" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-ARGS_POST_NAMES"></a><span>ARGS_POST_NAMES</span>
</h2>


<p>ARGS_POST_NAMES is similar to ARGS_NAMES, but contains only the names of request body parameters.
</p>

<h2>
<a id="user-content-auth_type" class="anchor" href="#auth_type" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-AUTH_TYPE"></a><span>AUTH_TYPE</span>
</h2>


<p>This variable holds the authentication method used to validate a user, if any of the methods built into HTTP are used. In a reverse-proxy deployment, this information will not be available if the authentication is handled in the backend web server.
</p>
<p><code>SecRule AUTH_TYPE "Basic" "id:14"</code>
</p>

<h2>
<a id="user-content-duration" class="anchor" href="#duration" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-DURATION"></a><span>DURATION</span>
</h2>


<p>Contains the number of milliseconds elapsed since the beginning of the current transaction. Available starting with 2.6.0.
</p>

<dl><dt>Note : Starting with ModSecurity 2.7.0 the time is microseconds.</dt></dl>


<h2>
<a id="user-content-env" class="anchor" href="#env" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-ENV"></a><span>ENV</span>
</h2>


<p>Collection that provides access to environment variables set by ModSecurity or other server modules. Requires a single parameter to specify the name of the desired variable.
</p><pre># Set environment variable 
SecRule REQUEST_FILENAME "printenv" \
"phase:2,id:15,pass,setenv:tag=suspicious" 

# Inspect environment variable
SecRule ENV:tag "suspicious" "id:16"

# Reading an environment variable from other Apache module (mod_ssl)
SecRule TX:ANOMALY_SCORE "@gt 0" "phase:5,id:16,msg:'%{env.ssl_cipher}'"
</pre>


<dl><dt>Note : Use setenv to set environment variables to be accessed by Apache.</dt></dl>


<h2>
<a id="user-content-files" class="anchor" href="#files" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-FILES"></a><span>FILES</span>
</h2>


<p>Contains a collection of original file names (as they were called on the remote user’s filesys- tem). Available only on inspected multipart/form-data requests.
</p>
<p><code>SecRule FILES "@rx \.conf$" "id:17"</code>
</p>

<dl><dt>Note : Only available if files were extracted from the request body.</dt></dl>


<h2>
<a id="user-content-files_combined_size" class="anchor" href="#files_combined_size" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-FILES_COMBINED_SIZE"></a><span>FILES_COMBINED_SIZE</span>
</h2>


<p>Contains the total size of the files transported in request body. Available only on inspected multipart/form-data requests.
</p>
<p><code>SecRule FILES_COMBINED_SIZE "@gt 100000" "id:18"</code>
</p>

<h2>
<a id="user-content-files_names" class="anchor" href="#files_names" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-FILES_NAMES"></a><span>FILES_NAMES</span>
</h2>


<p>Contains a list of form fields that were used for file upload. Available only on inspected multipart/form-data requests.
</p>
<p><code>SecRule FILES_NAMES "^upfile$" "id:19"</code>
</p>

<h2>
<a id="user-content-full_request" class="anchor" href="#full_request" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-FULL_REQUEST"></a><span>FULL_REQUEST</span>
</h2>


<p>Contains the complete request: Request line, Request headers and Request body (if any).
The last available only if SecRequestBodyAccess was set to On. Note that all properties of SecRequestBodyAccess will be respected here, such as: SecRequestBodyLimit. 
</p>
<p><code>SecRule FULL_REQUEST "User-Agent: ModSecurity Regression Tests" "id:21"</code>
</p>

<dl><dt>Note : Available on version 2.8.0+</dt></dl>


<h2>
<a id="user-content-full_request_length" class="anchor" href="#full_request_length" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-FULL_REQUEST_LENGTH"></a><span>FULL_REQUEST_LENGTH</span>
</h2>


<p>Represents the amount of bytes that FULL_REQUEST may use. 
</p>
<p><code>SecRule FULL_REQUEST_LENGTH "@eq 205" "id:21"</code>
</p>

<dl><dt>Note : Available on version 2.8.0+</dt></dl>


<h2>
<a id="user-content-files_sizes" class="anchor" href="#files_sizes" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-FILES_SIZES"></a><span>FILES_SIZES</span>
</h2>


<p>Contains a list of individual file sizes. Useful for implementing a size limitation on individual uploaded files. Available only on inspected multipart/form-data requests.
</p>
<p><code>SecRule FILES_SIZES "@gt 100" "id:20"</code>
</p>

<h2>
<a id="user-content-files_tmpnames" class="anchor" href="#files_tmpnames" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-FILES_TMPNAMES"></a><span>FILES_TMPNAMES</span>
</h2>


<p>Contains a list of temporary files’ names on the disk. Useful when used together with @inspectFile. Available only on inspected multipart/form-data requests.
</p>
<p><code>SecRule FILES_TMPNAMES "@inspectFile /path/to/inspect_script.pl" "id:21"</code>
</p>

<h2>
<a id="user-content-files_tmp_content" class="anchor" href="#files_tmp_content" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-FILES_TMP_CONTENT"></a><span>FILES_TMP_CONTENT</span>
</h2>


<p>Contains a key-value set where value is the content of the file which was uploaded.
Useful when used together with @fuzzyHash.
</p>
<p><code>SecRule FILES_TMP_CONTENT "@fuzzyHash $ENV{CONF_DIR}/ssdeep.txt 1" "id:192372,log,deny"</code>
</p>


<dl>
<dt>Note : Available on version 2.9.0-RC1+</dt>
<dt>Note II : SecUploadKeepFiles should be set to 'On' in order to have this collection filled.</dt>
</dl>


<h2>
<a id="user-content-geo" class="anchor" href="#geo" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-GEO"></a><span>GEO</span>
</h2>


<p>GEO is a collection populated by the results of the last @geoLookup operator. The collection can be used to match geographical fields looked from an IP address or hostname.
</p>
<p>Available since ModSecurity 2.5.0.
</p>
<p>Fields:











</p><ul>
<li>COUNTRY_CODE: Two character country code. EX: US, GB, etc.</li>
<li>COUNTRY_CODE3: Up to three character country code.</li>
<li>COUNTRY_NAME: The full country name.</li>
<li>COUNTRY_CONTINENT: The two character continent that the country is located. EX: EU</li>
<li>REGION: The two character region. For US, this is state. For Canada, providence, etc.</li>
<li>CITY: The city name if supported by the database.</li>
<li>POSTAL_CODE: The postal code if supported by the database.</li>
<li>LATITUDE: The latitude if supported by the database.</li>
<li>LONGITUDE: The longitude if supported by the database.</li>
<li>DMA_CODE: The metropolitan area code if supported by the database. (US only)</li>
<li>AREA_CODE: The phone system area code. (US only)</li>
</ul>

<p>Example:
</p><pre>SecGeoLookupDb /usr/local/geo/data/GeoLiteCity.dat
...
SecRule REMOTE_ADDR "@geoLookup" "chain,id:22,drop,msg:'Non-GB IP address'"
SecRule GEO:COUNTRY_CODE "!@streq GB"
</pre>

<h2>
<a id="user-content-highest_severity" class="anchor" href="#highest_severity" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-HIGHEST_SEVERITY"></a><span>HIGHEST_SEVERITY</span>
</h2>


<p>This variable holds the highest severity of any rules that have matched so far. Severities are numeric values and thus can be used with comparison operators such as @lt, and so on. A value of 255 indicates that no severity has been set.
</p>
<p><code>SecRule HIGHEST_SEVERITY "@le 2" "phase:2,id:23,deny,status:500,msg:'severity %{HIGHEST_SEVERITY}'"</code>

</p><dl><dt>Note : Higher severities have a lower numeric value.</dt></dl>


<h2>
<a id="user-content-inbound_data_error" class="anchor" href="#inbound_data_error" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-INBOUND_DATA_ERROR"></a><span>INBOUND_DATA_ERROR</span>
</h2>


<p>This variable will be set to 1 when the request body size is above the setting configured by SecRequestBodyLimit directive.  Your policies should always contain a rule to check this variable.  Depending on the rate of false positives and your default policy you should decide whether to block or just warn when the rule is triggered.
</p>
<p>The best way to use this variable is as in the example below:
</p>
<p><code>SecRule INBOUND_DATA_ERROR "@eq 1" "phase:1,id:24,t:none,log,pass,msg:'Request Body Larger than SecRequestBodyLimit Setting'"</code>
</p>

<h2>
<a id="user-content-matched_var" class="anchor" href="#matched_var" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-MATCHED_VAR"></a><span>MATCHED_VAR</span>
</h2>


<p>This variable holds the value of the most-recently matched variable. It is similar to the TX:0, but it is automatically supported by all operators and there is no need to specify the capture action.
</p><pre>SecRule ARGS pattern chain,deny,id:25
  SecRule MATCHED_VAR "further scrutiny"
</pre>

<dl><dt>Note : Be aware that this variable holds data for the <i><b>last</b></i> operator match.  This means that if there are more than one matches, only the last one will be populated.  Use MATCHED_VARS variable if you want all matches.</dt></dl>


<h2>
<a id="user-content-matched_vars" class="anchor" href="#matched_vars" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-MATCHED_VARS"></a><span>MATCHED_VARS</span>
</h2>


<p>Similar to MATCHED_VAR except that it is a collection of <i><b>all matches</b></i> for the current operator check.
</p><pre>SecRule ARGS pattern "chain,deny,id:26"
  SecRule MATCHED_VARS "@eq ARGS:param"
</pre>


<h2>
<a id="user-content-matched_var_name" class="anchor" href="#matched_var_name" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-MATCHED_VAR_NAME"></a><span>MATCHED_VAR_NAME</span>
</h2>


<p>This variable holds the full name of the variable that was matched against.
</p><pre>SecRule ARGS pattern "chain,deny,id:27"
  SecRule MATCHED_VAR_NAME "@eq ARGS:param"
</pre>


<dl><dt>Note : Be aware that this variable holds data for the <i><b>last</b></i> operator match.  This means that if there are more than one matches, only the last one will be populated.  Use MATCHED_VARS_NAMES variable if you want all matches.</dt></dl>


<h2>
<a id="user-content-matched_vars_names" class="anchor" href="#matched_vars_names" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-MATCHED_VARS_NAMES"></a><span>MATCHED_VARS_NAMES</span>
</h2>


<p>Similar to MATCHED_VAR_NAME except that it is a collection of <i><b>all matches</b></i> for the current operator check.
</p><pre>SecRule ARGS pattern "chain,deny,id:28"
  SecRule MATCHED_VARS_NAMES "@eq ARGS:param"
</pre>


<h2>
<a id="user-content-modsec_build" class="anchor" href="#modsec_build" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-MODSEC_BUILD"></a><span>MODSEC_BUILD</span>
</h2>


<p>This variable holds the ModSecurity build number. This variable is intended to be used to check the build number prior to using a feature that is available only in a certain build. Example:
</p><pre>SecRule MODSEC_BUILD "!@ge 02050102" "skipAfter:12345,id:29"
SecRule ARGS "@pm some key words" "id:12345,deny,status:500"
</pre>


<h2>
<a id="user-content-multipart_crlf_lf_lines" class="anchor" href="#multipart_crlf_lf_lines" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-MULTIPART_CRLF_LF_LINES"></a><span>MULTIPART_CRLF_LF_LINES</span>
</h2>


<p>This flag variable will be set to 1 whenever a multi-part request uses mixed line terminators. The multipart/form-data RFC requires CRLF sequence to be used to terminate lines. Since some client implementations use only LF to terminate lines you might want to allow them to proceed under certain circumstances (if you want to do this you will need to stop using MULTIPART_STRICT_ERROR and check each multi-part flag variable individually, avoiding MULTIPART_LF_LINE). However, mixing CRLF and LF line terminators is dangerous as it can allow for evasion. Therefore, in such cases, you will have to add a check for MULTIPART_CRLF_LF_LINES.
</p>

<h2>
<a id="user-content-multipart_filename" class="anchor" href="#multipart_filename" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-MULTIPART_FILENAME"></a><span>MULTIPART_FILENAME</span>
</h2>


<p>This variable contains the multipart data from field FILENAME.
</p>

<h2>
<a id="user-content-multipart_name" class="anchor" href="#multipart_name" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-MULTIPART_NAME"></a><span>MULTIPART_NAME</span>
</h2>


<p>This variable contains the multipart data from field NAME.
</p>

<h2>
<a id="user-content-multipart_strict_error" class="anchor" href="#multipart_strict_error" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-MULTIPART_STRICT_ERROR"></a><span>MULTIPART_STRICT_ERROR</span>
</h2>


<p>MULTIPART_STRICT_ERROR will be set to 1 when any of the following variables is also set to 1: REQBODY_PROCESSOR_ERROR, MULTIPART_BOUNDARY_QUOTED, MULTIPART_BOUNDARY_WHITESPACE, MULTIPART_DATA_BEFORE, MULTIPART_DATA_AFTER, MULTIPART_HEADER_FOLDING, MULTIPART_LF_LINE, MULTIPART_MISSING_SEMICOLON MULTIPART_INVALID_QUOTING MULTIPART_INVALID_HEADER_FOLDING MULTIPART_FILE_LIMIT_EXCEEDED. Each of these variables covers one unusual (although sometimes legal) aspect of the request body in multipart/form-data format. Your policies should always contain a rule to check either this variable (easier) or one or more individual variables (if you know exactly what you want to accomplish). Depending on the rate of false positives and your default policy you should decide whether to block or just warn when the rule is triggered.
</p>
<p>The best way to use this variable is as in the example below:
</p><pre>SecRule MULTIPART_STRICT_ERROR "!@eq 0" \
"phase:2,id:30,t:none,log,deny,msg:'Multipart request body \
failed strict validation: \
PE %{REQBODY_PROCESSOR_ERROR}, \
BQ %{MULTIPART_BOUNDARY_QUOTED}, \
BW %{MULTIPART_BOUNDARY_WHITESPACE}, \
DB %{MULTIPART_DATA_BEFORE}, \
DA %{MULTIPART_DATA_AFTER}, \
HF %{MULTIPART_HEADER_FOLDING}, \
LF %{MULTIPART_LF_LINE}, \
SM %{MULTIPART_MISSING_SEMICOLON}, \
IQ %{MULTIPART_INVALID_QUOTING}, \
IQ %{MULTIPART_INVALID_HEADER_FOLDING}, \
FE %{MULTIPART_FILE_LIMIT_EXCEEDED}'"
</pre>
The multipart/form-data parser was upgraded in ModSecurity v2.1.3 to actively look for signs of evasion. Many variables (as listed above) were added to expose various facts discovered during the parsing process. The MULTIPART_STRICT_ERROR variable is handy to check on all abnormalities at once. The individual variables allow detection to be fine-tuned according to your circumstances in order to reduce the number of false positives.


<h2>
<a id="user-content-multipart_unmatched_boundary" class="anchor" href="#multipart_unmatched_boundary" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-MULTIPART_UNMATCHED_BOUNDARY"></a><span>MULTIPART_UNMATCHED_BOUNDARY</span>
</h2>


<p>Set to 1 when, during the parsing phase of a multipart/request-body, ModSecurity encounters what feels like a boundary but it is not. Such an event may occur when evasion of ModSecurity is attempted.
</p>
<p>The best way to use this variable is as in the example below:
</p><pre>SecRule MULTIPART_UNMATCHED_BOUNDARY "!@eq 0" \
"phase:2,id:31,t:none,log,deny,msg:'Multipart parser detected a possible unmatched boundary.'"
</pre>
Change the rule from blocking to logging-only if many false positives are encountered.


<h2>
<a id="user-content-outbound_data_error" class="anchor" href="#outbound_data_error" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-OUTBOUND_DATA_ERROR"></a><span>OUTBOUND_DATA_ERROR</span>
</h2>


<p>This variable will be set to 1 when the response body size is above the setting configured by SecResponseBodyLimit directive.  Your policies should always contain a rule to check this variable.  Depending on the rate of false positives and your default policy you should decide whether to block or just warn when the rule is triggered.
</p>
<p>The best way to use this variable is as in the example below:
</p>
<p><code>SecRule OUTBOUND_DATA_ERROR "@eq 1" "phase:1,id:32,t:none,log,pass,msg:'Response Body Larger than SecResponseBodyLimit Setting'"</code>
</p>

<h2>
<a id="user-content-path_info" class="anchor" href="#path_info" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-PATH_INFO"></a><span>PATH_INFO</span>
</h2>


<p>Contains the extra request URI information, also known as path info. (For example, in the URI /index.php/123, /123 is the path info.) Available only in embedded deployments.
</p>
<p><code>SecRule PATH_INFO "^/(bin|etc|sbin|opt|usr)" "id:33"</code>
</p>

<h2>
<a id="user-content-perf_all" class="anchor" href="#perf_all" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-PERF_ALL"></a><span>PERF_ALL</span>
</h2>


<p>This special variable contains a string that’s a combination of all other performance variables, arranged in the same order in which they appear in the Stopwatch2 audit log header. It’s intended for use in custom Apache logs
</p>
<p><b>Version:</b> 2.6.0-2.9.x
</p>
<p><b>Supported on libModSecurity:</b> TBI
</p>

<h2>
<a id="user-content-perf_combined" class="anchor" href="#perf_combined" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-PERF_COMBINED"></a><span>PERF_COMBINED</span>
</h2>


<p>Contains the time, in microseconds, spent in ModSecurity during the current transaction. The value in this variable is arrived to by adding all the performance variables except PERF_SREAD (the time spent reading from persistent storage is already included in the phase measurements). 
</p>
<p><b>Version:</b> 2.6.0-2.9.x
</p>
<p><b>Supported on libModSecurity:</b> TBI
</p>

<h2>
<a id="user-content-perf_gc" class="anchor" href="#perf_gc" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-PERF_GC"></a><span>PERF_GC</span>
</h2>


<p>Contains the time, in microseconds, spent performing garbage collection.
</p>
<p><b>Version:</b> 2.6.0-2.9.x
</p>
<p><b>Supported on libModSecurity:</b> TBI
</p>

<h2>
<a id="user-content-perf_logging" class="anchor" href="#perf_logging" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-PERF_LOGGING"></a><span>PERF_LOGGING</span>
</h2>


<p>Contains the time, in microseconds, spent in audit logging. This value is known only after the handling of a transaction is finalized, which means that it can only be logged using mod_log_config and the %{VARNAME}M syntax. 
</p>
<p><b>Version:</b> 2.6.0-2.9.x
</p>
<p><b>Supported on libModSecurity:</b> TBI
</p>

<h2>
<a id="user-content-perf_phase1" class="anchor" href="#perf_phase1" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-PERF_PHASE1"></a><span>PERF_PHASE1</span>
</h2>


<p>Contains the time, in microseconds, spent processing phase 1.
</p>
<p><b>Version:</b> 2.6.0-2.9.x
</p>
<p><b>Supported on libModSecurity:</b> TBI
</p>

<h2>
<a id="user-content-perf_phase2" class="anchor" href="#perf_phase2" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-PERF_PHASE2"></a><span>PERF_PHASE2</span>
</h2>


<p>Contains the time, in microseconds, spent processing phase 2.
</p>
<p><b>Version:</b> 2.6.0-2.9.x
</p>
<p><b>Supported on libModSecurity:</b> TBI
</p>

<h2>
<a id="user-content-perf_phase3" class="anchor" href="#perf_phase3" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-PERF_PHASE3"></a><span>PERF_PHASE3</span>
</h2>


<p>Contains the time, in microseconds, spent processing phase 3.
</p>
<p><b>Version:</b> 2.6.0-2.9.x
</p>
<p><b>Supported on libModSecurity:</b> TBI
</p>

<h2>
<a id="user-content-perf_phase4" class="anchor" href="#perf_phase4" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-PERF_PHASE4"></a><span>PERF_PHASE4</span>
</h2>


<p>Contains the time, in microseconds, spent processing phase 4.
</p>
<p><b>Version:</b> 2.6.0-2.9.x
</p>
<p><b>Supported on libModSecurity:</b> TBI
</p>

<h2>
<a id="user-content-perf_phase5" class="anchor" href="#perf_phase5" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-PERF_PHASE5"></a><span>PERF_PHASE5</span>
</h2>


<p>Contains the time, in microseconds, spent processing phase 5.
</p>
<p><b>Version:</b> 2.6.0-2.9.x
</p>
<p><b>Supported on libModSecurity:</b> TBI
</p>

<h2>
<a id="user-content-perf_rules" class="anchor" href="#perf_rules" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-PERF_RULES"></a><span>PERF_RULES</span>
</h2>


<p>PERF_RULES is a collection, that is populated with the rules hitting
the performance threshold defined with SecRulePerfTime. The collection
contains the time, in microseconds, spent processing the individual
rule. The various items in the collection can be accessed via the
rule id.
</p>
<p><b>Version:</b> 2.7.0-2.9.x
</p>
<p><b>Supported on libModSecurity:</b> TBI
</p>
<pre>SecRulePerfTime            100

SecRule FILES_TMPNAMES "@inspectFile /path/to/util/runav.pl" \
  "phase:2,id:10001,deny,log,msg:'Virus scan detected an error.'"

SecRule   &amp;PERF_RULES "@eq 0"    "phase:5,id:95000,\
  pass,log,msg:'All rules performed below processing time limit.'"
SecRule   PERF_RULES  "@ge 1000" "phase:5,id:95001,pass,log,\
  msg:'Rule %{MATCHED_VAR_NAME} spent at least 1000 usec.'"
SecAction "phase:5,id:95002,pass,log, msg:'File inspection took %{PERF_RULES.10001} usec.'"
</pre>

<p>The rule with id 10001 defines an external file inspection rule.
The rule with id 95000 checks the size of the PERF_RULES collection.
If the collection is empty, it writes a note in the logfile.
Rule 95001 is executed for every item in the PERF_RULES collection.
Every item is thus being checked against the limit of 1000 microseconds.
If the rule spent at least that amount of time, then a note containing
the rule id is being written to the logfile.
The final rule 95002 notes the time spent in rule 10001 (the virus
inspection).
</p>

<h2>
<a id="user-content-perf_sread" class="anchor" href="#perf_sread" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-PERF_SREAD"></a><span>PERF_SREAD</span>
</h2>


<p>Contains the time, in microseconds, spent reading from persistent storage.
</p>
<p><b>Version:</b> 2.6.0-2.9.x
</p>
<p><b>Supported on libModSecurity:</b> TBI
</p>

<h2>
<a id="user-content-perf_swrite" class="anchor" href="#perf_swrite" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-PERF_SWRITE"></a><span>PERF_SWRITE</span>
</h2>


<p>Contains the time, in microseconds, spent writing to persistent storage.
</p>
<p><b>Version:</b> 2.6.0-2.9.x
</p>
<p><b>Supported on libModSecurity:</b> TBI
</p>

<h2>
<a id="user-content-query_string" class="anchor" href="#query_string" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-QUERY_STRING"></a><span>QUERY_STRING</span>
</h2>


<p>Contains the query string part of a request URI. The value in QUERY_STRING is always provided raw, without URL decoding taking place.
</p>
<p><code>SecRule QUERY_STRING "attack" "id:34"</code>
</p>

<h2>
<a id="user-content-remote_addr" class="anchor" href="#remote_addr" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-REMOTE_ADDR"></a><span>REMOTE_ADDR</span>
</h2>


<p>This variable holds the IP address of the remote client.
</p>
<p><code>SecRule REMOTE_ADDR "@ipMatch 192.168.1.101" "id:35"</code>
</p>

<h2>
<a id="user-content-remote_host" class="anchor" href="#remote_host" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-REMOTE_HOST"></a><span>REMOTE_HOST</span>
</h2>


<p>If the Apache directive HostnameLookups is set to On, then this variable will hold the remote hostname resolved through DNS. If the directive is set to Off, this variable it will hold the remote IP address (same as REMOTE_ADDR). Possible uses for this variable would be to deny known bad client hosts or network blocks, or conversely, to allow in authorized hosts.
</p>
<p><code>SecRule REMOTE_HOST "\.evil\.network\org$" "id:36"</code>
</p>

<h2>
<a id="user-content-remote_port" class="anchor" href="#remote_port" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-REMOTE_PORT"></a><span>REMOTE_PORT</span>
</h2>


<p>This variable holds information on the source port that the client used when initiating the connection to our web server.
</p>
<p>In the following example, we are evaluating to see whether the REMOTE_PORT is less than 1024, which would indicate that the user is a privileged user:
</p>
<p><code>SecRule REMOTE_PORT "@lt 1024" "id:37"</code>
</p>

<h2>
<a id="user-content-remote_user" class="anchor" href="#remote_user" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-REMOTE_USER"></a><span>REMOTE_USER</span>
</h2>


<p>This variable holds the username of the authenticated user. If there are no password access controls in place (Basic or Digest authentication), then this variable will be empty.
</p>
<p><code>SecRule REMOTE_USER "@streq admin" "id:38"</code>
</p>

<dl><dt>Note : In a reverse-proxy deployment, this information will not be available if the authentication is handled in the backend web server.</dt></dl>


<h2>
<a id="user-content-reqbody_error" class="anchor" href="#reqbody_error" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-REQBODY_ERROR"></a><span>REQBODY_ERROR</span>
</h2>


<p>Contains the status of the request body processor used for request body parsing. The values can be 0 (no error) or 1 (error). This variable will be set by request body processors (typically the multipart/request-data parser, JSON or the XML parser) when they fail to do their work.
</p>
<p><code>SecRule REQBODY_ERROR "@eq 1" deny,phase:2,id:39 </code>
</p>

<dl><dt>Note : Your policies must have a rule to check for request body processor errors at the very beginning of phase 2. Failure to do so will leave the door open for impedance mismatch attacks. It is possible, for example, that a payload that cannot be parsed by ModSecurity can be successfully parsed by more tolerant parser operating in the application. If your policy dictates blocking, then you should reject the request if error is detected. When operating in detection-only mode, your rule should alert with high severity when request body processing fails.</dt></dl>


<dl><dt>Related issues: #1475</dt></dl>


<h2>
<a id="user-content-reqbody_error_msg" class="anchor" href="#reqbody_error_msg" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-REQBODY_ERROR_MSG"></a><span>REQBODY_ERROR_MSG</span>
</h2>


<p>If there’s been an error during request body parsing, the variable will contain the following error message:
</p>
<p><code>SecRule REQBODY_ERROR_MSG "failed to parse" "id:40"</code>
</p>

<h2>
<a id="user-content-reqbody_processor" class="anchor" href="#reqbody_processor" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-REQBODY_PROCESSOR"></a><span>REQBODY_PROCESSOR</span>
</h2>


<p>Contains the name of the currently used request body processor. The possible values are URLENCODED, MULTIPART, and XML.
</p>
<pre>SecRule REQBODY_PROCESSOR "^XML$ chain,id:41 
  SecRule XML "@validateDTD /opt/apache-frontend/conf/xml.dtd"
</pre>


<h2>
<a id="user-content-request_basename" class="anchor" href="#request_basename" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-REQUEST_BASENAME"></a><span>REQUEST_BASENAME</span>
</h2>


<p>This variable holds just the filename part of REQUEST_FILENAME (e.g., index.php). 
</p>
<p><code>SecRule REQUEST_BASENAME "^login\.php$" phase:2,id:42,t:none,t:lowercase</code>
</p>

<dl><dt>Note : Please note that anti-evasion transformations are not applied to this variable by default. REQUEST_BASENAME will recognise both / and \ as path separators. You should understand that the value of this variable depends on what was provided in request, and that it does not have to correspond to the resource (on disk) that will be used by the web server.</dt></dl>


<h2>
<a id="user-content-request_body" class="anchor" href="#request_body" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-REQUEST_BODY"></a><span>REQUEST_BODY</span>
</h2>


<p>Holds the raw request body. This variable is available only if the URLENCODED request body processor was used, which will occur by default when the application/x-www-form-urlencoded content type is detected, or if the use of the URLENCODED request body parser was forced. 
</p>
<p><code>SecRule REQUEST_BODY "^username=\w{25,}\&amp;password=\w{25,}\&amp;Submit\=login$" "id:43"</code>
</p>
<p>As of 2.5.7, it is possible to force the presence of the REQUEST_BODY variable, but only when there is no request body processor defined using the ctl:forceRequestBodyVariable option in the REQUEST_HEADERS phase.
</p>

<h2>
<a id="user-content-request_body_length" class="anchor" href="#request_body_length" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-REQUEST_BODY_LENGTH"></a><span>REQUEST_BODY_LENGTH</span>
</h2>


<p>Contains the number of bytes read from a request body. Available starting with v2.6
</p>

<h2>
<a id="user-content-request_cookies" class="anchor" href="#request_cookies" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-REQUEST_COOKIES"></a><span>REQUEST_COOKIES</span>
</h2>


<p>This variable is a collection of all of request cookies (values only).  Example: the following example is using the Ampersand special operator to count how many variables are in the collection. In this rule, it would trigger if the request does not include any Cookie headers.
</p>
<p><code>SecRule &amp;REQUEST_COOKIES "@eq 0" "id:44"</code>
</p>

<h2>
<a id="user-content-request_cookies_names" class="anchor" href="#request_cookies_names" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-REQUEST_COOKIES_NAMES"></a><span>REQUEST_COOKIES_NAMES</span>
</h2>


<p>This variable is a collection of the names of all request cookies. For example, the following rule will trigger if the JSESSIONID cookie is not present:
</p>
<p><code>SecRule &amp;REQUEST_COOKIES_NAMES:JSESSIONID "@eq 0" "id:45"</code>
</p>

<h2>
<a id="user-content-request_filename" class="anchor" href="#request_filename" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-REQUEST_FILENAME"></a><span>REQUEST_FILENAME</span>
</h2>


<p>This variable holds the relative request URL without the query string part (e.g., /index.php). 
</p>
<p><code>SecRule REQUEST_FILENAME "^/cgi-bin/login\.php$" phase:2,id:46,t:none,t:normalizePath</code>
</p>

<dl><dt>Note : Please note that anti-evasion transformations are not used on REQUEST_FILENAME, which means that you will have to specify them in the rules that use this variable.</dt></dl>


<h2>
<a id="user-content-request_headers" class="anchor" href="#request_headers" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-REQUEST_HEADERS"></a><span>REQUEST_HEADERS</span>
</h2>


<p>This variable can be used as either a collection of all of the request headers or can be used to inspect selected headers (by using the REQUEST_HEADERS:Header-Name syntax).
</p>
<p><code>SecRule REQUEST_HEADERS:Host "^[\d\.]+$" "deny,id:47,log,status:400,msg:'Host header is a numeric IP address'"</code>
</p>

<dl><dt>Note: ModSecurity will treat multiple headers that have identical names in accordance with how the webserver treats them. For Apache this means that they will all be concatenated into a single header with a comma as the deliminator. </dt></dl>


<h2>
<a id="user-content-request_headers_names" class="anchor" href="#request_headers_names" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-REQUEST_HEADERS_NAMES"></a><span>REQUEST_HEADERS_NAMES</span>
</h2>


<p>This variable is a collection of the names of all of the request headers.
</p>
<p><code>SecRule REQUEST_HEADERS_NAMES "^x-forwarded-for" "log,deny,id:48,status:403,t:lowercase,msg:'Proxy Server Used'"</code>
</p>

<h2>
<a id="user-content-request_line" class="anchor" href="#request_line" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-REQUEST_LINE"></a><span>REQUEST_LINE</span>
</h2>


<p>This variable holds the complete request line sent to the server (including the request method and HTTP version information).
</p>
<pre># Allow only POST, GET and HEAD request methods, as well as only
# the valid protocol versions 
SecRule REQUEST_LINE "!(^((?:(?:POS|GE)T|HEAD))|HTTP/(0\.9|1\.0|1\.1)$)" "phase:1,id:49,log,block,t:none"
</pre>


<h2>
<a id="user-content-request_method" class="anchor" href="#request_method" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-REQUEST_METHOD"></a><span>REQUEST_METHOD</span>
</h2>


<p>This variable holds the request method used in the transaction.
</p>
<p><code>SecRule REQUEST_METHOD "^(?:CONNECT|TRACE)$" "id:50,t:none"</code>
</p>

<h2>
<a id="user-content-request_protocol" class="anchor" href="#request_protocol" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-REQUEST_PROTOCOL"></a><span>REQUEST_PROTOCOL</span>
</h2>


<p>This variable holds the request protocol version information.
</p>
<p><code>SecRule REQUEST_PROTOCOL "!^HTTP/(0\.9|1\.0|1\.1)$" "id:51"</code>
</p>

<h2>
<a id="user-content-request_uri" class="anchor" href="#request_uri" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-REQUEST_URI"></a><span>REQUEST_URI</span>
</h2>


<p>This variable holds the full request URL including the query string data (e.g., /index.php? p=X). However, it will never contain a domain name, even if it was provided on the request line.
</p>
<p><code>SecRule REQUEST_URI "attack" "phase:1,id:52,t:none,t:urlDecode,t:lowercase,t:normalizePath"</code>
</p>

<dl><dt>Note : Please note that anti-evasion transformations are not used on REQUEST_URI, which means that you will have to specify them in the rules that use this variable.</dt></dl>


<h2>
<a id="user-content-request_uri_raw" class="anchor" href="#request_uri_raw" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-REQUEST_URI_RAW"></a><span>REQUEST_URI_RAW</span>
</h2>


<p>Same as REQUEST_URI but will contain the domain name if it was provided on the request line (e.g., <a href="http://www.example.com/index.php?p=X">http://www.example.com/index.php?p=X</a>).
</p>
<p><code>SecRule REQUEST_URI_RAW "http:/" "phase:1,id:53,t:none,t:urlDecode,t:lowercase,t:normalizePath"</code>
</p>

<dl><dt>Note : Please note that anti-evasion transformations are not used on REQUEST_URI_RAW, which means that you will have to specify them in the rules that use this variable.</dt></dl>


<h2>
<a id="user-content-response_body" class="anchor" href="#response_body" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-RESPONSE_BODY"></a><span>RESPONSE_BODY</span>
</h2>


<p>This variable holds the data for the response body, but only when response body buffering is enabled.
</p>
<p><code>SecRule RESPONSE_BODY "ODBC Error Code" "phase:4,id:54,t:none"</code>
</p>

<h2>
<a id="user-content-response_content_length" class="anchor" href="#response_content_length" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-RESPONSE_CONTENT_LENGTH"></a><span>RESPONSE_CONTENT_LENGTH</span>
</h2>


<p>Response body length in bytes. Can be available starting with phase 3, but it does not have to be (as the length of response body is not always known in advance). If the size is not known, this variable will contain a zero. If RESPONSE_CONTENT_LENGTH contains a zero in phase 5 that means the actual size of the response body was 0. The value of this variable can change between phases if the body is modified. For example, in embedded mode, mod_deflate can compress the response body between phases 4 and 5.
</p>

<h2>
<a id="user-content-response_content_type" class="anchor" href="#response_content_type" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-RESPONSE_CONTENT_TYPE"></a><span>RESPONSE_CONTENT_TYPE</span>
</h2>


<p>Response content type. Available only starting with phase 3. The value available in this variable is taken directly from the internal structures of Apache, which means that it may contain the information that is not yet available in response headers. In embedded deployments, you should always refer to this variable, rather than to RESPONSE_HEADERS:Content-Type.
</p>

<h2>
<a id="user-content-response_headers" class="anchor" href="#response_headers" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-RESPONSE_HEADERS"></a><span>RESPONSE_HEADERS</span>
</h2>


<p>This variable refers to response headers, in the same way as REQUEST_HEADERS does to request headers.
</p>
<p><code>SecRule RESPONSE_HEADERS:X-Cache "MISS" "id:55"</code>
</p>
<p>This variable may not have access to some headers when running in embedded mode. Headers such as Server, Date, Connection, and Content-Type could be added just prior to sending the data to the client. This data should be available in phase 5 or when deployed in proxy mode.
</p>

<h2>
<a id="user-content-response_headers_names" class="anchor" href="#response_headers_names" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-RESPONSE_HEADERS_NAMES"></a><span>RESPONSE_HEADERS_NAMES</span>
</h2>


<p>This variable is a collection of the response header names.
</p>
<p><code>SecRule RESPONSE_HEADERS_NAMES "Set-Cookie" "phase:3,id:56,t:none"</code>
</p>
<p>The same limitations apply as the ones discussed in RESPONSE_HEADERS.
</p>

<h2>
<a id="user-content-response_protocol" class="anchor" href="#response_protocol" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-RESPONSE_PROTOCOL"></a><span>RESPONSE_PROTOCOL</span>
</h2>


<p>This variable holds the HTTP response protocol information.
</p>
<p><code>SecRule RESPONSE_PROTOCOL "^HTTP\/0\.9" "phase:3,id:57,t:none"</code>
</p>

<h2>
<a id="user-content-response_status" class="anchor" href="#response_status" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-RESPONSE_STATUS"></a><span>RESPONSE_STATUS</span>
</h2>


<p>This variable holds the HTTP response status code:
</p>
<p><code>SecRule RESPONSE_STATUS "^[45]" "phase:3,id:58,t:none"</code>
</p>
<p>This variable may not work as expected in embedded mode, as Apache sometimes handles certain requests differently, and without invoking ModSecurity (all other modules).
</p>

<h2>
<a id="user-content-rule" class="anchor" href="#rule" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-RULE"></a><span>RULE</span>
</h2>


<p>This is a special collection that provides access to the id, rev, severity, logdata, and msg fields of the rule that triggered the action. It can be used to refer to only the same rule in which it resides.
</p>
<p><code>SecRule &amp;REQUEST_HEADERS:Host "@eq 0" "log,deny,id:59,setvar:tx.varname=%{RULE.id}"</code>
</p>

<h2>
<a id="user-content-script_basename" class="anchor" href="#script_basename" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-SCRIPT_BASENAME"></a><span>SCRIPT_BASENAME</span>
</h2>


<p>This variable holds just the local filename part of SCRIPT_FILENAME.
</p>
<p><b>Version:</b> 2.x
</p>
<p><b>Supported on libModSecurity:</b> TBI
</p>
<p><code>SecRule SCRIPT_BASENAME "^login\.php$" "id:60"</code>
</p>

<dl><dt>Note :  Not available in proxy mode.</dt></dl>


<h2>
<a id="user-content-script_filename" class="anchor" href="#script_filename" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-SCRIPT_FILENAME"></a><span>SCRIPT_FILENAME</span>
</h2>


<p>This variable holds the full internal path to the script that will be used to serve the request.
</p>
<p><b>Version:</b> 2.x
</p>
<p><b>Supported on libModSecurity:</b> TBI 
</p>
<p><code>SecRule SCRIPT_FILENAME "^/usr/local/apache/cgi-bin/login\.php$" "id:61"</code>
</p>

<dl><dt>Note : Not available in proxy mode.</dt></dl>


<h2>
<a id="user-content-script_gid" class="anchor" href="#script_gid" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-SCRIPT_GID"></a><span>SCRIPT_GID</span>
</h2>


<p>This variable holds the numerical identifier of the group owner of the script.
</p>
<p><b>Version:</b> 2.x
</p>
<p><b>Supported on libModSecurity:</b> TBI
</p>
<p><code>SecRule SCRIPT_GID "!^46$" "id:62"</code>
</p>

<dl><dt>Note : Not available in proxy mode.</dt></dl>


<h2>
<a id="user-content-script_groupname" class="anchor" href="#script_groupname" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-SCRIPT_GROUPNAME"></a><span>SCRIPT_GROUPNAME</span>
</h2>


<p>This variable holds the name of the group owner of the script.
</p>
<p><b>Version:</b> 2.x
</p>
<p><b>Supported on libModSecurity:</b> TBI 
</p>
<p><code>SecRule SCRIPT_GROUPNAME "!^apache$" "id:63"</code>
</p>

<dl><dt>Note : Not available in proxy mode.</dt></dl>


<h2>
<a id="user-content-script_mode" class="anchor" href="#script_mode" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-SCRIPT_MODE"></a><span>SCRIPT_MODE</span>
</h2>


<p>This variable holds the script’s permissions mode data (e.g., 644).
</p>
<p><b>Version:</b> 2.x
</p>
<p><b>Supported on libModSecurity:</b> TBI  
</p>
<pre># Do not allow scripts that can be written to
SecRule SCRIPT_MODE "^(2|3|6|7)$" "id:64"
</pre>


<dl><dt>Note : Not available in proxy mode.</dt></dl>


<h2>
<a id="user-content-script_uid" class="anchor" href="#script_uid" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-SCRIPT_UID"></a><span>SCRIPT_UID</span>
</h2>


<p>This variable holds the numerical identifier of the owner of the script.
</p>
<p><b>Version:</b> 2.x
</p>
<p><b>Supported on libModSecurity:</b> TBI 
</p>
<pre># Do not run any scripts that are owned 
# by Apache (Apache's user id is 46) 
SecRule SCRIPT_UID "!^46$" "id:65"
</pre>


<dl><dt>Note : Not available in proxy mode.</dt></dl>


<h2>
<a id="user-content-script_username" class="anchor" href="#script_username" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-SCRIPT_USERNAME"></a><span>SCRIPT_USERNAME</span>
</h2>


<p>This variable holds the username of the owner of the script.
</p>
<p><b>Version:</b> 2.x
</p>
<p><b>Supported on libModSecurity:</b> TBI 
</p>
<pre># Do not run any scripts owned by Apache SecRule 
SCRIPT_USERNAME "^apache$" "id:66"
</pre>


<dl><dt>Note : Not available in proxy mode.</dt></dl>


<h2>
<a id="user-content-sdbm_delete_error" class="anchor" href="#sdbm_delete_error" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-SDBM_DELETE_ERROR"></a><span>SDBM_DELETE_ERROR</span>
</h2>


<p><b>Version:</b> 2.x
</p>
<p><b>Supported on libModSecurity:</b> No
</p>
<p>This variable is set to 1 when APR fails to delete SDBM entries.
</p>

<h2>
<a id="user-content-server_addr" class="anchor" href="#server_addr" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-SERVER_ADDR"></a><span>SERVER_ADDR</span>
</h2>


<p>This variable contains the IP address of the server.
</p>
<p><code>SecRule SERVER_ADDR "@ipMatch 192.168.1.100" "id:67"</code>
</p>

<h2>
<a id="user-content-server_name" class="anchor" href="#server_name" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-SERVER_NAME"></a><span>SERVER_NAME</span>
</h2>


<p>This variable contains the transaction’s hostname or IP address, taken from the request itself (which means that, in principle, it should not be trusted).
</p>
<p><code>SecRule SERVER_NAME "hostname\.com$" "id:68"</code>
</p>

<h2>
<a id="user-content-server_port" class="anchor" href="#server_port" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-SERVER_PORT"></a><span>SERVER_PORT</span>
</h2>


<p>This variable contains the local port that the web server (or reverse proxy) is listening on.
</p>
<p><code>SecRule SERVER_PORT "^80$" "id:69"</code>
</p>

<h2>
<a id="user-content-session" class="anchor" href="#session" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-SESSION"></a><span>SESSION</span>
</h2>


<p>This variable is a collection that contains session information. It becomes available only after setsid is executed.
</p>
<p>The following example shows how to initialize SESSION using setsid, how to use setvar to increase the SESSION.score values, how to set the SESSION.blocked variable, and finally, how to deny the connection based on the SESSION:blocked value:
</p>
<pre># Initialize session storage 
SecRule REQUEST_COOKIES:PHPSESSID !^$ "phase:2,id:70,nolog,pass,setsid:%{REQUEST_COOKIES.PHPSESSID}"

# Increment session score on attack 
SecRule REQUEST_URI "^/cgi-bin/finger$" "phase:2,id:71,t:none,t:lowercase,t:normalizePath,pass,setvar:SESSION.score=+10" 

# Detect too many attacks in a session
SecRule SESSION:score "@gt 50" "phase:2,id:72,pass,setvar:SESSION.blocked=1"

# Enforce session block 
SecRule SESSION:blocked "@eq 1" "phase:2,id:73,deny,status:403"
</pre>


<h2>
<a id="user-content-sessionid" class="anchor" href="#sessionid" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-SESSIONID"></a><span>SESSIONID</span>
</h2>


<p>This variable contains the value set with setsid. See SESSION (above) for a complete example.
</p>

<h2>
<a id="user-content-status_line" class="anchor" href="#status_line" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-STATUS_LINE"></a><span>STATUS_LINE</span>
</h2>


<p>This variable holds the full status line sent by the server (including the request method and HTTP version information).
</p>
<pre># Generate an alert when the application generates 500 errors.
SecRule STATUS_LINE "@contains 500" "phase:3,id:49,log,pass,logdata:'Application error detected!,t:none"
</pre>

<p><b>Version:</b> 2.x
</p>
<p><b>Supported on libModSecurity:</b> TBI
</p>

<h2>
<a id="user-content-stream_input_body" class="anchor" href="#stream_input_body" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-STREAM_INPUT_BODY"></a><span>STREAM_INPUT_BODY</span>
</h2>


<p><b>Version:</b> 2.6.0-2.9.x
</p>
<p><b>Supported on libModSecurity:</b> No
</p>
<p>This variable give access to the raw request body content.  This variable is best used for two use-cases:



</p><ol>
<li>For fast pattern matching - using @pm/@pmf to prequalify large text strings against any kind of content-type data.  This is more performant vs. using REQUEST_BODY/ARGS_POST/ARGS_POST_NAMES as it happens before ModSecurity parsing in phase:2 variable population.</li>
<li>For data substitution - using @rsub against this variable allows you to manipulate live request body data.  Example - to remove offending payloads or to substitute benign data.</li>
</ol><dl><dt>Note : You must enable the SecStreamInBodyInspection directive</dt></dl>


<dl><dt>Note : This directive is NOT supported for libModSecurity (v3).</dt></dl>


<h2>
<a id="user-content-stream_output_body" class="anchor" href="#stream_output_body" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-STREAM_OUTPUT_BODY"></a><span>STREAM_OUTPUT_BODY</span>
</h2>


<p>This variable give access to the raw response body content.  This variable is best used for case:
</p>

<ol><li>For data substitution - using @rsub against this variable allows you to manipulate live request body data.  Example - to remove offending payloads or to substitute benign data.</li></ol>

<p><b>Version:</b> 2.6.0-2.9.x
</p>
<p><b>Supported on libModSecurity:</b> TBD
</p>

<dl><dt>Note : You must enable the SecStreamOutBodyInspection directive</dt></dl>


<h2>
<a id="user-content-time" class="anchor" href="#time" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-TIME"></a><span>TIME</span>
</h2>


<p>This variable holds a formatted string representing the time (hour:minute:second).
</p>
<p><code>SecRule TIME "^(([1](8|9))|([2](0|1|2|3))):\d{2}:\d{2}$" "id:74"</code>
</p>

<h2>
<a id="user-content-time_day" class="anchor" href="#time_day" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-TIME_DAY"></a><span>TIME_DAY</span>
</h2>


<p>This variable holds the current date (1–31). The following rule triggers on a transaction that’s happening anytime between the 10th and 20th in a month:
</p>
<p><code>SecRule TIME_DAY "^(([1](0|1|2|3|4|5|6|7|8|9))|20)$" "id:75"</code>
</p>

<h2>
<a id="user-content-time_epoch" class="anchor" href="#time_epoch" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-TIME_EPOCH"></a><span>TIME_EPOCH</span>
</h2>


<p>This variable holds the time in seconds since 1970.
</p>

<h2>
<a id="user-content-time_hour" class="anchor" href="#time_hour" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-TIME_HOUR"></a><span>TIME_HOUR</span>
</h2>


<p>This variable holds the current hour value (0–23). The following rule triggers when a request is made “off hours”:
</p>
<p><code>SecRule TIME_HOUR "^(0|1|2|3|4|5|6|[1](8|9)|[2](0|1|2|3))$" "id:76"</code>
</p>

<h2>
<a id="user-content-time_min" class="anchor" href="#time_min" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-TIME_MIN"></a><span>TIME_MIN</span>
</h2>


<p>This variable holds the current minute value (0–59). The following rule triggers during the last half hour of every hour:
</p>
<p><code>SecRule TIME_MIN "^(3|4|5)" "id:77"</code>
</p>

<h2>
<a id="user-content-time_mon" class="anchor" href="#time_mon" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-TIME_MON"></a><span>TIME_MON</span>
</h2>


<p>This variable holds the current month value (0–11). The following rule matches if the month is either November (value 10) or December (value 11):
</p>
<p><code>SecRule TIME_MON "^1" "id:78"</code>
</p>

<h2>
<a id="user-content-time_sec" class="anchor" href="#time_sec" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-TIME_SEC"></a><span>TIME_SEC</span>
</h2>


<p>This variable holds the current second value (0–59).
</p>
<p><code>SecRule TIME_SEC "@gt 30" "id:79"</code>
</p>

<h2>
<a id="user-content-time_wday" class="anchor" href="#time_wday" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-TIME_WDAY"></a><span>TIME_WDAY</span>
</h2>


<p>This variable holds the current weekday value (0–6). The following rule triggers only on Satur- day and Sunday:
</p>
<p><code>SecRule TIME_WDAY "^(0|6)$" "id:80"</code>
</p>

<h2>
<a id="user-content-time_year" class="anchor" href="#time_year" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-TIME_YEAR"></a><span>TIME_YEAR</span>
</h2>


<p>This variable holds the current four-digit year value.
</p>
<p><code>SecRule TIME_YEAR "^2006$" "id:81"</code>
</p>

<h2>
<a id="user-content-tx" class="anchor" href="#tx" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-TX"></a><span>TX</span>
</h2>


<p>This is the transient transaction collection, which is used to store pieces of data, create a transaction anomaly score, and so on. The variables placed into this collection are available only until the transaction is complete.
</p>
<pre># Increment transaction attack score on attack 
SecRule ARGS attack "phase:2,id:82,nolog,pass,setvar:TX.score=+5"

# Block the transactions whose scores are too high 
SecRule TX:SCORE "@gt 20" "phase:2,id:83,log,deny"
</pre>

<p>Some variable names in the TX collection are reserved and cannot be used: 




</p><ul>
<li>TX:0: the matching value when using the @rx or @pm operator with the capture action</li>
<li>TX:1-TX:9: the captured subexpression value when using the @rx operator with capturing parens and the capture action</li>
<li>TX:MSC_.*: ModSecurity processing flags </li>
<li>MSC_PCRE_LIMITS_EXCEEDED: Set to nonzero if PCRE match limits are exceeded. See SecPcreMatchLimit and SecPcreMatchLimitRecursion for more information.</li>
</ul>


<h2>
<a id="user-content-unique_id" class="anchor" href="#unique_id" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-UNIQUE_ID"></a><span>UNIQUE_ID</span>
</h2>


<p>This variable holds the data created by mod_unique_id <a href="http://httpd.apache.org/docs/2.2/mod/mod_unique_id.html">http://httpd.apache.org/docs/2.2/mod/mod_unique_id.html</a>.  This module provides a magic token for each request which is guaranteed to be unique across "all" requests under very specific conditions. The unique identifier is even unique across multiple machines in a properly configured cluster of machines. The environment variable UNIQUE_ID is set to the identifier for each request.  The UNIQUE_ID environment variable is constructed by encoding the 112-bit (32-bit IP address, 32 bit pid, 32 bit time stamp, 16 bit counter) quadruple using the alphabet [A-Za-z0-9@-] in a manner similar to MIME base64 encoding, producing 19 characters.
</p>

<h2>
<a id="user-content-urlencoded_error" class="anchor" href="#urlencoded_error" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-URLENCODED_ERROR"></a><span>URLENCODED_ERROR</span>
</h2>


<p>This variable is created when an invalid URL encoding is encountered during the parsing of a query string (on every request) or during the parsing of an application/x-www-form-urlencoded request body (only on the requests that use the URLENCODED request body processor).
</p>

<h2>
<a id="user-content-userid" class="anchor" href="#userid" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-USERID"></a><span>USERID</span>
</h2>


<p>This variable contains the value set with setuid. 
</p>
<pre># Initialize user tracking
SecAction "nolog,id:84,pass,setuid:%{REMOTE_USER}" 

# Is the current user the administrator?
SecRule USERID "admin" "id:85"
</pre>


<h2>
<a id="user-content-useragent_ip" class="anchor" href="#useragent_ip" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-USERAGENT_IP"></a><span>USERAGENT_IP</span>
</h2>


<p>This variable is created when running modsecurity with apache2.4 and will contains the client ip address set by mod_remoteip in proxied connections.
</p>
<p><b>Version:</b> 2.x
</p>
<p><b>Supported on libModSecurity:</b> TBI
</p>

<h2>
<a id="user-content-webappid" class="anchor" href="#webappid" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-WEBAPPID"></a><span>WEBAPPID</span>
</h2>


<p>This variable contains the current application name, which is set in configuration using SecWebAppId.
</p>
<p><b>Version:</b> 2.0.0-2.9.x
</p>
<p><b>Supported on libModSecurity:</b> TBI
</p>

<h2>
<a id="user-content-webserver_error_log" class="anchor" href="#webserver_error_log" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-WEBSERVER_ERROR_LOG"></a><span>WEBSERVER_ERROR_LOG</span>
</h2>



<p><b>Version:</b> 2.x
</p>
<p><b>Supported on libModSecurity:</b> TBI
</p>
<p>Contains zero or more error messages produced by the web server. This variable is best accessed from phase 5 (logging).
</p>
<p><code>SecRule WEBSERVER_ERROR_LOG "File does not exist" "phase:5,id:86,t:none,nolog,pass,setvar:TX.score=+5"</code>
</p>

<h2>
<a id="user-content-xml" class="anchor" href="#xml" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-XML"></a><span>XML</span>
</h2>


<p>Special collection used to interact with the XML parser. It can be used standalone as a target for the validateDTD and validateSchema operator. Otherwise, it must contain a valid XPath expression, which will then be evaluated against a previously parsed XML DOM tree.
</p>
<pre>SecDefaultAction log,deny,status:403,phase:2,id:90
SecRule REQUEST_HEADERS:Content-Type ^text/xml$ "phase:1,id:87,t:lowercase,nolog,pass,ctl:requestBodyProcessor=XML"
SecRule REQBODY_PROCESSOR "!^XML$" skipAfter:12345,id:88

SecRule XML:/employees/employee/name/text() Fred "id:89"
SecRule XML:/xq:employees/employee/name/text() Fred "id:12345,xmlns:xq=http://www.example.com/employees"
</pre>

<p>The first XPath expression does not use namespaces. It would match against payload such as this one:
</p><pre>&lt;employees&gt;
    &lt;employee&gt;
        &lt;name&gt;Fred Jones&lt;/name&gt;
        &lt;address location="home"&gt;
            &lt;street&gt;900 Aurora Ave.&lt;/street&gt;
            &lt;city&gt;Seattle&lt;/city&gt;
            &lt;state&gt;WA&lt;/state&gt;
            &lt;zip&gt;98115&lt;/zip&gt;
        &lt;/address&gt;
        &lt;address location="work"&gt;
            &lt;street&gt;2011 152nd Avenue NE&lt;/street&gt;
            &lt;city&gt;Redmond&lt;/city&gt;
            &lt;state&gt;WA&lt;/state&gt;
            &lt;zip&gt;98052&lt;/zip&gt;
        &lt;/address&gt;
        &lt;phone location="work"&gt;(425)555-5665&lt;/phone&gt;
        &lt;phone location="home"&gt;(206)555-5555&lt;/phone&gt;
        &lt;phone location="mobile"&gt;(206)555-4321&lt;/phone&gt;
    &lt;/employee&gt;
&lt;/employees&gt;
</pre>

<p>The second XPath expression does use namespaces. It would match the following payload:
</p><pre>&lt;xq:employees xmlns:xq="http://www.example.com/employees"&gt;
    &lt;employee&gt;
        &lt;name&gt;Fred Jones&lt;/name&gt;
        &lt;address location="home"&gt;
            &lt;street&gt;900 Aurora Ave.&lt;/street&gt;
            &lt;city&gt;Seattle&lt;/city&gt;
            &lt;state&gt;WA&lt;/state&gt;
            &lt;zip&gt;98115&lt;/zip&gt;
        &lt;/address&gt;
        &lt;address location="work"&gt;
            &lt;street&gt;2011 152nd Avenue NE&lt;/street&gt;
            &lt;city&gt;Redmond&lt;/city&gt;
            &lt;state&gt;WA&lt;/state&gt;
            &lt;zip&gt;98052&lt;/zip&gt;
        &lt;/address&gt;
        &lt;phone location="work"&gt;(425)555-5665&lt;/phone&gt;
        &lt;phone location="home"&gt;(206)555-5555&lt;/phone&gt;
        &lt;phone location="mobile"&gt;(206)555-4321&lt;/phone&gt;
    &lt;/employee&gt;
&lt;/xq:employees&gt;
</pre>

<p>Note the different namespace used in the second example.
</p>

<h1>
<a id="user-content-transformation-functions" class="anchor" href="#transformation-functions" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-Transformation_functions"></a><span>Transformation functions</span>
</h1>


<p>Transformation functions are used to alter input data before it is used in matching (i.e., operator execution). The input data is never modified, actually—whenever you request a transformation function to be used, ModSecurity will create a copy of the data, transform it, and then run the operator against the result.
</p>

<dl><dt>Note : There are no default transformation functions, as there were in the first generation of ModSecurity (1.x).</dt></dl>

<p>In the following example, the request parameter values are converted to lowercase before matching:
</p>
<p><code>SecRule ARGS "xp_cmdshell" "t:lowercase,id:91"</code>
</p>
<p>Multiple transformation actions can be used in the same rule, forming a transformation pipeline. The transformations will be performed in the order in which they appear in the rule.
</p>
<p>In most cases, the order in which transformations are performed is very important. In the following example, a series of transformation functions is performed to counter evasion. Performing the transformations in any other order would allow a skillful attacker to evade detection:
</p>
<p><code>SecRule ARGS "(asfunction|javascript|vbscript|data|mocha|livescript):" "id:92,t:none,t:htmlEntityDecode,t:lowercase,t:removeNulls,t:removeWhitespace"</code>
</p>

<dl><dt>Warning : It is currently possible to use SecDefaultAction to specify a default list of transformation functions, which will be applied to all rules that follow the SecDefaultAction directive. However, this practice is not recommended, because it means that mistakes are very easy to make. It is recommended that you always specify the transformation functions that are needed by a particular rule, starting the list with t:none (which clears the possibly inherited transformation functions).</dt></dl>

<p>The remainder of this section documents the transformation functions currently available in ModSecurity.
</p>

<h2>
<a id="user-content-base64decode" class="anchor" href="#base64decode" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-base64Decode"></a><span>base64Decode</span>
</h2>


<p>Decodes a Base64-encoded string.
</p><pre>SecRule REQUEST_HEADERS:Authorization "^Basic ([a-zA-Z0-9]+=*)$" "phase:1,id:93,capture,chain,logdata:%{TX.1}"
  SecRule TX:1 ^(\w+): t:base64Decode,capture,chain
    SecRule TX:1 ^(admin|root|backup)$ 
</pre>

<dl><dt>Note : Be careful when applying base64Decode with other transformations. The order of your transformation matters in this case as certain transformations may change or invalidate the base64 encoded string prior to being decoded (i.e t:lowercase, etc). This of course means that it is also very difficult to write a single rule that checks for a base64decoded value OR an unencoded value with transformations, it is best to write two rules in this situation.</dt></dl>


<h2>
<a id="user-content-sqlhexdecode" class="anchor" href="#sqlhexdecode" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-sqlHexDecode"></a><span>sqlHexDecode</span>
</h2>


<p>Decode sql hex data. Example (0x414243) will be decoded to (ABC). Available as of 2.6.3
</p>

<h2>
<a id="user-content-base64decodeext" class="anchor" href="#base64decodeext" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-base64DecodeExt"></a><span>base64DecodeExt</span>
</h2>


<p>Decodes a Base64-encoded string. Unlike base64Decode, this version uses a forgiving implementation, which ignores invalid characters. Available as of 2.5.13.
</p>
<p>See blog post on Base64Decoding evasion issues on PHP sites - <a href="http://blog.spiderlabs.com/2010/04/impedance-mismatch-and-base64.html">http://blog.spiderlabs.com/2010/04/impedance-mismatch-and-base64.html</a>
</p>

<h2>
<a id="user-content-base64encode" class="anchor" href="#base64encode" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-base64Encode"></a><span>base64Encode</span>
</h2>


<p>Encodes input string using Base64 encoding.
</p>

<h2>
<a id="user-content-cmdline" class="anchor" href="#cmdline" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-cmdLine"></a><span>cmdLine</span>
</h2>



<dl><dt>Note : This is a community contribution developed by Marc Stern <a href="http://www.linkedin.com/in/marcstern">http://www.linkedin.com/in/marcstern</a></dt></dl>
In Windows and Unix, commands may be escaped by different means, such as:




<ul>
<li>c^ommand /c ...</li>
<li>"command" /c ...</li>
<li>command,/c ...</li>
<li>backslash in the middle of a Unix command</li>
</ul>
The cmdLine transformation function avoids this problem by manipulating the variable contend in the following ways:









<ul>
<li>deleting all backslashes [\]</li>
<li>deleting all double quotes ["]</li>
<li>deleting all sigle quotes [']</li>
<li>deleting all carets [^]</li>
<li>deleting spaces before a slash <a href="/">/</a></li>
<li>deleting spaces before an open parentesis [(]</li>
<li>replacing all commas [,] and semicolon [;] into a space</li>
<li>replacing all multiple spaces (including tab, newline, etc.) into one space</li>
<li>transform all characters to lowercase</li>
</ul>

<p><b>Example Usage:</b>
</p><pre>SecRule ARGS "(?:command(?:.com)?|cmd(?:.exe)?)(?:/.*)?/[ck]" "phase:2,id:94,t:none, t:cmdLine"
</pre>


<h2>
<a id="user-content-compresswhitespace" class="anchor" href="#compresswhitespace" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-compressWhitespace"></a><span>compressWhitespace</span>
</h2>


<p>Converts any of the whitespace characters (0x20, \f, \t, \n, \r, \v, 0xa0) to spaces (ASCII 0x20), compressing multiple consecutive space characters into one.
</p>

<h2>
<a id="user-content-cssdecode" class="anchor" href="#cssdecode" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-cssDecode"></a><span>cssDecode</span>
</h2>


<p>Decodes characters encoded using the CSS 2.x escape rules <a href="http://www.w3.org/TR/CSS2/">syndata.html#characters</a>. This function uses only up to two bytes in the decoding process, meaning that it is useful to uncover ASCII characters encoded using CSS encoding (that wouldn’t normally be encoded), or to counter evasion, which is a combination of a backslash and non-hexadecimal characters (e.g., ja\vascript is equivalent to javascript).
</p>

<h2>
<a id="user-content-escapeseqdecode" class="anchor" href="#escapeseqdecode" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-escapeSeqDecode"></a><span>escapeSeqDecode</span>
</h2>


<p>Decodes ANSI C escape sequences: \a, \b, \f, \n, \r, \t, \v, \\, \?, \', \", \xHH (hexadecimal), \0OOO (octal). Invalid encodings are left in the output.
</p>

<h2>
<a id="user-content-hexdecode" class="anchor" href="#hexdecode" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-hexDecode"></a><span>hexDecode</span>
</h2>


<p>Decodes a string that has been encoded using the same algorithm as the one used in hexEncode (see following entry).
</p>

<h2>
<a id="user-content-hexencode" class="anchor" href="#hexencode" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-hexEncode"></a><span>hexEncode</span>
</h2>


<p>Encodes string (possibly containing binary characters) by replacing each input byte with two hexadecimal characters. For example, xyz is encoded as 78797a.
</p>

<h2>
<a id="user-content-htmlentitydecode" class="anchor" href="#htmlentitydecode" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-htmlEntityDecode"></a><span>htmlEntityDecode</span>
</h2>


<p>Decodes the characters encoded as HTML entities. The following variants are supported: 






</p><ul>
<li>HH and HH; (where H is any hexadecimal number)</li>
<li>DDD and DDD; (where D is any decimal number) </li>
<li>&amp;quotand" </li>
<li>&amp;nbspand  </li>
<li>&amp;ltand&lt;</li>
<li>&amp;gtand&gt;</li>
</ul>

<p>This function always converts one HTML entity into one byte, possibly resulting in a loss of information (if the entity refers to a character that cannot be represented with the single byte). It is thus useful to uncover bytes that would otherwise not need to be encoded, but it cannot do anything meaningful with the characters from the range above 0xff.
</p>

<h2>
<a id="user-content-jsdecode" class="anchor" href="#jsdecode" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-jsDecode"></a><span>jsDecode</span>
</h2>


<p>Decodes JavaScript escape sequences. If a \uHHHH code is in the range of FF01-FF5E (the full width ASCII codes), then the higher byte is used to detect and adjust the lower byte. Otherwise, only the lower byte will be used and the higher byte zeroed (leading to possible loss of information).
</p>

<h2>
<a id="user-content-length" class="anchor" href="#length" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-length"></a><span>length</span>
</h2>


<p>Looks up the length of the input string in bytes, placing it (as string) in output. For example, if it gets ABCDE on input, this transformation function will return 5 on output.
</p>

<h2>
<a id="user-content-lowercase" class="anchor" href="#lowercase" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-lowercase"></a><span>lowercase</span>
</h2>


<p>Converts all characters to lowercase using the current C locale.
</p>

<h2>
<a id="user-content-md5" class="anchor" href="#md5" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-md5"></a><span>md5</span>
</h2>


<p>Calculates an MD5 hash from the data in input. The computed hash is in a raw binary form and may need encoded into text to be printed (or logged). Hash functions are commonly used in combination with hexEncode (for example: t:md5,t:hexEncode).
</p>
<pre></pre>


<h2>
<a id="user-content-none" class="anchor" href="#none" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-none"></a><span>none</span>
</h2>


<p>Not an actual transformation function, but an instruction to ModSecurity to remove all transformation functions associated with the current rule.
</p>

<h2>
<a id="user-content-normalisepath" class="anchor" href="#normalisepath" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-normalisePath"></a><span>normalisePath</span>
</h2>


<p>See normalizePath.
</p>

<h2>
<a id="user-content-normalizepath" class="anchor" href="#normalizepath" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-normalizePath"></a><span>normalizePath</span>
</h2>


<p>Removes multiple slashes, directory self-references, and directory back-references (except when at the beginning of the input) from input string.

</p><dl><dt>Note : As of 2010 normalisePath has been renamed to normalizePath (MODSEC-103). NormalisePath is kept for backwards compatibility in current versions, but should not be used.</dt></dl>


<h2>
<a id="user-content-normalisepathwin" class="anchor" href="#normalisepathwin" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-normalisePathWin"></a><span>normalisePathWin</span>
</h2>


<p>See normalizePathWin.
</p>

<h2>
<a id="user-content-normalizepathwin" class="anchor" href="#normalizepathwin" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-normalizePathWin"></a><span>normalizePathWin</span>
</h2>


<p>Same as normalizePath, but first converts backslash characters to forward slashes.

</p><dl><dt>Note : As of 2010 normalisePathWin has been renamed to normalizePathWin (MODSEC-103). NormalisePathWin  is kept for backwards compatibility in current versions, but should not be used.</dt></dl>


<h2>
<a id="user-content-parityeven7bit" class="anchor" href="#parityeven7bit" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-parityEven7bit"></a><span>parityEven7bit</span>
</h2>


<p>Calculates even parity of 7-bit data replacing the 8th bit of each target byte with the calculated parity bit.
</p>

<h2>
<a id="user-content-parityodd7bit" class="anchor" href="#parityodd7bit" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-parityOdd7bit"></a><span>parityOdd7bit</span>
</h2>


<p>Calculates odd parity of 7-bit data replacing the 8th bit of each target byte with the calculated parity bit.
</p>

<h2>
<a id="user-content-parityzero7bit" class="anchor" href="#parityzero7bit" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-parityZero7bit"></a><span>parityZero7bit</span>
</h2>


<p>Calculates zero parity of 7-bit data replacing the 8th bit of each target byte with a zero-parity bit, which allows inspection of even/odd parity 7-bit data as ASCII7 data.
</p>

<h2>
<a id="user-content-removenulls" class="anchor" href="#removenulls" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-removeNulls"></a><span>removeNulls</span>
</h2>


<p>Removes all NUL bytes from input.
</p>

<h2>
<a id="user-content-removewhitespace" class="anchor" href="#removewhitespace" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-removeWhitespace"></a><span>removeWhitespace</span>
</h2>


<p>Removes all whitespace characters from input.
</p>

<h2>
<a id="user-content-replacecomments" class="anchor" href="#replacecomments" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-replaceComments"></a><span>replaceComments</span>
</h2>


<p>Replaces each occurrence of a C-style comment (/* ... */) with a single space (multiple consecutive occurrences of which will not be compressed). Unterminated comments will also be replaced with a space (ASCII 0x20). However, a standalone termination of a comment (*/) will not be acted upon.
</p>

<h2>
<a id="user-content-removecommentschar" class="anchor" href="#removecommentschar" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-removeCommentsChar"></a><span>removeCommentsChar</span>
</h2>


<p>Removes common comments chars (/*, */, --, #).
</p>

<h2>
<a id="user-content-removecomments" class="anchor" href="#removecomments" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-removeComments"></a><span>removeComments</span>
</h2>



<p><b>Version:</b> 2.x-3.x(pre)
</p>
<p><b>Supported on libModSecurity:</b> Yes
</p>
<p>Removes each occurrence of comment (/* ... */, --, #). Multiple consecutive occurrences of which will not be compressed.
</p>

<dl><dt>Note : <b>This transformation is known to be unreliable, might cause some unexpected behaviour and could be deprecated soon in a future release. Refer to issue <a href="https://github.com/SpiderLabs/ModSecurity/issues/1207">#1207</a> for further information.</b>.</dt></dl>


<h2>
<a id="user-content-replacenulls" class="anchor" href="#replacenulls" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-replaceNulls"></a><span>replaceNulls</span>
</h2>


<p>Replaces NUL bytes in input with space characters (ASCII 0x20).
</p>

<h2>
<a id="user-content-urldecode" class="anchor" href="#urldecode" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-urlDecode"></a><span>urlDecode</span>
</h2>


<p>Decodes a URL-encoded input string. Invalid encodings (i.e., the ones that use non-hexadecimal characters, or the ones that are at the end of string and have one or two bytes missing) are not converted, but no error is raised. To detect invalid encodings, use the @validateUrlEncoding operator on the input data first. The transformation function should not be used against variables that have already been URL-decoded (such as request parameters) unless it is your intention to perform URL decoding twice!
</p>

<h2>
<a id="user-content-uppercase" class="anchor" href="#uppercase" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-uppercase"></a><span>uppercase</span>
</h2>


<p>Converts all characters to uppercase using the current C locale.
</p>
<p><b>Version:</b> 3.0(pre)
</p>
<p><b>Supported on libModSecurity:</b> Yes
</p>

<h2>
<a id="user-content-urldecodeuni" class="anchor" href="#urldecodeuni" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-urlDecodeUni"></a><span>urlDecodeUni</span>
</h2>


<p>Like urlDecode, but with support for the Microsoft-specific %u encoding. If the code is in the range of FF01-FF5E (the full-width ASCII codes), then the higher byte is used to detect and adjust the lower byte. Otherwise, only the lower byte will be used and the higher byte zeroed.
</p>

<h2>
<a id="user-content-urlencode" class="anchor" href="#urlencode" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-urlEncode"></a><span>urlEncode</span>
</h2>


<p>Encodes input string using URL encoding.
</p>

<h2>
<a id="user-content-utf8tounicode" class="anchor" href="#utf8tounicode" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-utf8toUnicode"></a><span>utf8toUnicode</span>
</h2>


<p>Converts all UTF-8 characters sequences to Unicode. This help input normalization specially for non-english languages minimizing false-positives and false-negatives. (available with 2.7.0)
</p>

<h2>
<a id="user-content-sha1" class="anchor" href="#sha1" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-sha1"></a><span>sha1</span>
</h2>


<p>Calculates a SHA1 hash from the input string. The computed hash is in a raw binary form and may need encoded into text to be printed (or logged). Hash functions are commonly used in combination with hexEncode (for example, t:sha1,t:hexEncode).
</p>

<h2>
<a id="user-content-trimleft" class="anchor" href="#trimleft" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-trimLeft"></a><span>trimLeft</span>
</h2>


<p>Removes whitespace from the left side of the input string.
</p>

<h2>
<a id="user-content-trimright" class="anchor" href="#trimright" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-trimRight"></a><span>trimRight</span>
</h2>


<p>Removes whitespace from the right side of the input string.
</p>

<h2>
<a id="user-content-trim" class="anchor" href="#trim" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-trim"></a><span>trim</span>
</h2>


<p>Removes whitespace from both the left and right sides of the input string.
</p>

<h1>
<a id="user-content-actions" class="anchor" href="#actions" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-Actions"></a><span>Actions</span>
</h1>


<p>Each action belongs to one of five groups:






</p><ul><li>
<b>Disruptive actions</b> - Cause ModSecurity to do something. In many cases something means block transaction, but not in all. For example, the allow action is classified as a disruptive action, but it does the opposite of blocking. There can only be one disruptive action per rule (if there are multiple disruptive actions present, or inherited, only the last one will take effect), or rule chain (in a chain, a disruptive action can only appear in the first rule).</li></ul><dl><dt>Note : <b>Disruptive actions will NOT be executed if the SecRuleEngine is set to DetectionOnly</b>.  If you are creating exception/whitelisting rules that use the allow action, you should also add the ctl:ruleEngine=On action to execute the action.</dt></dl><ul>
<li>
<b>Non-disruptive action</b>s - Do something, but that something does not and cannot affect the rule processing flow. Setting a variable, or changing its value is an example of a non-disruptive action. Non-disruptive action can appear in any rule, including each rule belonging to a chain.</li>
<li>
<b>Flow actions</b> - These actions affect the rule flow (for example skip or skipAfter).</li>
<li>
<b>Meta-data actions</b> - Meta-data actions are used to provide more information about rules. Examples include id, rev, severity and msg.</li>
<li>
<b>Data actions</b> - Not really actions, these are mere containers that hold data used by other actions. For example, the status action holds the status that will be used for blocking (if it takes place).</li>
</ul>


<h2>
<a id="user-content-accuracy" class="anchor" href="#accuracy" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-accuracy"></a><span>accuracy</span>
</h2>


<p><b>Description:</b> Specifies the relative accuracy level of the rule related to false positives/negatives.  The value is a string based on a numeric scale (1-9 where 9 is very strong and 1 has many false positives).
</p>
<p><b>Action Group:</b> Meta-data
</p>
<p><b>Version:</b> 2.7
</p>
<p><b>Example:</b>
</p><pre>SecRule REQUEST_FILENAME|ARGS_NAMES|ARGS|XML:/* "\bgetparentfolder\b" \
	"phase:2,ver:'CRS/2.2.4,accuracy:'9',maturity:'9',capture,t:none,t:htmlEntityDecode,t:compressWhiteSpace,t:lowercase,ctl:auditLogParts=+E,block,msg:'Cross-site Scripting (XSS) Attack',id:'958016',tag:'WEB_ATTACK/XSS',tag:'WASCTC/WASC-8',tag:'WASCTC/WASC-22',tag:'OWASP_TOP_10/A2',tag:'OWASP_AppSensor/IE1',tag:'PCI/6.5.1',logdata:'% \
{TX.0}',severity:'2',setvar:'tx.msg=%{rule.msg}',setvar:tx.xss_score=+%{tx.critical_anomaly_score},setvar:tx.anomaly_score=+%{tx.critical_anomaly_score},setvar:tx.%{rule.id}-WEB_ATTACK/XSS-%{matched_var_name}=%{tx.0}"
</pre>


<h2>
<a id="user-content-allow" class="anchor" href="#allow" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-allow"></a><span>allow</span>
</h2>


<p><b>Description:</b> Stops rule processing on a successful match and allows the transaction to proceed.
</p>
<p><b>Action Group:</b> Disruptive
</p>
<p>Example:
</p><pre># Allow unrestricted access from 192.168.1.100 
SecRule REMOTE_ADDR "^192\.168\.1\.100$" phase:1,id:95,nolog,allow
</pre>


<p>Prior to ModSecurity 2.5 the allow action would only affect the current phase. An allow in phase 1 would skip processing the remaining rules in phase 1 but the rules from phase 2 would execute. Starting with v2.5.0 allow was enhanced to allow for fine-grained control of what is done. The following rules now apply:



</p><ol>
<li>If used one its own, like in the example above, allow will affect the entire transaction, stopping processing of the current phase but also skipping over all other phases apart from the logging phase. (The logging phase is special; it is designed to always execute.)</li>
<li>If used with parameter "phase", allow will cause the engine to stop processing the current phase. Other phases will continue as normal.</li>
<li>If used with parameter "request", allow will cause the engine to stop processing the current phase. The next phase to be processed will be phase RESPONSE_HEADERS.</li>
</ol>

<p>Examples:
</p><pre># Do not process request but process response.
SecAction phase:1,allow:request,id:96

# Do not process transaction (request and response).
SecAction phase:1,allow,id:97
</pre>

<p>If you want to allow a response through, put a rule in phase RESPONSE_HEADERS and simply use allow on its own:
</p><pre># Allow response through.
SecAction phase:3,allow,id:98
</pre>


<h2>
<a id="user-content-append" class="anchor" href="#append" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-append"></a><span>append</span>
</h2>


<p><b>Description</b>: Appends text given as parameter to the end of response body. Content injection must be en- abled (using the SecContentInjection directive). No content type checks are made, which means that before using any of the content injection actions, you must check whether the content type of the response is adequate for injection.
</p>
<p><b>Version:</b> 2.x-2.9.x
</p>
<p><b>Supported on libModSecurity:</b> No
</p>
<p><b>Action Group:</b> Non-disruptive
</p>
<p><b>Processing Phases:</b> 3 and 4.
</p>
<p>Example:
</p>
<pre>SecRule RESPONSE_CONTENT_TYPE "^text/html" "nolog,id:99,pass,append:'&lt;hr&gt;Footer'"</pre>


<dl><dt>Warning : Although macro expansion is allowed in the additional content, you are strongly cau- tioned against inserting user-defined data fields into output. Doing so would create a cross-site scripting vulnerability.</dt></dl>


<h2>
<a id="user-content-auditlog" class="anchor" href="#auditlog" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-auditlog"></a><span>auditlog</span>
</h2>


<p><b>Description:</b> Marks the transaction for logging in the audit log.
</p>
<p><b>Action Group</b>: Non-disruptive
</p>
<p>Example:
</p>
<p><code>SecRule REMOTE_ADDR "^192\.168\.1\.100$" auditlog,phase:1,id:100,allow</code>
</p>

<dl><dt>Note : The auditlog action is now explicit if log is already specified.</dt></dl>


<h2>
<a id="user-content-block" class="anchor" href="#block" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-block"></a><span>block</span>
</h2>


<p><b>Description:</b> Performs the disruptive action defined by the previous SecDefaultAction.
</p>
<p><b>Action Group:</b> Disruptive
</p>
<p>This action is essentially a placeholder that is intended to be used by rule writers to request a blocking action, but without specifying how the blocking is to be done. The idea is that such decisions are best left to rule users, as well as to allow users, to override blocking if they so desire. 
In future versions of ModSecurity, more control and functionality will be added to define "how" to block.
</p>
<p>Examples:
</p><pre># Specify how blocking is to be done 
SecDefaultAction phase:2,deny,id:101,status:403,log,auditlog

# Detect attacks where we want to block 
SecRule ARGS attack1 phase:2,block,id:102

# Detect attacks where we want only to warn 
SecRule ARGS attack2 phase:2,pass,id:103
</pre>

<p>It is possible to use the SecRuleUpdateActionById directive to override how a rule handles blocking. This is useful in three cases:



</p><ol>
<li>If a rule has blocking hard-coded, and you want it to use the policy you determine </li>
<li>If a rule was written to block, but you want it to only warn </li>
<li>If a rule was written to only warn, but you want it to block</li>
</ol>

<p>The following example demonstrates the first case, in which the hard-coded block is removed in favor of the user-controllable block:
</p><pre># Specify how blocking is to be done 
SecDefaultAction phase:2,deny,status:403,log,auditlog,id:104

# Detect attacks and block 
SecRule ARGS attack1 phase:2,id:1,deny

# Change how rule ID 1 blocks 
SecRuleUpdateActionById 1 block
</pre>


<h2>
<a id="user-content-capture" class="anchor" href="#capture" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-capture"></a><span>capture</span>
</h2>


<p><b>Description:</b> When used together with the regular expression operator (@rx), the capture action will create copies of the regular expression captures and place them into the transaction variable collection.
</p>
<p><b>Action Group:</b> Non-disruptive
</p>
<p>Example:
</p><pre>SecRule REQUEST_BODY "^username=(\w{25,})" phase:2,capture,t:none,chain,id:105
  SecRule TX:1 "(?:(?:a(dmin|nonymous)))"
</pre>

<p>Up to 10 captures will be copied on a successful pattern match, each with a name consisting of a digit from 0 to 9. The TX.0 variable always contains the entire area that the regular expression matched. All the other variables contain the captured values, in the order in which the capturing parentheses appear in the regular expression.
</p>

<h2>
<a id="user-content-chain" class="anchor" href="#chain" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-chain"></a><span>chain</span>
</h2>


<p><b>Description:</b> Chains the current rule with the rule that immediately follows it, creating a rule chain. Chained rules allow for more complex processing logic.
</p>
<p><b>Action Group:</b> Flow
</p>
<p>Example:
</p><pre># Refuse to accept POST requests that do not contain Content-Length header. 
# (Do note that this rule should be preceded by a rule 
# that verifies only valid request methods are used.) 
SecRule REQUEST_METHOD "^POST$" phase:1,chain,t:none,id:105
  SecRule &amp;REQUEST_HEADERS:Content-Length "@eq 0" t:none
</pre>


<dl><dt>Note : Rule chains allow you to simulate logical AND. The disruptive actions specified in the first portion of the chained rule will be triggered only if all of the variable checks return positive hits. If any one aspect of a chained rule comes back negative, then the entire rule chain will fail to match. Also note that disruptive actions, execution phases, metadata actions (id, rev, msg, tag, severity, logdata), skip, and skipAfter actions can be specified only by the chain starter rule.</dt></dl>

<p>The following directives can be used in rule chains: 



</p><ul>
<li>SecAction</li>
<li>SecRule</li>
<li>SecRuleScript </li>
</ul>
Special rules control the usage of actions in chained rules:



<ul>
<li>Any actions that affect the rule flow (i.e., the disruptive actions, skip and skipAfter) can be used only in the chain starter. They will be executed only if the entire chain matches.</li>
<li>Non-disruptive rules can be used in any rule; they will be executed if the rule that contains them matches and not only when the entire chain matches.</li>
<li>The metadata actions (e.g., id, rev, msg) can be used only in the chain starter.</li>
</ul>


<h2>
<a id="user-content-ctl" class="anchor" href="#ctl" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-ctl"></a><span>ctl</span>
</h2>


<p><b>Description</b>: Changes ModSecurity configuration on transient, per-transaction basis. Any changes made using this action will affect only the transaction in which the action is executed. The default configuration, as well as the other transactions running in parallel, will be unaffected.
</p>
<p><b>Action Group:</b> Non-disruptive
</p>
<p><b>Example:</b>
</p><pre># Parse requests with Content-Type "text/xml" as XML 
SecRule REQUEST_CONTENT_TYPE ^text/xml "nolog,pass,id:106,ctl:requestBodyProcessor=XML"

# white-list the user parameter for rule #981260 when the REQUEST_URI is /index.php
SecRule REQUEST_URI "@beginsWith /index.php" "phase:1,t:none,pass, \
  nolog,ctl:ruleRemoveTargetById=981260;ARGS:user
</pre>

<p>The following configuration options are supported: 


















</p><ol>
<li>
<b>auditEngine</b> (Supported on libModSecurity: TBI)</li>
<li>
<b>auditLogParts</b> </li>
<li>
<b>debugLogLevel</b> (Supported on libModSecurity: TBI)</li>
<li>
<b>forceRequestBodyVariable</b> (Supported on libModSecurity: TBI)</li>
<li>
<b>requestBodyAccess</b> </li>
<li>
<b>requestBodyLimit</b> (Supported on libModSecurity: TBI)</li>
<li>
<b>requestBodyProcessor</b> </li>
<li>
<b>responseBodyAccess</b> (Supported on libModSecurity: TBI)</li>
<li>
<b>responseBodyLimit</b> (Supported on libModSecurity: TBI)</li>
<li>
<b>ruleEngine</b> (Supported on libModSecurity: YES)</li>
<li>
<b>ruleRemoveById</b> - since this action us triggered at run time, it should be specified <b>before</b> the rule in which it is disabling.</li>
<li>
<b>ruleRemoveByMsg</b> (Supported on libModSecurity: TBI)</li>
<li>
<b>ruleRemoveByTag</b> (Supported on libModSecurity: TBI)</li>
<li>
<b>ruleRemoveTargetById</b> - since this action is used to just remove targets, users don't need to use the char ! before the target list. </li>
<li>
<b>ruleRemoveTargetByMsg</b> - since this action is used to just remove targets, users don't need to use the char ! before the target list. (Supported on libModSecurity: TBI)</li>
<li>
<b>ruleRemoveTargetByTag</b> - since this action is used to just remove targets, users don't need to use the char ! before the target list.</li>
<li>
<b>hashEngine</b> (Supported on libModSecurity: TBI)</li>
<li>
<b>hashEnforcement</b> (Supported on libModSecurity: TBI)</li>
</ol>

<p>With the exception of the requestBodyProcessor and forceRequestBodyVariable settings, each configuration option corresponds to one configuration directive and the usage is identical.
</p>
<p>The requestBodyProcessor option allows you to configure the request body processor. By default, ModSecurity will use the URLENCODED and MULTIPART processors to process an application/x-www-form-urlencoded and a multipart/form-data body, respectively. Other two processors are also supported: JSON and XML, but they are never used implicitly. Instead, you must tell ModSecurity to use it by placing a few rules in the REQUEST_HEADERS processing phase. After the request body is processed as XML, you will be able to use the XML-related features to inspect it.
</p>
<p>Request body processors will not interrupt a transaction if an error occurs during parsing. Instead, they will set the variables REQBODY_PROCESSOR_ERROR and REQBODY_PROCESSOR_ERROR_MSG. These variables should be inspected in the REQUEST_BODY phase and an appropriate action taken.
The forceRequestBodyVariable option allows you to configure the REQUEST_BODY variable to be set when there is no request body processor configured. This allows for inspection of request bodies of unknown types.
</p>

<dl><dt>Note : There was a ctl:ruleUpdateTargetById introduced in 2.6.0 and removed from the code in 2.7.0. JSON was added as part of v2.8.0-rc1</dt></dl>


<h2>
<a id="user-content-deny" class="anchor" href="#deny" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-deny"></a><span>deny</span>
</h2>


<p><b>Description:</b> Stops rule processing and intercepts transaction.
</p>
<p><b>Action Group:</b> Disruptive
</p>
<p>Example:
<code>SecRule REQUEST_HEADERS:User-Agent "nikto" "log,deny,id:107,msg:'Nikto Scanners Identified'"</code>
</p>

<h2>
<a id="user-content-deprecatevar" class="anchor" href="#deprecatevar" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-deprecatevar"></a><span>deprecatevar</span>
</h2>


<p><b>Description</b>: Decrements numerical value over time, which makes sense only applied to the variables stored in persistent storage.
</p>
<p><b>Version:</b> 2.x
</p>
<p><b>Supported on libModSecurity:</b> TBI
</p>
<p><b>Action Group:</b> Non-Disruptive
</p>
<p>Example: The following example will decrement the counter by 60 every 300 seconds.
</p><pre>SecAction phase:5,id:108,nolog,pass,deprecatevar:SESSION.score=60/300
</pre>

<p>Counter values are always positive, meaning that the value will never go below zero. Unlike expirevar, the deprecate action must be executed on every request.
</p>

<h2>
<a id="user-content-drop" class="anchor" href="#drop" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-drop"></a><span>drop</span>
</h2>


<p><b>Description:</b> Initiates an immediate close of the TCP connection by sending a FIN packet.
</p>
<p><b>Version:</b> 2.x
</p>
<p><b>Supported on libModSecurity:</b> TBI
</p>
<p><b>Action Group:</b> Disruptive
</p>
<p><b>Example:</b> The following example initiates an IP collection for tracking Basic Authentication attempts. If the client goes over the threshold of more than 25 attempts in 2 minutes, it will DROP subsequent connections.
</p><pre>SecAction phase:1,id:109,initcol:ip=%{REMOTE_ADDR},nolog
SecRule ARGS:login "!^$" "nolog,phase:1,id:110,setvar:ip.auth_attempt=+1,deprecatevar:ip.auth_attempt=25/120"
SecRule IP:AUTH_ATTEMPT "@gt 25" "log,drop,phase:1,id:111,msg:'Possible Brute Force Attack'"
</pre>


<dl><dt>Note : This action is currently not available on Windows based builds. </dt></dl>
This action is extremely useful when responding to both Brute Force and Denial of Service attacks in that, in both cases, you want to minimize both the network bandwidth and the data returned to the client. This action causes error message to appear in the log "(9)Bad file descriptor: core_output_filter: writing data to the network"


<h2>
<a id="user-content-exec" class="anchor" href="#exec" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-exec"></a><span>exec</span>
</h2>


<p><b>Description:</b> Executes an external script/binary supplied as parameter. As of v2.5.0, if the parameter supplied to exec is a Lua script (detected by the .lua extension) the script will be processed internally. This means you will get direct access to the internal request context from the script. Please read the SecRuleScript documentation for more details on how to write Lua scripts.
</p>
<p><b>Action Group:</b> Non-disruptive
</p>
<p><b>Version:</b> 2.x
</p>
<p><b>Supported on libModSecurity:</b> TBI
</p>
<p><b>Example:</b>
</p><pre># Run external program on rule match 
SecRule REQUEST_URI "^/cgi-bin/script\.pl" "phase:2,id:112,t:none,t:lowercase,t:normalizePath,block,\ exec:/usr/local/apache/bin/test.sh"

# Run Lua script on rule match 
SecRule ARGS:p attack "phase:2,id:113,block,exec:/usr/local/apache/conf/exec.lua"
</pre>
<p>The exec action is executed independently from any disruptive actions specified. External scripts will always be called with no parameters. Some transaction information will be placed in environment variables. All the usual CGI environment variables will be there. You should be aware that forking a threaded process results in all threads being replicated in the new process. Forking can therefore incur larger overhead in a multithreaded deployment. The script you execute must write something (anything) to stdout; if it doesn’t, ModSecurity will assume that the script failed, and will record the failure.
</p>

<h2>
<a id="user-content-expirevar" class="anchor" href="#expirevar" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-expirevar"></a><span>expirevar</span>
</h2>


<p><b>Description:</b> Configures a collection variable to expire after the given time period (in seconds).
</p>
<p><b>Version:</b> 2.x
</p>
<p><b>Supported on libModSecurity:</b> TBI
</p>
<p><b>Action Group:</b> Non-disruptive
</p>
<p><b>Example:</b>
</p><pre>SecRule REQUEST_COOKIES:JSESSIONID "!^$" "nolog,phase:1,id:114,pass,setsid:%{REQUEST_COOKIES:JSESSIONID}"
SecRule REQUEST_URI "^/cgi-bin/script\.pl" "phase:2,id:115,t:none,t:lowercase,t:normalizePath,log,allow,setvar:session.suspicious=1,expirevar:session.suspicious=3600,phase:1"
</pre>

<p>You should use the expirevar actions at the same time that you use setvar actions in order to keep the intended expiration time. If they are used on their own (perhaps in a SecAction directive), the expire time will be reset.
</p>

<h2>
<a id="user-content-id" class="anchor" href="#id" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-id"></a><span>id</span>
</h2>


<p><b>Description</b>: Assigns a unique ID to the rule or chain in which it appears. Starting with ModSecurity 2.7 this action is mandatory and must be numeric.
</p>
<p><b>Action Group:</b> Meta-data
</p>
<p><b>Example:</b>
</p><pre>SecRule &amp;REQUEST_HEADERS:Host "@eq 0" "log,id:60008,severity:2,msg:'Request Missing a Host Header'"
</pre>


<dl><dt>Note : The id action is required for all SecRule/SecAction directives as of v2.7.0</dt></dl>

<p>These are the reserved ranges:
</p>


















<ul>
<li>1–99,999: reserved for local (internal) use. Use as you see fit, but do not use this range for rules that are distributed to others</li>
<li>100,000–199,999: reserved for rules published by Oracle</li>
<li>200,000–299,999: reserved for rules published Comodo</li>
<li>300,000–399,999: reserved for rules published at gotroot.com</li>
<li>400,000–419,999: unused (available for reservation)</li>
<li>420,000–429,999: reserved for ScallyWhack <a href="http://projects.otaku42.de/wiki/Scally-Whack">http://projects.otaku42.de/wiki/Scally-Whack</a></li>
<li>430,000–439,999: reserved for rules published by Flameeyes <a href="http://www.flameeyes.eu/projects/modsec">http://www.flameeyes.eu/projects/modsec</a> </li>
<li>440.000-599,999: unused (available for reservation)</li>
<li>600,000-699,999: reserved for use by Akamai <a href="http://www.akamai.com/html/solutions/waf.html">http://www.akamai.com/html/solutions/waf.html</a></li>
<li>700,000–799,999: reserved for Ivan Ristic</li>
<li>900,000–999,999: reserved for the OWASP ModSecurity Core Rule Set <a href="http://www.owasp.org/index.php/Category:OWASP_ModSecurity_Core_Rule_Set_Project">http://www.owasp.org/index.php/Category:OWASP_ModSecurity_Core_Rule_Set_Project</a> project</li>
<li>1,000,000-1,009,999: reserved for rules published by Redhat Security Team</li>
<li>1,010,000-1,999,999: unused (available for reservation)</li>
<li>2,000,000-2,999,999: reserved for rules from Trustwave's SpiderLabs Research team</li>
<li>3,000,000-3,999,999: reserved for use by Akamai <a href="http://www.akamai.com/html/solutions/waf.html">http://www.akamai.com/html/solutions/waf.html</a></li>
<li>4,000,000-4,099,999 reserved: in use by AviNetworks <a href="https://kb.avinetworks.com/docs/latest/vantage-web-app-firewall-beta/">https://kb.avinetworks.com/docs/latest/vantage-web-app-firewall-beta/</a></li>
<li>4,100,000-4,199,999 reserved: in use by Fastly <a href="https://www.fastly.com/products/cloud-security/#products-cloud-security-web-application-firewall">https://www.fastly.com/products/cloud-security/#products-cloud-security-web-application-firewall</a></li>
<li>4,200,000 and above: unused (available for reservation)</li>
</ul>



<h2>
<a id="user-content-initcol" class="anchor" href="#initcol" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-initcol"></a><span>initcol</span>
</h2>


<p><b>Description:</b> Initializes a named persistent collection, either by loading data from storage or by creating a new collection in memory.
</p>
<p><b>Action Group:</b> Non-disruptive
</p>
<p><b>Example:</b> The following example initiates IP address tracking, which is best done in phase 1:
</p><pre>SecAction phase:1,id:116,nolog,pass,initcol:ip=%{REMOTE_ADDR}
</pre>

<p>Collections are loaded into memory on-demand, when the initcol action is executed. A collection will be persisted only if a change was made to it in the course of transaction processing.
</p>
<p>See the "Persistent Storage" section for further details.
</p>

<h2>
<a id="user-content-log" class="anchor" href="#log" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-log"></a><span>log</span>
</h2>


<p><b>Description:</b> Indicates that a successful match of the rule needs to be logged.
</p>
<p><b>Action Group:</b> Non-disruptive
</p>
<p><b>Example:</b>
</p><pre>SecAction phase:1,id:117,pass,initcol:ip=%{REMOTE_ADDR},log
</pre>

<p>This action will log matches to the Apache error log file and the ModSecurity audit log.
</p>

<h2>
<a id="user-content-logdata" class="anchor" href="#logdata" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-logdata"></a><span>logdata</span>
</h2>


<p><b>Description:</b> Logs a data fragment as part of the alert message.
</p>
<p><b>Action Group:</b> Non-disruptive
</p>
<p><b>Example:</b>
</p><pre>SecRule ARGS:p "@rx &lt;script&gt;" "phase:2,id:118,log,pass,logdata:%{MATCHED_VAR}"
</pre>

<p>The logdata information appears in the error and/or audit log files. Macro expansion is performed, so you may use variable names such as %{TX.0} or %{MATCHED_VAR}. The information is properly escaped for use with logging of binary data.
</p>

<h2>
<a id="user-content-maturity" class="anchor" href="#maturity" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-maturity"></a><span>maturity</span>
</h2>


<p><b>Description:</b> Specifies the relative maturity level of the rule related to the length of time a rule has been public and the amount of testing it has received.  The value is a string based on a numeric scale (1-9 where 9 is extensively tested and 1 is a brand new experimental rule).
</p>
<p><b>Action Group:</b> Meta-data
</p>
<p><b>Version:</b> 2.7
</p>
<p><b>Example:</b>
</p><pre>SecRule REQUEST_FILENAME|ARGS_NAMES|ARGS|XML:/* "\bgetparentfolder\b" \
	"phase:2,ver:'CRS/2.2.4,accuracy:'9',maturity:'9',capture,t:none,t:htmlEntityDecode,t:compressWhiteSpace,t:lowercase,ctl:auditLogParts=+E,block,msg:'Cross-site Scripting (XSS) Attack',id:'958016',tag:'WEB_ATTACK/XSS',tag:'WASCTC/WASC-8',tag:'WASCTC/WASC-22',tag:'OWASP_TOP_10/A2',tag:'OWASP_AppSensor/IE1',tag:'PCI/6.5.1',logdata:'% \
{TX.0}',severity:'2',setvar:'tx.msg=%{rule.msg}',setvar:tx.xss_score=+%{tx.critical_anomaly_score},setvar:tx.anomaly_score=+%{tx.critical_anomaly_score},setvar:tx.%{rule.id}-WEB_ATTACK/XSS-%{matched_var_name}=%{tx.0}"
</pre>


<h2>
<a id="user-content-msg" class="anchor" href="#msg" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-msg"></a><span>msg</span>
</h2>


<p><b>Description:</b> Assigns a custom message to the rule or chain in which it appears. The message will be logged along with every alert.
</p>
<p><b>Action Group:</b> Meta-data
</p>
<p><b>Example:</b>
</p><pre>SecRule &amp;REQUEST_HEADERS:Host "@eq 0" "log,id:60008,severity:2,msg:'Request Missing a Host Header'"
</pre>


<dl><dt>Note : The msg information appears in the error and/or audit log files and is not sent back to the client in response headers.</dt></dl>


<h2>
<a id="user-content-multimatch" class="anchor" href="#multimatch" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-multiMatch"></a><span>multiMatch</span>
</h2>


<p><b>Description:</b> If enabled, ModSecurity will perform multiple operator invocations for every target, before and after every anti-evasion transformation is performed.
</p>
<p><b>Action Group:</b> Non-disruptive
</p>
<p><b>Example:</b>
</p><pre>SecRule ARGS "attack" "phase1,log,deny,id:119,t:removeNulls,t:lowercase,multiMatch"
</pre>

<p>Normally, variables are inspected only once per rule, and only after all transformation functions have been completed. With multiMatch, variables are checked against the operator before and after every transformation function that changes the input.
</p>

<h2>
<a id="user-content-noauditlog" class="anchor" href="#noauditlog" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-noauditlog"></a><span>noauditlog</span>
</h2>


<p><b>Description:</b> Indicates that a successful match of the rule should not be used as criteria to determine whether the transaction should be logged to the audit log.
</p>
<p><b>Action Group:</b> Non-disruptive
</p>
<p><b>Example:</b>
</p><pre>SecRule REQUEST_HEADERS:User-Agent "Test" allow,noauditlog,id:120
</pre>

<p>If the SecAuditEngine is set to On, all of the transactions will be logged. If it is set to RelevantOnly, then you can control the logging with the noauditlog action.
</p>
<p>The noauditlog action affects only the current rule. If you prevent audit logging in one rule only, a match in another rule will still cause audit logging to take place. If you want to prevent audit logging from taking place, regardless of whether any rule matches, use ctl:auditEngine=Off.
</p>

<h2>
<a id="user-content-nolog" class="anchor" href="#nolog" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-nolog"></a><span>nolog</span>
</h2>


<p><b>Description:</b> Prevents rule matches from appearing in both the error and audit logs.
</p>
<p><b>Action Group:</b> Non-disruptive
</p>
<p><b>Example:</b>
</p><pre>SecRule REQUEST_HEADERS:User-Agent "Test" allow,nolog,id:121
</pre>

<p>Although nolog implies noauditlog, you can override the former by using nolog,auditlog.
</p>

<h2>
<a id="user-content-pass" class="anchor" href="#pass" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-pass"></a><span>pass</span>
</h2>


<p><b>Description:</b> Continues processing with the next rule in spite of a successful match.
</p>
<p><b>Action Group:</b> Disruptive
</p>
<p><b>Example:</b>
</p><pre>SecRule REQUEST_HEADERS:User-Agent "Test" "log,pass,id:122"
</pre>

<p>When using pass with a SecRule with multiple targets, all variables will be inspected and all non-disruptive actions trigger for every match. In the following example, the TX.test variable will be incremented once for every request parameter:
</p><pre># Set TX.test to zero 
SecAction "phase:2,nolog,pass,setvar:TX.test=0,id:123"

# Increment TX.test for every request parameter 
SecRule ARGS "test" "phase:2,log,pass,setvar:TX.test=+1,id:124"
</pre>


<h2>
<a id="user-content-pause" class="anchor" href="#pause" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-pause"></a><span>pause</span>
</h2>


<p><b>Description:</b> Pauses transaction processing for the specified number of milliseconds. Starting with ModSecurity 2.7 this feature also supports macro expansion.
</p>
<p><b>Version:</b> 2.x
</p>
<p><b>Supported on libModSecurity:</b> TBI
</p>
<p><b>Action Group:</b> Disruptive
</p>
<p><b>Example:</b>
</p><pre>SecRule REQUEST_HEADERS:User-Agent "Test" "log,pause:5000,id:125"
</pre>


<dl><dt>Warning : This feature can be of limited benefit for slowing down brute force authentication attacks, but use with care. If you are under a denial of service attack, the pause feature may make matters worse, as it will cause an entire Apache worker (process or thread, depending on the deployment mode) to sit idle until the pause is completed.</dt></dl>


<h2>
<a id="user-content-phase" class="anchor" href="#phase" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-phase"></a><span>phase</span>
</h2>


<p><b>Description</b>: Places the rule or chain into one of five available processing phases. It can also be used in SecDefaultAction to establish the rule defaults.
</p>
<p><b>Action Group:</b> Meta-data
</p>
<p><b>Example:</b>
</p><pre># Initialize IP address tracking in phase 1
SecAction phase:1,nolog,pass,id:126,initcol:IP=%{REMOTE_ADDR}
</pre>

<p>Starting in ModSecurity version v2.7 there are aliases for some phase numbers:



</p><ul>
<li>
<b>2 - request</b></li>
<li>
<b>4 - response</b></li>
<li>
<b>5 - logging</b></li>
</ul>

<p><b>Example:</b>
</p><pre>SecRule REQUEST_HEADERS:User-Agent "Test" "phase:request,log,deny,id:127"
</pre>


<dl><dt>Warning : Keep in mind that if you specify the incorrect phase, the variable used in the rule may not yet be available. This could lead to a false negative situation where your variable and operator may be correct, but it misses malicious data because you specified the wrong phase.</dt></dl>


<h2>
<a id="user-content-prepend" class="anchor" href="#prepend" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-prepend"></a><span>prepend</span>
</h2>


<p><b>Description:</b> Prepends the text given as parameter to response body. Content injection must be enabled (using the SecContentInjection directive). No content type checks are made, which means that before using any of the content injection actions, you must check whether the content type of the response is adequate for injection.
</p>
<p><b>Version:</b> 2.x
</p>
<p><b>Supported on libModSecurity:</b> TBI
</p>
<p><b>Action Group:</b> Non-disruptive
</p>
<p><b>Processing Phases:</b> 3 and 4.
</p>
<p><b>Example:</b>
</p><pre>SecRule RESPONSE_CONTENT_TYPE ^text/html \ "phase:3,nolog,pass,id:128,prepend:'Header&lt;br&gt;'"
</pre>


<dl><dt>Warning : Although macro expansion is allowed in the injected content, you are strongly cautioned against inserting user defined data fields int output. Doing so would create a cross-site scripting vulnerability.</dt></dl>


<h2>
<a id="user-content-proxy" class="anchor" href="#proxy" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-proxy"></a><span>proxy</span>
</h2>


<p><b>Description:</b> Intercepts the current transaction by forwarding the request to another web server using the proxy backend. The forwarding is carried out transparently to the HTTP client (i.e., there’s no external redirection taking place).
</p>
<p><b>Version:</b> 2.x
</p>
<p><b>Supported on libModSecurity:</b> TBI
</p>
<p><b>Action Group:</b> Disruptive
</p>
<p><b>Example:</b>
</p><pre>SecRule REQUEST_HEADERS:User-Agent "Test" log,id:129,proxy:http://honeypothost/
SecRule REQUEST_URI "@streq /test.txt" "phase:1,proxy:'[nocanon]http://$ENV{SERVER_NAME}:$ENV{SERVER_PORT}/test.txt',id:500005"
</pre>

<p>For this action to work, mod_proxy must also be installed. This action is useful if you would like to proxy matching requests onto a honeypot web server, and especially in combination with IP address or session tracking.
</p>

<dl><dt>Note: As of v2.9.1 the proxy action can receive a special parameter named "[nocanon]". The "[nocanon]" parameter will make the url to be delivered to the backend on its original format (raw). Further information about "nocanon" is available here: <a href="https://httpd.apache.org/docs/2.2/pt-br/mod/mod_proxy.html">https://httpd.apache.org/docs/2.2/pt-br/mod/mod_proxy.html</a>.</dt></dl>


<h2>
<a id="user-content-redirect" class="anchor" href="#redirect" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-redirect"></a><span>redirect</span>
</h2>


<p><b>Description:</b> Intercepts transaction by issuing an external (client-visible) redirection to the given location..
</p>
<p><b>Action Group:</b> Disruptive
</p>
<p><b>Example:</b>
</p><pre>SecRule REQUEST_HEADERS:User-Agent "Test" "phase:1,id:130,log,redirect:http://www.example.com/failed.html"
</pre>

<p>If the status action is present on the same rule, and its value can be used for a redirection (i.e., is one of the following: 301, 302, 303, or 307), the value will be used for the redirection status code. Otherwise, status code 302 will be used.
</p>

<h2>
<a id="user-content-rev" class="anchor" href="#rev" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-rev"></a><span>rev</span>
</h2>


<p><b>Description:</b> Specifies rule revision. It is useful in combination with the id action to provide an indication that a rule has been changed.
</p>
<p><b>Action Group:</b> Meta-data
</p>
<p><b>Example:</b>
</p><pre>SecRule REQUEST_FILENAME|ARGS_NAMES|ARGS|XML:/* "(?:(?:[\;\|\`]\W*?\bcc|\b(wget|curl))\b|\/cc(?:[\'\"\|\;\`\-\s]|$))" \
	                "phase:2,rev:'2.1.3',capture,t:none,t:normalizePath,t:lowercase,ctl:auditLogParts=+E,block,msg:'System Command Injection',id:'950907',tag:'WEB_ATTACK/COMMAND_INJECTION',tag:'WASCTC/WASC-31',tag:'OWASP_TOP_10/A1',tag:'PCI/6.5.2',logdata:'%{TX.0}',severity:'2',setvar:'tx.msg=%{rule.msg}',setvar:tx.anomaly_score=+%{tx.critical_anomaly_score},setvar:tx.command_injection_score=+%{tx.critical_anomaly_score},setvar:tx.%{rule.id}-WEB_ATTACK/COMMAND_INJECTION-%{matched_var_name}=%{tx.0},skipAfter:END_COMMAND_INJECTION1"
</pre>


<dl><dt>Note : This action is used in combination with the id action to allow the same rule ID to be used after changes take place but to still provide some indication the rule changed.</dt></dl>


<h2>
<a id="user-content-sanitisearg" class="anchor" href="#sanitisearg" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-sanitiseArg"></a><span>sanitiseArg</span>
</h2>


<p><b>Description:</b> Prevents sensitive request parameter data from being logged to audit log. Each byte of the named parameter(s) is replaced with an asterisk.
</p>
<p><b>Version:</b> 2.x
</p>
<p><b>Supported on libModSecurity:</b> TBI
</p>
<p><b>Action Group:</b> Non-disruptive
</p>
<p><b>Example:</b>
</p><pre># Never log passwords 
SecAction "nolog,phase:2,id:131,sanitiseArg:password,sanitiseArg:newPassword,sanitiseArg:oldPassword"
</pre>


<dl><dt>Note : The sanitize actions affect only the data as it is logged to audit log. High-level debug logs may contain sensitive data. Apache access log may contain sensitive data placed in the request URI.</dt></dl>


<h2>
<a id="user-content-sanitisematched" class="anchor" href="#sanitisematched" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-sanitiseMatched"></a><span>sanitiseMatched</span>
</h2>


<p><b>Description:</b> Prevents the matched variable (request argument, request header, or response header) from being logged to audit log. Each byte of the named parameter(s) is replaced with an asterisk.
</p>
<p><b>Version:</b> 2.x
</p>
<p><b>Supported on libModSecurity:</b> TBI
</p>
<p><b>Action Group:</b> Non-disruptive
</p>
<p><b>Example:</b> This action can be used to sanitise arbitrary transaction elements when they match a condition. For example, the example below will sanitise any argument that contains the word password in the name.
</p><pre>SecRule ARGS_NAMES password nolog,pass,id:132,sanitiseMatched
</pre>


<dl><dt>Note : The sanitize actions affect only the data as it is logged to audit log. High-level debug logs may contain sensitive data. Apache access log may contain sensitive data placed in the request URI.</dt></dl>


<h2>
<a id="user-content-sanitisematchedbytes" class="anchor" href="#sanitisematchedbytes" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-sanitiseMatchedBytes"></a><span>sanitiseMatchedBytes</span>
</h2>


<p><b>Description:</b> Prevents the matched string in a variable from being logged to audit log. Each or a range of bytes of the named parameter(s) is replaced with an asterisk.
</p>
<p><b>Version:</b> 2.x
</p>
<p><b>Supported on libModSecurity:</b> TBI
</p>
<p><b>Action Group:</b> Non-disruptive
</p>
<p><b>Example:</b> This action can be used to sanitise arbitrary transaction elements when they match a condition. For example, the example below will sanitise the credit card number.


</p><ul>
<li>sanitiseMatchedBytes -- This would x out only the bytes that matched.</li>
<li>sanitiseMatchedBytes:1/4 -- This would x out the bytes that matched, but keep the first byte and last 4 bytes</li>
</ul>
<pre># Detect credit card numbers in parameters and 
# prevent them from being logged to audit log 
SecRule ARGS "@verifyCC \d{13,16}" "phase:2,id:133,nolog,capture,pass,msg:'Potential credit card number in request',sanitiseMatchedBytes"
SecRule RESPONSE_BODY "@verifyCC \d{13,16}" "phase:4,id:134,t:none,log,capture,block,msg:'Potential credit card number is response body',sanitiseMatchedBytes:0/4"
</pre>


<dl><dt>Note : The sanitize actions affect only the data as it is logged to audit log. High-level debug logs may contain sensitive data. Apache access log may contain sensitive data placed in the request URI. You must use capture action with sanitiseMatchedBytes, so the operator must support capture action. ie: @rx, @verifyCC.</dt></dl>


<h2>
<a id="user-content-sanitiserequestheader" class="anchor" href="#sanitiserequestheader" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-sanitiseRequestHeader"></a><span>sanitiseRequestHeader</span>
</h2>


<p><b>Description:</b> Prevents a named request header from being logged to audit log. Each byte of the named request header is replaced with an asterisk..
</p>
<p><b>Version:</b> 2.x
</p>
<p><b>Supported on libModSecurity:</b> TBI
</p>
<p><b>Action Group:</b> Non-disruptive
</p>
<p><b>Example:</b> This will sanitise the data in the Authorization header.
</p><pre>SecAction "phase:1,nolog,pass,id:135,sanitiseRequestHeader:Authorization"
</pre>


<dl><dt>Note : The sanitize actions affect only the data as it is logged to audit log. High-level debug logs may contain sensitive data. Apache access log may contain sensitive data placed in the request URI.</dt></dl>


<h2>
<a id="user-content-sanitiseresponseheader" class="anchor" href="#sanitiseresponseheader" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-sanitiseResponseHeader"></a><span>sanitiseResponseHeader</span>
</h2>


<p><b>Description:</b> Prevents a named response header from being logged to audit log. Each byte of the named response header is replaced with an asterisk.
</p>
<p><b>Version:</b> 2.x
</p>
<p><b>Supported on libModSecurity:</b> TBI
</p>
<p><b>Action Group:</b> Non-disruptive
</p>
<p><b>Example:</b> This will sanitise the Set-Cookie data sent to the client.
</p><pre>SecAction "phase:3,nolog,pass,id:136,sanitiseResponseHeader:Set-Cookie"
</pre>


<dl><dt>Note : The sanitize actions affect only the data as it is logged to audit log. High-level debug logs may contain sensitive data. Apache access log may contain sensitive data placed in the request URI.</dt></dl>


<h2>
<a id="user-content-severity" class="anchor" href="#severity" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-severity"></a><span>severity</span>
</h2>


<p><b>Description:</b> Assigns severity to the rule in which it is used.
</p>
<p><b>Action Group:</b> Meta-data
</p>
<p><b>Example:</b>
</p><pre>SecRule REQUEST_METHOD "^PUT$" "id:340002,rev:1,severity:CRITICAL,msg:'Restricted HTTP function'"
</pre>

<p>Severity values in ModSecurity follows the numeric scale of syslog (where 0 is the most severe).  The data below is used by the OWASP ModSecurity Core Rule Set (CRS):








</p><ul>
<li>
<b>0 - EMERGENCY</b>: is generated from correlation of anomaly scoring data where there is an inbound attack and an outbound leakage.</li>
<li>
<b>1 - ALERT</b>: is generated from correlation where there is an inbound attack and an outbound application level error.</li>
<li>
<b>2 - CRITICAL</b>: Anomaly Score of 5.  Is the highest severity level possible without correlation.  It is normally generated by the web attack rules (40 level files).</li>
<li>
<b>3 - ERROR</b>: Error - Anomaly Score of 4.  Is generated mostly from outbound leakage rules (50 level files).</li>
<li>
<b>4 - WARNING</b>: Anomaly Score of 3.  Is generated by malicious client rules (35 level files).</li>
<li>
<b>5 - NOTICE</b>: Anomaly Score of 2.  Is generated by the Protocol policy and anomaly files.</li>
<li>
<b>6 - INFO</b></li>
<li>
<b>7 - DEBUG</b></li>
</ul>

<p>It is possible to specify severity levels using either the numerical values or the text values, but you should always specify severity levels using the text values, because it is difficult to remember what a number stands for. The use of the numerical values is deprecated as of version 2.5.0 and may be removed in one of the subsequent major updates.
</p>

<h2>
<a id="user-content-setuid" class="anchor" href="#setuid" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-setuid"></a><span>setuid</span>
</h2>


<p><b>Description:</b> Special-purpose action that initializes the USER collection using the username provided as parameter.
</p>
<p><b>Action Group:</b> Non-disruptive
</p>
<p><b>Example:</b>
</p><pre>SecRule ARGS:username ".*" "phase:2,id:137,t:none,pass,nolog,noauditlog,capture,setvar:session.username=%{TX.0},setuid:%{TX.0}"
</pre>

<p>After initialization takes place, the variable USERID will be available for use in the subsequent rules. This action understands application namespaces (configured using SecWebAppId), and will use one if it is configured.
</p>

<h2>
<a id="user-content-setrsc" class="anchor" href="#setrsc" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-setrsc"></a><span>setrsc</span>
</h2>


<p><b>Description:</b> Special-purpose action that initializes the RESOURCE collection using a key provided as parameter.
</p>
<p><b>Action Group:</b> Non-disruptive
</p>
<p><b>Version:</b> 2.x-3.0(pre)
</p>
<p><b>Supported on libModSecurity:</b> Yes - as of 9cb3f2 <a href="https://github.com/SpiderLabs/ModSecurity/commit/9cb3f23b5095cad7dfba8f140a44b9523f2be78b">https://github.com/SpiderLabs/ModSecurity/commit/9cb3f23b5095cad7dfba8f140a44b9523f2be78b</a>
</p>
<p><b>Example:</b>
</p><pre>SecAction "phase:1,pass,id:3,log,setrsc:'abcd1234'"
</pre>

<p>This action understands application namespaces (configured using SecWebAppId), and will use one if it is configured.
</p>

<h2>
<a id="user-content-setsid" class="anchor" href="#setsid" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-setsid"></a><span>setsid</span>
</h2>


<p><b>Description:</b> Special-purpose action that initializes the SESSION collection using the session token provided as parameter.
</p>
<p><b>Action Group:</b> Non-disruptive
</p>
<p><b>Example:</b>
</p><pre># Initialise session variables using the session cookie value 
SecRule REQUEST_COOKIES:PHPSESSID !^$ "nolog,pass,id:138,setsid:%{REQUEST_COOKIES.PHPSESSID}"
</pre>
Note

<p>After the initialization takes place, the variable SESSION will be available for use in the subsequent rules. This action understands application namespaces (configured using SecWebAppId), and will use one if it is configured.
</p>
<p>Setsid takes an individual variable, not a collection. Variables within an action, such as setsid, use the format [collection].[variable] .
</p>


<h2>
<a id="user-content-setenv" class="anchor" href="#setenv" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-setenv"></a><span>setenv</span>
</h2>


<p><b>Description:</b> Creates, removes, and updates environment variables that can be accessed by Apache.
</p>
<p><b>Action Group:</b> Non-disruptive
</p>
<p><b>Version:</b> 2.x
</p>
<p><b>Supported on libModSecurity:</b> TBI
</p>
<p><b>Examples:</b>
</p><pre>SecRule RESPONSE_HEADERS:/Set-Cookie2?/ "(?i:(j?sessionid|(php)?sessid|(asp|jserv|jw)?session[-_]?(id)?|cf(id|token)|sid))" "phase:3,t:none,pass,id:139,nolog,setvar:tx.sessionid=%{matched_var}"
SecRule TX:SESSIONID "!(?i:\;? ?httponly;?)" "phase:3,id:140,t:none,setenv:httponly_cookie=%{matched_var},pass,log,auditlog,msg:'AppDefect: Missing HttpOnly Cookie Flag.'"

Header set Set-Cookie "%{httponly_cookie}e; HTTPOnly" env=httponly_cookie
</pre>


<dl><dt>Note : When used in a chain this action will be execute when an individual rule matches and not the entire chain.</dt></dl>


<h2>
<a id="user-content-setvar" class="anchor" href="#setvar" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-setvar"></a><span>setvar</span>
</h2>


<p><b>Description:</b> Creates, removes, or updates a variable. Variable names are case-insensitive.
</p>
<p><b>Action Group:</b> Non-disruptive
</p>
<p><b>Examples:</b>
To create a variable and set its value to 1 (usually used for setting flags), use: <code>setvar:TX.score</code>
</p>
<p>To create a variable and initialize it at the same time, use: <code>setvar:TX.score=10</code>
</p>
<p>To remove a variable, prefix the name with an exclamation mark: <code>setvar:!TX.score</code>
</p>
<p>To increase or decrease variable value, use + and - characters in front of a numerical value: <code>setvar:TX.score=+5</code>
</p>
<p>Example from OWASP CRS:
</p><pre>SecRule REQUEST_FILENAME|ARGS_NAMES|ARGS|XML:/* "\bsys\.user_catalog\b" \
		"phase:2,rev:'2.1.3',capture,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:lowercase,t:replaceComments,t:compressWhiteSpace,ctl:auditLogParts=+E, \
block,msg:'Blind SQL Injection Attack',id:'959517',tag:'WEB_ATTACK/SQL_INJECTION',tag:'WASCTC/WASC-19',tag:'OWASP_TOP_10/A1',tag:'OWASP_AppSensor/CIE1', \
tag:'PCI/6.5.2',logdata:'%{TX.0}',severity:'2',setvar:'tx.msg=%{rule.msg}',setvar:tx.sql_injection_score=+%{tx.critical_anomaly_score}, \
setvar:tx.anomaly_score=+%{tx.critical_anomaly_score},setvar:tx.%{rule.id}-WEB_ATTACK/SQL_INJECTION-%{matched_var_name}=%{tx.0}"
</pre>


<dl><dt>Note : When used in a chain this action will be executed when an individual rule matches and not the entire chain.This means that </dt></dl>

<pre lang=""><code>SecRule REQUEST_FILENAME "@contains /test.php" "chain,id:7,phase:1,t:none,nolog,setvar:tx.auth_attempt=+1" 
    SecRule ARGS_POST:action "@streq login" "t:none"</code></pre>


<dl><dt>will increment every time that test.php is visited (regardless of the parameters submitted). If the desired goal is to set the variable only if the entire rule matches, it should be included in the last rule of the chain . For instance: </dt></dl>

<pre lang=""><code>SecRule REQUEST_FILENAME "@streq test.php" "chain,id:7,phase:1,t:none,nolog"
    SecRule ARGS_POST:action "@streq login" "t:none,setvar:tx.auth_attempt=+1"</code></pre>


<h2>
<a id="user-content-skip" class="anchor" href="#skip" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-skip"></a><span>skip</span>
</h2>


<p><b>Description:</b> Skips one or more rules (or chains) on successful match.
</p>
<p><b>Action Group:</b> Flow
</p>
<p><b>Example:</b>
</p><pre># Require Accept header, but not from access from the localhost 
SecRule REMOTE_ADDR "^127\.0\.0\.1$" "phase:1,skip:1,id:141" 

# This rule will be skipped over when REMOTE_ADDR is 127.0.0.1 
SecRule &amp;REQUEST_HEADERS:Accept "@eq 0" "phase:1,id:142,deny,msg:'Request Missing an Accept Header'"
</pre>

<p>The skip action works only within the current processing phase and not necessarily in the order in which the rules appear in the configuration file. If you place a phase 2 rule after a phase 1 rule that uses skip, it will not skip over the phase 2 rule. It will skip over the next phase 1 rule that follows it in the phase.
</p>

<h2>
<a id="user-content-skipafter" class="anchor" href="#skipafter" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-skipAfter"></a><span>skipAfter</span>
</h2>


<p>Description: Skips one or more rules (or chains) on a successful match, resuming rule execution with the first rule that follows the rule (or marker created by SecMarker) with the provided ID.
</p>
<p><b>Action Group:</b> Flow
</p>
<p><b>Example:</b> The following rules implement the same logic as the skip example, but using skipAfter:
</p><pre># Require Accept header, but not from access from the localhost 
SecRule REMOTE_ADDR "^127\.0\.0\.1$" "phase:1,id:143,skipAfter:IGNORE_LOCALHOST" 

# This rule will be skipped over when REMOTE_ADDR is 127.0.0.1 
SecRule &amp;REQUEST_HEADERS:Accept "@eq 0" "phase:1,deny,id:144,msg:'Request Missing an Accept Header'" 
SecMarker IGNORE_LOCALHOST
</pre>

<p>Example from the OWASP ModSecurity CRS:
</p><pre>SecMarker BEGIN_HOST_CHECK

	SecRule &amp;REQUEST_HEADERS:Host "@eq 0" \
    		"skipAfter:END_HOST_CHECK,phase:2,rev:'2.1.3',t:none,block,msg:'Request Missing a Host Header',id:'960008',tag:'PROTOCOL_VIOLATION/MISSING_HEADER_HOST',tag:'WASCTC/WASC-21', \
tag:'OWASP_TOP_10/A7',tag:'PCI/6.5.10',severity:'5',setvar:'tx.msg=%{rule.msg}',setvar:tx.anomaly_score=+%{tx.notice_anomaly_score}, \
setvar:tx.protocol_violation_score=+%{tx.notice_anomaly_score},setvar:tx.%{rule.id}-PROTOCOL_VIOLATION/MISSING_HEADER-%{matched_var_name}=%{matched_var}"

	SecRule REQUEST_HEADERS:Host "^$" \
    		"phase:2,rev:'2.1.3',t:none,block,msg:'Request Missing a Host Header',id:'960008',tag:'PROTOCOL_VIOLATION/MISSING_HEADER_HOST',tag:'WASCTC/WASC-21',tag:'OWASP_TOP_10/A7', \
tag:'PCI/6.5.10',severity:'5',setvar:'tx.msg=%{rule.msg}',setvar:tx.anomaly_score=+%{tx.notice_anomaly_score},setvar:tx.protocol_violation_score=+%{tx.notice_anomaly_score}, \
setvar:tx.%{rule.id}-PROTOCOL_VIOLATION/MISSING_HEADER-%{matched_var_name}=%{matched_var}"

SecMarker END_HOST_CHECK
</pre>

<p>The skipAfter action works only within the current processing phase and not necessarily the order in which the rules appear in the configuration file. If you place a phase 2 rule after a phase 1 rule that uses skip, it will not skip over the phase 2 rule. It will skip over the next phase 1 rule that follows it in the phase.
</p>

<h2>
<a id="user-content-status" class="anchor" href="#status" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-status"></a><span>status</span>
</h2>


<p><b>Description:</b> Specifies the response status code to use with actions deny and redirect.
</p>
<p><b>Action Group:</b> Data
</p>
<p><b>Example:</b>
</p><pre># Deny with status 403
SecDefaultAction "phase:1,log,deny,id:145,status:403"
</pre>

<p>Status actions defined in Apache scope locations (such as Directory, Location, etc...) may be superseded by phase:1 action settings. The Apache ErrorDocument directive will be triggered if present in the configuration. Therefore if you have previously defined a custom error page for a given status then it will be executed and its output presented to the user.
</p>

<h2>
<a id="user-content-t" class="anchor" href="#t" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-t"></a><span>t</span>
</h2>


<p><b>Description:</b> This action is used to specify the transformation pipeline to use to transform the value of each variable used in the rule before matching.
</p>
<p><b>Action Group:</b> Non-disruptive
</p>
<p><b>Example:</b>
</p><pre>SecRule ARGS "(asfunction|javascript|vbscript|data|mocha|livescript):" "id:146,t:none,t:htmlEntityDecode,t:lowercase,t:removeNulls,t:removeWhitespace"
</pre>

<p>Any transformation functions that you specify in a SecRule will be added to the previous ones specified in SecDefaultAction. It is recommended that you always use t:none in your rules, which prevents them depending on the default configuration.
</p>

<h2>
<a id="user-content-tag" class="anchor" href="#tag" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-tag"></a><span>tag</span>
</h2>


<p><b>Description:</b> Assigns a tag (category) to a rule or a chain.
</p>
<p><b>Action Group:</b> Meta-data
</p>
<p><b>Example:</b>
</p><pre>SecRule REQUEST_FILENAME|ARGS_NAMES|ARGS|XML:/* "\bgetparentfolder\b" \
	"phase:2,rev:'2.1.3',capture,t:none,t:htmlEntityDecode,t:compressWhiteSpace,t:lowercase,ctl:auditLogParts=+E,block,msg:'Cross-site Scripting (XSS) Attack',id:'958016',tag:'WEB_ATTACK/XSS',tag:'WASCTC/WASC-8',tag:'WASCTC/WASC-22',tag:'OWASP_TOP_10/A2',tag:'OWASP_AppSensor/IE1',tag:'PCI/6.5.1',logdata:'% \
{TX.0}',severity:'2',setvar:'tx.msg=%{rule.msg}',setvar:tx.xss_score=+%{tx.critical_anomaly_score},setvar:tx.anomaly_score=+%{tx.critical_anomaly_score},setvar:tx.%{rule.id}-WEB_ATTACK/XSS-%{matched_var_name}=%{tx.0}"
</pre>

<p>The tag information appears along with other rule metadata. The purpose of the tagging mechanism to allow easy automated categorization of events. Multiple tags can be specified on the same rule. Use forward slashes to create a hierarchy of categories (as in the example). Since ModSecurity 2.6.0 tag supports macro expansion.
</p>

<h2>
<a id="user-content-ver" class="anchor" href="#ver" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-ver"></a><span>ver</span>
</h2>


<p><b>Description:</b> Specifies the rule set version.
</p>
<p><b>Action Group:</b> Meta-data
</p>
<p><b>Version:</b> 2.7
</p>
<p><b>Example:</b>
</p><pre>SecRule REQUEST_FILENAME|ARGS_NAMES|ARGS|XML:/* "\bgetparentfolder\b" \
	"phase:2,ver:'CRS/2.2.4,capture,t:none,t:htmlEntityDecode,t:compressWhiteSpace,t:lowercase,ctl:auditLogParts=+E,block,msg:'Cross-site Scripting (XSS) Attack',id:'958016',tag:'WEB_ATTACK/XSS',tag:'WASCTC/WASC-8',tag:'WASCTC/WASC-22',tag:'OWASP_TOP_10/A2',tag:'OWASP_AppSensor/IE1',tag:'PCI/6.5.1',logdata:'% \
{TX.0}',severity:'2',setvar:'tx.msg=%{rule.msg}',setvar:tx.xss_score=+%{tx.critical_anomaly_score},setvar:tx.anomaly_score=+%{tx.critical_anomaly_score},setvar:tx.%{rule.id}-WEB_ATTACK/XSS-%{matched_var_name}=%{tx.0}"
</pre>


<h2>
<a id="user-content-xmlns" class="anchor" href="#xmlns" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-xmlns"></a><span>xmlns</span>
</h2>


<p><b>Description:</b> Configures an XML namespace, which will be used in the execution of XPath expressions.
</p>
<p><b>Action Group:</b> Data
</p>
<p><b>Example:</b>
</p><pre>SecRule REQUEST_HEADERS:Content-Type "text/xml" "phase:1,id:147,pass,ctl:requestBodyProcessor=XML,ctl:requestBodyAccess=On, \
    xmlns:xsd="http://www.w3.org/2001/XMLSchema"
SecRule XML:/soap:Envelope/soap:Body/q1:getInput/id() "123" phase:2,deny,id:148
</pre>


<h1>
<a id="user-content-operators" class="anchor" href="#operators" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-Operators"></a><span>Operators</span>
</h1>


<p>This section documents the operators currently available in ModSecurity.
</p>

<h2>
<a id="user-content-beginswith" class="anchor" href="#beginswith" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-beginsWith"></a><span>beginsWith</span>
</h2>


<p><b>Description:</b> Returns true if the parameter string is found at the beginning of the input. Macro expansion is performed on the parameter string before comparison.
</p>
<p><b>Example:</b>
</p><pre># Detect request line that does not begin with "GET" 
SecRule REQUEST_LINE "!@beginsWith GET" "id:149"

</pre>


<h2>
<a id="user-content-contains" class="anchor" href="#contains" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-contains"></a><span>contains</span>
</h2>


<p><b>Description:</b> Returns true if the parameter string is found anywhere in the input. Macro expansion is performed on the parameter string before comparison.
</p>
<p><b>Example:</b>
</p><pre># Detect ".php" anywhere in the request line 
SecRule REQUEST_LINE "@contains .php" "id:150"
</pre>


<h2>
<a id="user-content-containsword" class="anchor" href="#containsword" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-containsWord"></a><span>containsWord</span>
</h2>


<p><b>Description:</b> Returns true if the parameter string (with word boundaries) is found anywhere in the input. Macro expansion is performed on the parameter string before comparison.
</p>
<p><b>Example:</b>
</p><pre># Detect "select" anywhere in ARGS 
SecRule ARGS "@containsWord select" "id:151"
</pre>

<p>Would match on - <br>
-1 union <b>select</b> BENCHMARK(2142500,MD5(CHAR(115,113,108,109,97,112))) FROM wp_users WHERE ID=1 and (ascii(substr(user_login,1,1))&amp;0x01=0) from wp_users where ID=1--
</p>
<p>But not on - <br>
Your site has a wide <b>select</b>ion of computers.
</p>

<h2>
<a id="user-content-detectsqli" class="anchor" href="#detectsqli" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-detectSQLi"></a><span>detectSQLi</span>
</h2>


<p><b>Description:</b> Returns true if SQL injection payload is found. This operator uses LibInjection to detect SQLi attacks.
</p>
<p><b>Version:</b> 2.7.4
</p>
<p><b>Example:</b>
</p><pre># Detect SQL Injection inside request uri data" 
SecRule REQUEST_URI "@detectSQLi" "id:152"
</pre>


<dl><dt>Note : This operator supports the "capture" action.</dt></dl>


<h2>
<a id="user-content-detectxss" class="anchor" href="#detectxss" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-detectXSS"></a><span>detectXSS</span>
</h2>


<p><b>Description:</b> Returns true if XSS injection is found. This operator uses LibInjection to detect XSS attacks.
</p>
<p><b>Version:</b> 2.8.0
</p>
<p><b>Example:</b>
</p><pre># Detect XSS Injection inside request body 
SecRule REQUEST_BODY "@detectXSS" "id:12345,log,deny"
</pre>


<h2>
<a id="user-content-endswith" class="anchor" href="#endswith" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-endsWith"></a><span>endsWith</span>
</h2>


<p><b>Description:</b> Returns true if the parameter string is found at the end of the input. Macro expansion is performed on the parameter string before comparison.
</p>
<p><b>Example:</b>
</p><pre># Detect request line that does not end with "HTTP/1.1" 
SecRule REQUEST_LINE "!@endsWith HTTP/1.1" "id:152"
</pre>


<h2>
<a id="user-content-fuzzyhash" class="anchor" href="#fuzzyhash" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-fuzzyHash"></a><span>fuzzyHash</span>
</h2>


<p><b>Description:</b> The fuzzyHash operator uses the ssdeep, which is a program for computing context triggered piecewise hashes (CTPH). Also called fuzzy hashes, CTPH can match inputs that have homologies. Such inputs have sequences of identical bytes in the same order, although bytes in between these sequences may be different in both content and length.
</p>
<p>For further information on ssdeep, visit its site: <a href="http://ssdeep.sourceforge.net/">http://ssdeep.sourceforge.net/</a>
</p>
<p><b>Version:</b> v2.9.0-RC1-2.9.x
</p>
<p><b>Supported on libModSecurity:</b> TBI
</p>
<p><b>Example:</b>
</p><pre>SecRule REQUEST_BODY "\@fuzzyHash /path/to/ssdeep/hashes.txt 6" "id:192372,log,deny"
</pre>


<h2>
<a id="user-content-eq" class="anchor" href="#eq" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-eq"></a><span>eq</span>
</h2>


<p><b>Description:</b> Performs numerical comparison and returns true if the input value is equal to the provided parameter. Macro expansion is performed on the parameter string before comparison.
</p>
<p><b>Example:</b>
</p><pre># Detect exactly 15 request headers 
SecRule &amp;REQUEST_HEADERS_NAMES "@eq 15" "id:153"
</pre>


<dl><dt>Note : If a value is provided that cannot be converted to an integer (i.e a string) this operator will treat that value as 0.</dt></dl>


<h2>
<a id="user-content-ge" class="anchor" href="#ge" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-ge"></a><span>ge</span>
</h2>


<p><b>Description:</b> Performs numerical comparison and returns true if the input value is greater than or equal to the provided parameter. Macro expansion is performed on the parameter string before comparison.
</p>
<p><b>Example:</b>
</p><pre># Detect 15 or more request headers 
SecRule &amp;REQUEST_HEADERS_NAMES "@ge 15" "id:154"
</pre>


<dl><dt>Note : If a value is provided that cannot be converted to an integer (i.e a string) this operator will treat that value as 0.</dt></dl>


<h2>
<a id="user-content-geolookup" class="anchor" href="#geolookup" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-geoLookup"></a><span>geoLookup</span>
</h2>


<p><b>Description:</b> Performs a geolocation lookup using the IP address in input against the geolocation database previously configured using SecGeoLookupDb. If the lookup is successful, the obtained information is captured in the GEO collection.
</p>
<p><b>Example:</b>
The geoLookup operator matches on success and is thus best used in combination with nolog,pass. If you wish to block on a failed lookup (which may be over the top, depending on how accurate the geolocation database is), the following example demonstrates how best to do it:
</p><pre># Configure geolocation database 
SecGeoLookupDb /path/to/GeoLiteCity.dat 
... 
# Lookup IP address 
SecRule REMOTE_ADDR "@geoLookup" "phase:1,id:155,nolog,pass"

# Block IP address for which geolocation failed
 SecRule &amp;GEO "@eq 0" "phase:1,id:156,deny,msg:'Failed to lookup IP'"
</pre>

<p>See the GEO variable for an example and more information on various fields available.
</p>

<h2>
<a id="user-content-gsblookup" class="anchor" href="#gsblookup" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-gsbLookup"></a><span>gsbLookup</span>
</h2>


<p><b>Description:</b> Performs a local lookup of Google's Safe Browsing using URLs in input against the GSB database previously configured using SecGsbLookupDb. When combined with capture operator it will save the matched url into tx.0 variable.
</p>
<p><b>Syntax:</b> <code>SecRule TARGET "@gsbLookup REGEX" ACTIONS</code>
</p>
<p><b>Version:</b> 2.6
</p>
<p><b>Supported on libModSecurity:</b> TBD
</p>
<p><b>Example:</b>
The gsbLookup operator matches on success and is thus best used in combination with a block or redirect action. If you wish to block on successful lookups, the following example demonstrates how best to do it:
</p><pre># Configure Google Safe Browsing database 
SecGsbLookupDb /path/to/GsbMalware.dat 
... 
# Check response bodies for malicious links
SecRule RESPONSE_BODY "@gsbLookup =\"https?\:\/\/(.*?)\"" "phase:4,id:157,capture,log,block,msg:'Bad url detected in RESPONSE_BODY (Google Safe Browsing Check)',logdata:'http://www.google.com/safebrowsing/diagnostic?site=%{tx.0}'"
</pre>


<dl><dt>Note : This operator supports the "capture" action.</dt></dl>


<h2>
<a id="user-content-gt" class="anchor" href="#gt" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-gt"></a><span>gt</span>
</h2>


<p><b>Description:</b> Performs numerical comparison and returns true if the input value is greater than the operator parameter. Macro expansion is performed on the parameter string before comparison.
</p>
<p><b>Example:</b>
</p><pre># Detect more than 15 headers in a request 
SecRule &amp;REQUEST_HEADERS_NAMES "@gt 15" "id:158"
</pre>


<dl><dt>Note : If a value is provided that cannot be converted to an integer (i.e a string) this operator will treat that value as 0.</dt></dl>


<h2>
<a id="user-content-inspectfile" class="anchor" href="#inspectfile" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-inspectFile"></a><span>inspectFile</span>
</h2>


<p><b>Description:</b> Executes an external program for every variable in the target list.  The contents of the variable is provided to the script as the first parameter on the command line. The program must be specified as the first parameter to the operator. As of version 2.5.0, if the supplied program filename is not absolute, it is treated as relative to the directory in which the configuration file resides. Also as of version 2.5.0, if the filename is determined to be a Lua script (based on its .lua extension), the script will be processed by the internal Lua engine. Internally processed scripts will often run faster (there is no process creation overhead) and have full access to the transaction context of ModSecurity.
</p>
<p>The @inspectFile operator was initially designed for file inspection (hence the name), but it can also be used in any situation that requires decision making using external logic.
</p>
<p>The OWASP ModSecurity Core Rule Set (CRS) includes a utility script in the /util directory called runav.pl <a href="http://mod-security.svn.sourceforge.net/viewvc/mod-security/crs/trunk/util/">http://mod-security.svn.sourceforge.net/viewvc/mod-security/crs/trunk/util/</a> that allows the file approval mechanism to integrate with the ClamAV virus scanner. This is especially handy to prevent viruses and exploits from entering the web server through file upload.
</p><pre>#!/usr/bin/perl
#
# runav.pl
# Copyright (c) 2004-2011 Trustwave
#
# This script is an interface between ModSecurity and its
# ability to intercept files being uploaded through the
# web server, and ClamAV


$CLAMSCAN = "clamscan";

if ($#ARGV != 0) {
    print "Usage: runav.pl &lt;filename&gt;\n";
    exit;
}

my ($FILE) = shift @ARGV;

$cmd = "$CLAMSCAN --stdout --no-summary $FILE";
$input = `$cmd`;
$input =~ m/^(.+)/;
$error_message = $1;

$output = "0 Unable to parse clamscan output [$1]";

if ($error_message =~ m/: Empty file\.?$/) {
    $output = "1 empty file";
}
elsif ($error_message =~ m/: (.+) ERROR$/) {
    $output = "0 clamscan: $1";
}
elsif ($error_message =~ m/: (.+) FOUND$/) {
    $output = "0 clamscan: $1";
}
elsif ($error_message =~ m/: OK$/) {
    $output = "1 clamscan: OK";
}

print "$output\n";

</pre>

<p><b>Example:</b>  Using the runav.pl script:
</p><pre># Execute external program to validate uploaded files 
SecRule FILES_TMPNAMES "@inspectFile /path/to/util/runav.pl" "id:159"
</pre>

<p>Example of using Lua script (placed in the same directory as the configuration file):
</p><pre>SecRule FILES_TMPNAMES "@inspectFile inspect.lua" "id:160"
</pre>

<p>The contents of inspect.lua:
</p><pre>function main(filename)
    -- Do something to the file to verify it. In this example, we
    -- read up to 10 characters from the beginning of the file.
    local f = io.open(filename, "rb");
    local d = f:read(10);
    f:close();
   
    -- Return null if there is no reason to believe there is ansything
    -- wrong with the file (no match). Returning any text will be taken
    -- to mean a match should be trigerred.
    return null;
end
</pre>


<dl><dt>Note : Starting in version 2.9 ModSecurity will not fill the FILES_TMPNAMES variable unless SecTmpSaveUploadedFiles directive is On, or the SecUploadKeepFiles directive is set to RelevantOnly.</dt></dl>


<dl><dt>Note: Use @inspectFile with caution. It may not be safe to use @inspectFile with variables other than FILES_TMPNAMES. Other variables such as "FULL_REQUEST" may contains content that force your platform to fork process out of your control, making possible to an attacker to execute code using the same permissions of your web server. For other variables you may want to look at the Lua script engine. This observation was brought to our attention by "Gryzli", on our users mailing list.</dt></dl>

<p><b>Version:</b> 2.x
</p>
<p><b>Supported on libModSecurity:</b> TBI
</p>
<p><b>Reference:</b> <a href="http://blog.spiderlabs.com/2010/10/advanced-topic-of-the-week-preventing-malicious-pdf-file-uploads.html">http://blog.spiderlabs.com/2010/10/advanced-topic-of-the-week-preventing-malicious-pdf-file-uploads.html</a>
</p>
<p><b>Reference:</b> <a href="http://sourceforge.net/p/mod-security/mailman/mod-security-users/?viewmonth=201512">http://sourceforge.net/p/mod-security/mailman/mod-security-users/?viewmonth=201512</a>
</p>

<h2>
<a id="user-content-ipmatch" class="anchor" href="#ipmatch" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-ipMatch"></a><span>ipMatch</span>
</h2>


<p><b>Description:</b> Performs a fast ipv4 or ipv6 match of REMOTE_ADDR variable data.  Can handle the following formats:




</p><ul>
<li>Full IPv4 Address - 192.168.1.100</li>
<li>Network Block/CIDR Address - 192.168.1.0/24</li>
<li>Full IPv6 Address - 2001:db8:85a3:8d3:1319:8a2e:370:7348</li>
<li>Network Block/CIDR Address - 2001:db8:85a3:8d3:1319:8a2e:370:0/24</li>
</ul>

<p><b>Version:</b> 2.7
</p>
<p><b>Examples:</b>
</p>
<p>Individual Address:
</p><pre>SecRule REMOTE_ADDR "@ipMatch 192.168.1.100" "id:161"
</pre>
Multiple Addresses w/network block:
<pre>SecRule REMOTE_ADDR "@ipMatch 192.168.1.100,192.168.1.50,10.10.50.0/24" "id:162"
</pre>


<h2>
<a id="user-content-ipmatchf" class="anchor" href="#ipmatchf" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-ipMatchF"></a><span>ipMatchF</span>
</h2>


<p>short alias for ipMatchFromFile
</p>
<p><b>Version:</b> 2.7
</p>

<h2>
<a id="user-content-ipmatchfromfile" class="anchor" href="#ipmatchfromfile" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-ipMatchFromFile"></a><span>ipMatchFromFile</span>
</h2>


<p><b>Description:</b> Performs a fast ipv4 or ipv6 match of REMOTE_ADDR variable, loading data from a file.  Can handle the following formats:




</p><ul>
<li>Full IPv4 Address - 192.168.1.100</li>
<li>Network Block/CIDR Address - 192.168.1.0/24</li>
<li>Full IPv6 Address - 2001:db8:85a3:8d3:1319:8a2e:370:7348</li>
<li>Network Block/CIDR Address - 2001:db8:85a3:8d3:1319:8a2e:370:0/24</li>
</ul>

<p><b>Version:</b> 2.7
</p>
<p><b>Examples:</b>
</p>
<pre>SecRule REMOTE_ADDR "@ipMatchFromFile ips.txt" "id:163"
</pre>

<p>The file ips.txt may contain:
</p><pre>192.168.0.1
172.16.0.0/16
10.0.0.0/8
</pre>


<dl><dt>Note : As of v2.9.0-RC1 this operator also supports to load content served by an HTTPS server.</dt></dl>


<dl><dt>Note : When used with content served by a HTTPS server, the directive SecRemoteRulesFailAction can be used to configure a warning instead of an abort, when the remote content could not be retrieved.</dt></dl>


<h2>
<a id="user-content-le" class="anchor" href="#le" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-le"></a><span>le</span>
</h2>


<p><b>Description:</b> Performs numerical comparison and returns true if the input value is less than or equal to the operator parameter. Macro expansion is performed on the parameter string before comparison.
</p>
<p><b>Example</b>:
</p><pre># Detect 15 or fewer headers in a request 
SecRule &amp;REQUEST_HEADERS_NAMES "@le 15" "id:164"
</pre>


<dl><dt>Note : If a value is provided that cannot be converted to an integer (i.e a string) this operator will treat that value as 0.</dt></dl>


<h2>
<a id="user-content-lt" class="anchor" href="#lt" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-lt"></a><span>lt</span>
</h2>


<p><b>Description:</b> Performs numerical comparison and returns true if the input value is less than to the operator parameter. Macro expansion is performed on the parameter string before comparison.
</p>
<p><b>Example:</b>
</p><pre># Detect fewer than 15 headers in a request 
SecRule &amp;REQUEST_HEADERS_NAMES "@lt 15" "id:165"
</pre>


<dl><dt>Note : If a value is provided that cannot be converted to an integer (i.e a string) this operator will treat that value as 0.</dt></dl>


<h2>
<a id="user-content-nomatch" class="anchor" href="#nomatch" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-noMatch"></a><span>noMatch</span>
</h2>


<p><b>Description:</b> Will force the rule to always return false.
</p>

<h2>
<a id="user-content-pm" class="anchor" href="#pm" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-pm"></a><span>pm</span>
</h2>


<p><b>Description:</b> Performs a case-insensitive match of the provided phrases against the desired input value. The operator uses a set-based matching algorithm (Aho-Corasick), which means that it will match any number of keywords in parallel. When matching of a large number of keywords is needed, this operator performs much better than a regular expression.
</p>
<p><b>Example:</b>
</p><pre># Detect suspicious client by looking at the user agent identification 
SecRule REQUEST_HEADERS:User-Agent "@pm WebZIP WebCopier Webster WebStripper ... SiteSnagger ProWebWalker CheeseBot" "id:166"
</pre>


<dl><dt>Note : Starting on ModSecurity v2.6.0 this operator supports a snort/suricata content style. ie: "@pm A|42|C|44|F".</dt></dl>


<dl><dt>Note : This operator does not support macro expansion (as of ModSecurity v2.9.1).</dt></dl>


<dl><dt>Note : This operator supports the "capture" action.</dt></dl>


<h2>
<a id="user-content-pmf" class="anchor" href="#pmf" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-pmf"></a><span>pmf</span>
</h2>


<p>Short alias for pmFromFile.
</p>

<h2>
<a id="user-content-pmfromfile" class="anchor" href="#pmfromfile" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-pmFromFile"></a><span>pmFromFile</span>
</h2>


<p><b>Description:</b> Performs a case-insensitive match of the provided phrases against the desired input value. The operator uses a set-based matching algorithm (Aho-Corasick), which means that it will match any number of keywords in parallel. When matching of a large number of keywords is needed, this operator performs much better than a regular expression.
</p>
<p>This operator is the same as @pm, except that it takes a list of files as arguments. It will match any one of the phrases listed in the file(s) anywhere in the target value.
</p>
<p><b>Example:</b>
</p><pre># Detect suspicious user agents using the keywords in 
# the files /path/to/blacklist1 and blacklist2 (the latter 
# must be placed in the same folder as the configuration file) 
SecRule REQUEST_HEADERS:User-Agent "@pmFromFile /path/to/blacklist1 blacklist2" "id:167"
</pre>

<p>Notes:




</p><ol>
<li>Files must contain exactly one phrase per line. End of line markers (both LF and CRLF) will be stripped from each phrase and any whitespace trimmed from both the beginning and the end. Empty lines and comment lines (those beginning with the # character) will be ignored.</li>
<li>To allow easier inclusion of phrase files with rule sets, relative paths may be used to the phrase files. In this case, the path of the file containing the rule is prepended to the phrase file path.</li>
<li>The @pm operator phrases do not support metacharacters.</li>
<li>Because this operator does not check for boundaries when matching, false positives are possible in some cases. For example, if you want to use @pm for IP address matching, the phrase 1.2.3.4 will potentially match more than one IP address (e.g., it will also match 1.2.3.40 or 1.2.3.41). To avoid the false positives, you can use your own boundaries in phrases. For example, use /1.2.3.4/ instead of just 1.2.3.4. Then, in your rules, also add the boundaries where appropriate. You will find a complete example in the example.</li>
</ol>

<pre># Prepare custom REMOTE_ADDR variable 
SecAction "phase:1,id:168,nolog,pass,setvar:tx.REMOTE_ADDR=/%{REMOTE_ADDR}/"

# Check if REMOTE_ADDR is blacklisted 
SecRule TX:REMOTE_ADDR "@pmFromFile blacklist.txt" "phase:1,id:169,deny,msg:'Blacklisted IP address'" 
</pre>

<p>The file blacklist.txt may contain:
</p><pre># ip-blacklist.txt contents:
# NOTE: All IPs must be prefixed/suffixed with "/" as the rules
#   will add in this character as a boundary to ensure
#   the entire IP is matched.
# SecAction "phase:1,id:170,pass,nolog,setvar:tx.remote_addr='/%{REMOTE_ADDR}/'"
/1.2.3.4/ 
/5.6.7.8/
</pre>


<dl><dt>Warning : Before ModSecurity 2.5.12, the @pmFromFile operator understood only the LF line endings and did not trim the whitespace from phrases. If you are using an older version of ModSecurity, you should take care when editing the phrase files to avoid using the undesired characters in patterns.e files should be one phrase per line. End of line markers will be stripped from the phrases (LF and CRLF), and whitespace is trimmed from both sides of the phrases. Empty lines and comment lines (beginning with a '#') are ignored.  To allow easier inclusion of phrase files with rulesets, relative paths may be used to the phrase files. In this case, the path of the file containing the rule is prepended to the phrase file path.</dt></dl>



<dl><dt>Note : Starting on ModSecurity v2.6.0 this operator supports a snort/suricata content style. ie: "A|42|C|44|F".</dt></dl>


<dl><dt>Note II : As of v2.9.0-RC1 this operator also supports to load content served by an HTTPS server. However, only one url can be used at a time.</dt></dl>


<h2>
<a id="user-content-rbl" class="anchor" href="#rbl" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-rbl"></a><span>rbl</span>
</h2>


<p><b>Description:</b> Looks up the input value in the RBL (real-time block list) given as parameter. The parameter can be an IPv4 address or a hostname.
</p>
<p><b>Example:</b>
</p><pre>SecRule REMOTE_ADDR "@rbl sbl-xbl.spamhaus.org" "phase:1,id:171,t:none,pass,nolog,auditlog,msg:'RBL Match for SPAM Source',tag:'AUTOMATION/MALICIOUS',severity:'2',setvar:'tx.msg=%{rule.msg}',setvar:tx.automation_score=+%{tx.warning_anomaly_score},setvar:tx.anomaly_score=+%{tx.warning_anomaly_score}, \
setvar:tx.%{rule.id}-AUTOMATION/MALICIOUS-%{matched_var_name}=%{matched_var},setvar:ip.spammer=1,expirevar:ip.spammer=86400,setvar:ip.previous_rbl_check=1,expirevar:ip.previous_rbl_check=86400,skipAfter:END_RBL_CHECK"
</pre>



<dl>
<dt>Note : If the RBL used is dnsbl.httpbl.org (Honeypot Project RBL) then the SecHttpBlKey directive must specify the user's registered API key.</dt>
<dt>Note : If the RBL used is either multi.uribl.com or zen.spamhaus.org combined RBLs, it is possible to also parse the return codes in the last octet of the DNS response to identify which specific RBL the IP was found in.</dt>
</dl>


<dl><dt>Note : This operator supports the "capture" action.</dt></dl>


<h2>
<a id="user-content-rsub" class="anchor" href="#rsub" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-rsub"></a><span>rsub</span>
</h2>


<p><b>Description</b>: Performs regular expression data substitution when applied to either the STREAM_INPUT_BODY or STREAM_OUTPUT_BODY variables. This operator also supports macro expansion. Starting with ModSecurity 2.7.0 this operator supports the syntax |hex| allowing users to use special chars like \n \r
</p>
<p><b>Syntax:</b> <code>@rsub s/regex/str/[id]</code>
</p>
<p><b>Version:</b> 2.x
</p>
<p><b>Supported on libModSecurity:</b> TBI
</p>
<p><b>Examples:</b>
Removing HTML Comments from response bodies:
</p><pre>SecStreamOutBodyInspection On
SecRule STREAM_OUTPUT_BODY "@rsub s// /" "phase:4,id:172,t:none,nolog,pass"
</pre>


<dl><dt>Note : If you plan to manipulate live data by using @rsub with the STREAM_ variables, you must also enable SecContentInjection directive.</dt></dl>

<p>Regular expressions are handled by the PCRE library <a href="http://www.pcre.org">http://www.pcre.org</a>. ModSecurity compiles its regular expressions with the following settings:



</p><ol>
<li>The entire input is treated as a single line, even when there are newline characters present.</li>
<li>All matches are case-sensitive. If you wish to perform case-insensitive matching, you can either use the lowercase transformation function or force case-insensitive matching by prefixing the regular expression pattern with the (?i) modifier (a PCRE feature; you will find many similar features in the PCRE documentation). Also a flag [d] should be used if you want to escape the regex string chars when use macro expansion.</li>
<li>The PCRE_DOTALL and PCRE_DOLLAR_ENDONLY flags are set during compilation, meaning that a single dot will match any character, including the newlines, and a $ end anchor will not match a trailing newline character.</li>
</ol>

<p>Regular expressions are a very powerful tool. You are strongly advised to read the PCRE documentation to get acquainted with its features.
</p>

<dl><dt>Note : This operator supports the "capture" action.</dt></dl>


<h2>
<a id="user-content-rx" class="anchor" href="#rx" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-rx"></a><span>rx</span>
</h2>


<p><b>Description</b>: Performs a regular expression match of the pattern provided as parameter. <b>This is the default operator; the rules that do not explicitly specify an operator default to @rx</b>.
</p>
<p><b>Examples:</b>
</p><pre># Detect Nikto 
SecRule REQUEST_HEADERS:User-Agent "@rx nikto" phase:1,id:173,t:lowercase

# Detect Nikto with a case-insensitive pattern 
SecRule REQUEST_HEADERS:User-Agent "@rx (?i)nikto" phase:1,id:174,t:none

# Detect Nikto with a case-insensitive pattern 
SecRule REQUEST_HEADERS:User-Agent "(?i)nikto" "id:175"
</pre>

<p>Regular expressions are handled by the PCRE library <a href="http://www.pcre.org">http://www.pcre.org</a>. ModSecurity compiles its regular expressions with the following settings:



</p><ol>
<li>The entire input is treated as a single line, even when there are newline characters present.</li>
<li>All matches are case-sensitive. If you wish to perform case-insensitive matching, you can either use the lowercase transformation function or force case-insensitive matching by prefixing the regular expression pattern with the (?i) modifier (a PCRE feature; you will find many similar features in the PCRE documentation).</li>
<li>The PCRE_DOTALL and PCRE_DOLLAR_ENDONLY flags are set during compilation, meaning that a single dot will match any character, including the newlines, and a $ end anchor will not match a trailing newline character.</li>
</ol>

<p>Regular expressions are a very powerful tool. You are strongly advised to read the PCRE documentation to get acquainted with its features.
</p>

<dl><dt>Note : This operator supports the "capture" action.</dt></dl>


<h2>
<a id="user-content-streq" class="anchor" href="#streq" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-streq"></a><span>streq</span>
</h2>


<p><b>Description:</b> Performs a string comparison and returns true if the parameter string is identical to the input string. Macro expansion is performed on the parameter string before comparison.
</p>
<p><b>Example:</b>
</p><pre># Detect request parameters "foo" that do not # contain "bar", exactly. 
SecRule ARGS:foo "!@streq bar" "id:176"
</pre>


<h2>
<a id="user-content-strmatch" class="anchor" href="#strmatch" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-strmatch"></a><span>strmatch</span>
</h2>


<p><b>Description:</b> Performs a string match of the provided word against the desired input value. The operator uses the  pattern matching Boyer-Moore-Horspool algorithm, which means that it is a single pattern matching operator. This operator performs much better than a regular expression.
</p>
<p><b>Example:</b>
</p><pre># Detect suspicious client by looking at the user agent identification 
SecRule REQUEST_HEADERS:User-Agent "@strmatch WebZIP" "id:177"
</pre>



<dl><dt>Note : Starting on ModSecurity v2.6.0 this operator supports a snort/suricata content style. ie: "@strmatch A|42|C|44|F".</dt></dl>


<h2>
<a id="user-content-unconditionalmatch" class="anchor" href="#unconditionalmatch" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-unconditionalMatch"></a><span>unconditionalMatch</span>
</h2>


<p><b>Description:</b> Will force the rule to always return true. This is similar to SecAction however all actions that occur as a result of a rule matching will fire such as the setting of MATCHED_VAR. This can also be part a chained rule.
</p>
<p><b>Example:</b>
</p><pre>SecRule REMOTE_ADDR "@unconditionalMatch" "id:1000,phase:1,pass,nolog,t:hexEncode,setvar:TX.ip_hash=%{MATCHED_VAR}"
</pre>



<h2>
<a id="user-content-validatebyterange" class="anchor" href="#validatebyterange" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-validateByteRange"></a><span>validateByteRange</span>
</h2>


<p><b>Description:</b> Validates that the byte values used in input fall into the range specified by the operator parameter. This operator matches on an input value that contains bytes that are not in the specified range.
</p>
<p><b>Example:</b>
</p><pre># Enforce very strict byte range for request parameters (only 
# works for the applications that do not use the languages other 
# than English). 
SecRule ARGS "@validateByteRange 10, 13, 32-126" "id:178"
</pre>

<p>The validateByteRange is most useful when used to detect the presence of NUL bytes, which don’t have a legitimate use, but which are often used as an evasion technique.
</p><pre># Do not allow NUL bytes 
SecRule ARGS "@validateByteRange 1-255" "id:179"
</pre>


<dl><dt>Note : You can force requests to consist only of bytes from a certain byte range. This can be useful to avoid stack overflow attacks (since they usually contain "random" binary content). Default range values are 0 and 255, i.e. all byte values are allowed. This directive does not check byte range in a POST payload when multipart/form-data encoding (file upload) is used. Doing so would prevent binary files from being uploaded. However, after the parameters are extracted from such request they are checked for a valid range.</dt></dl>

<p>validateByteRange is similar to the ModSecurity 1.X SecFilterForceByteRange Directive however since it works in a rule context, it has the following differences:



</p><ul>
<li>You can specify a different range for different variables.</li>
<li>It has an "event" context (id, msg....)</li>
<li>It is executed in the flow of rules rather than being a built in pre-check.</li>
</ul>


<h2>
<a id="user-content-validatedtd" class="anchor" href="#validatedtd" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-validateDTD"></a><span>validateDTD</span>
</h2>


<p><b>Description:</b> Validates the XML DOM tree against the supplied DTD. The DOM tree must have been built previously using the XML request body processor. This operator matches when the validation fails.
</p>
<p><b>Example:</b>
</p><pre># Parse the request bodies that contain XML 
SecRule REQUEST_HEADERS:Content-Type ^text/xml$ "phase:1,id:180,nolog,pass,t:lowercase,ctl:requestBodyProcessor=XML"

# Validate XML payload against DTD 
SecRule XML "@validateDTD /path/to/xml.dtd" "phase:2,id:181,deny,msg:'Failed DTD validation'"
</pre>

<p><b>NOTE:</b> You must enable the <code>SecXmlExternalEntity</code> directive.
</p>

<h2>
<a id="user-content-validatehash" class="anchor" href="#validatehash" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-validateHash"></a><span>validateHash</span>
</h2>


<p><b>Description:</b> Validates REQUEST_URI that contains data protected by the hash engine.
</p>
<p><b>Version:</b> 2.x
</p>
<p><b>Supported on libModSecurity:</b> TBI
</p>
<p><b>Example:</b>
</p><pre># Validates requested URI that matches a regular expression.
SecRule REQUEST_URI "@validatehash "product_info|product_list" "phase:1,deny,id:123456"
</pre>


<h2>
<a id="user-content-validateschema" class="anchor" href="#validateschema" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-validateSchema"></a><span>validateSchema</span>
</h2>


<p><b>Description:</b> Validates the XML DOM tree against the supplied XML Schema. The DOM tree must have been built previously using the XML request body processor. This operator matches when the validation fails.
</p>
<p><b>Example:</b>
</p><pre># Parse the request bodies that contain XML 
SecRule REQUEST_HEADERS:Content-Type ^text/xml$ "phase:1,id:190,nolog,pass,t:lowercase,ctl:requestBodyProcessor=XML"

# Validate XML payload against DTD 
SecRule XML "@validateSchema /path/to/xml.xsd" "phase:2,id:191,deny,msg:'Failed DTD validation'"
</pre>

<p><b>NOTE:</b> You must enable the <code>SecXmlExternalEntity</code> directive.
</p>

<h2>
<a id="user-content-validateurlencoding" class="anchor" href="#validateurlencoding" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-validateUrlEncoding"></a><span>validateUrlEncoding</span>
</h2>


<p><b>Description</b>: Validates the URL-encoded characters in the provided input string.
</p>
<p><b>Example:</b>
</p><pre># Validate URL-encoded characters in the request URI 
SecRule REQUEST_URI_RAW "@validateUrlEncoding" "id:192"
</pre>

<p>ModSecurity will automatically decode the URL-encoded characters in request parameters, which means that there is little sense in applying the @validateUrlEncoding operator to them —that is, unless you know that some of the request parameters were URL-encoded more than once. Use this operator against raw input, or against the input that you know is URL-encoded. For example, some applications will URL-encode cookies, although that’s not in the standard. Because it is not in the standard, ModSecurity will neither validate nor decode such encodings.
</p>

<h2>
<a id="user-content-validateutf8encoding" class="anchor" href="#validateutf8encoding" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-validateUtf8Encoding"></a><span>validateUtf8Encoding</span>
</h2>


<p><b>Description:</b> Check whether the input is a valid UTF-8 string.
</p>
<p><b>Example:</b>
</p><pre># Make sure all request parameters contain only valid UTF-8 
SecRule ARGS "@validateUtf8Encoding" "id:193"
</pre>

<p>The @validateUtf8Encoding operator detects the following problems:



</p><dl>
<dt>Not enough bytes : UTF-8 supports two-, three-, four-, five-, and six-byte encodings. ModSecurity will locate cases when one or more bytes is/are missing from a character.</dt>
<dt>Invalid characters : The two most significant bits in most characters should be fixed to 0x80. Some attack techniques use different values as an evasion technique.</dt>
<dt>Overlong characters : ASCII characters are mapped directly into UTF-8, which means that an ASCII character is one UTF-8 character at the same time. However, in UTF-8 many ASCII characters can also be encoded with two, three, four, five, and six bytes. This is no longer legal in the newer versions of Unicode, but many older implementations still support it. The use of overlong UTF-8 characters is common for evasion.</dt>
</dl>




<dl><dt>Notes :</dt></dl><ul>
<li>Most, but not all applications use UTF-8. If you are dealing with an application that does, validating that all request parameters are valid UTF-8 strings is a great way to prevent a number of evasion techniques that use the assorted UTF-8 weaknesses. False positives are likely if you use this operator in an application that does not use UTF-8.</li>
<li>Many web servers will also allow UTF-8 in request URIs. If yours does, you can verify the request URI using @validateUtf8Encoding.</li>
</ul>


<h2>
<a id="user-content-verifycc" class="anchor" href="#verifycc" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-verifyCC"></a><span>verifyCC</span>
</h2>


<p><b>Description:</b> Detects credit card numbers in input. This operator will first use the supplied regular expression to perform an initial match, following up with the Luhn algorithm calculation to minimize false positives.
</p>
<p><b>Example:</b>
</p><pre># Detect credit card numbers in parameters and 
# prevent them from being logged to audit log 
SecRule ARGS "@verifyCC \d{13,16}" "phase:2,id:194,nolog,pass,msg:'Potential credit card number',sanitiseMatched"
</pre>


<dl><dt>Note : This operator supports the "capture" action.</dt></dl>


<h2>
<a id="user-content-verifycpf" class="anchor" href="#verifycpf" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-verifyCPF"></a><span>verifyCPF</span>
</h2>


<p><b>Description:</b> Detects CPF numbers (Brazilian social number) in input. This operator will first use the supplied regular expression to perform an initial match, following up with an algorithm calculation to minimize false positives.
</p>
<p><b>Example:</b>
</p><pre># Detect CPF numbers in parameters and 
# prevent them from being logged to audit log 
SecRule ARGS "@verifyCPF /^([0-9]{3}\.){2}[0-9]{3}-[0-9]{2}$/" "phase:2,id:195,nolog,pass,msg:'Potential CPF number',sanitiseMatched"
</pre>

<p><b>Version:</b> 2.6-3.0(pre)
</p>
<p><b>Supported on libModSecurity:</b> Yes
</p>

<dl><dt>Note : This operator supports the "capture" action.</dt></dl>


<h2>
<a id="user-content-verifyssn" class="anchor" href="#verifyssn" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-verifySSN"></a><span>verifySSN</span>
</h2>


<p><b>Description:</b> Detects US social security numbers (SSN) in input. This operator will first use the supplied regular expression to perform an initial match, following up with an SSN algorithm calculation to minimize false positives.
</p>
<p><b>Example:</b>
</p><pre># Detect social security numbers in parameters and 
# prevent them from being logged to audit log 
SecRule ARGS "@verifySSN \d{3}-?\d{2}-?\d{4}" "phase:2,id:196,nolog,pass,msg:'Potential social security number',sanitiseMatched"
</pre>

<p><b>Version:</b> 2.6-3.0(pre)
</p>
<p><b>Supported on libModSecurity:</b> Yes
</p>
<p><b>SSN Format</b>: 
</p>
<p>A Social Security number is broken up into 3 sections:



</p><ul>
<li>Area (3 digits)</li>
<li>Group (2 digits)</li>
<li>Serial (4 digits)</li>
</ul>

<p><b>verifySSN checks:</b>






</p><ul>
<li>Must have 9 digits </li>
<li>Cannot be a sequence number (ie,, 123456789, 012345678) </li>
<li>Cannot be a repetition sequence number ( ie 11111111 , 222222222) </li>
<li>Cannot have area and/or group and/or serial zeroed sequences </li>
<li>Area code must be less than 740 </li>
<li>Area code must be different then 666</li>
</ul>


<dl><dt>Note : This operator supports the "capture" action.</dt></dl>


<h2>
<a id="user-content-within" class="anchor" href="#within" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-within"></a><span>within</span>
</h2>


<p><b>Description:</b> Returns true if the input value (the needle) is found anywhere within the @within parameter (the haystack). Macro expansion is performed on the parameter string before comparison.
</p>
<p><b>Example:</b>
</p><pre># Detect request methods other than GET, POST and HEAD 
SecRule REQUEST_METHOD "!@within GET,POST,HEAD"
</pre>


<dl><dt>NOTE: There are no delimiters for this operator, it is therefore often necessary to artificially impose some; this can be done using setvar. For instance in the example below, without the imposed delimiters (of '/') this rule would also match on the 'range' header (along with many other combinations), since 'range' is within the provided parameter. With the imposed delimiters, the rule would check for '/range/' when the range header is provided, and therefore would not match since '/range/ is not part of the @within parameter.</dt></dl>

<pre lang=""><code>SecRule REQUEST_HEADERS_NAMES "@rx ^.*$" \
"chain,\
id:1,\
block,\
t:lowercase,\
setvar:'tx.header_name=/%{tx.0}/'"
   SecRule TX:header_name "@within /proxy/ /lock-token/ /content-range/ /translate/ /if/" "t:none"
</code></pre>



<h1>
<a id="user-content-macro-expansion" class="anchor" href="#macro-expansion" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-Macro_Expansion"></a><span>Macro Expansion</span>
</h1>


<p>Macros allow for using place holders in rules that will be expanded out to their values at runtime. Currently only variable expansion is supported, however more options may be added in future versions of ModSecurity.
</p>
<p>Format:
</p><pre>%{VARIABLE}
%{COLLECTION.VARIABLE}
</pre>
Macro expansion can be used in actions such as initcol, setsid, setuid, setvar, setenv, logdata. Operators that are evaluated at runtime support expansion and are noted above. Such operators include @beginsWith, @endsWith, @contains, @within and @streq. You can use macro expansion for operators that are "compiled" such @rx, etc. however you will have some impact in efficiency.

<p>Some values you may want to expand include: TX, REMOTE_ADDR, USERID, HIGHEST_SEVERITY, MATCHED_VAR, MATCHED_VAR_NAME, MULTIPART_STRICT_ERROR, RULE, SESSION, USERID, among others.
</p>

<h1>
<a id="user-content-persistent-storage" class="anchor" href="#persistent-storage" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-Persistent_Storage"></a><span>Persistent Storage</span>
</h1>


<p>At this time it is only possible to have five collections in which data is stored persistently (i.e. data available to multiple requests). These are: GLOBAL, RESOURCE, IP, SESSION and USER.
</p>
<p>Every collection contains several built-in variables that are available and are read-only unless otherwise specified:







</p><ol>
<li>
<b>CREATE_TIME</b> - date/time of the creation of the collection.</li>
<li>
<b>IS_NEW</b> - set to 1 if the collection is new (not yet persisted) otherwise set to 0.</li>
<li>
<b>KEY</b> - the value of the initcol variable (the client's IP address in the example).</li>
<li>
<b>LAST_UPDATE_TIME</b> - date/time of the last update to the collection.</li>
<li>
<b>TIMEOUT</b> - date/time in seconds when the collection will be updated on disk from memory (if no other updates occur). This variable may be set if you wish to specifiy an explicit expiration time (default is 3600 seconds).</li>
<li>
<b>UPDATE_COUNTER</b> - how many times the collection has been updated since creation.</li>
<li>
<b>UPDATE_RATE</b> - is the average rate updates per minute since creation.</li>
</ol>

<p>To create a collection to hold session variables (SESSION) use action setsid. To create a collection to hold user variables (USER) use action setuid. To create a collection to hold client address variables (IP), global data or resource-specific data, use action initcol.
</p>

<dl><dt>Note : Persistent collections can only be initialized once per transaction.</dt></dl>


<dl><dt>Note : ModSecurity implements atomic updates of persistent variables only for integer variables (counters) at this time. Variables are read from storage whenever initcol is encountered in the rules and persisted at the end of request processing. Counters are adjusted by applying a delta generated by re-reading the persisted data just before being persisted. This keeps counter data consistent even if the counter was modified and persisted by another thread/process during the transaction.</dt></dl>


<dl><dt>Note : ModSecurity uses a Berkley Database (SDBM) for persistent storage. This type of database is generally limited to storing a maximum of 1008 bytes per key. This may be a limitation if you are attempting to store a considerable amount of data in variables for a single key. Some of this limitation is planned to be reduced in a future version of ModSecurity.</dt></dl>


<h1>
<a id="user-content-miscellaneous-topics" class="anchor" href="#miscellaneous-topics" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-Miscellaneous_Topics"></a><span>Miscellaneous Topics</span>
</h1>




<h2>
<a id="user-content-logging-in-apache-via-mod_log_config" class="anchor" href="#logging-in-apache-via-mod_log_config" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-Logging_in_Apache_via_mod_log_config"></a><span>Logging in Apache via mod_log_config</span>
</h2>



<p>The ModSecurity variables are accessible from Apache's mod_log_config (-&gt; Apache Access Log). The entries take the form %{VARIABLE}M. Apache writes these logs at the very end of a transaction after the record in the ModSecurity audit log has been written. It is thus possible to log variables, that are only defined after the writing of the audit Log.
</p>
<p>Examples Apache mod_log_config:
</p><pre>LogFormat "%t %{UNIQUE_ID}e %{MULTIPART_STRICT_ERROR}M %{TX.ANOMALY_SCORE}M" custom-format
</pre>


<h2>
<a id="user-content-precedence-of-modsecurity-over-other-apache-modules" class="anchor" href="#precedence-of-modsecurity-over-other-apache-modules" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-Precedence_of_ModSecurity_over_other_Apache_modules"></a><span>Precedence of ModSecurity over other Apache modules</span>
</h2>



<p>ModSecurity rules run in one of five phases. The first two phases are executed as the request is being read, the third and the fourth phase are executed after the response has been generated and the fifth phase when the response has been sent and the logfile has been written.
</p>
<p>The various phases are hooked into the Apache request lifecycle together with the other Apache modules. On each hook, there can be more than one module being executed. This is where precedence comes into play.
</p>
<p>Precedence is assigned at compile time and mostly hard-coded into the ModSecurity source code. The compilation directive --enable-request-early can used to move the processing of the ModSecurity phase 1 to a different hook (see above).
</p>
<p>When examining the response, ModSecurity tries to be as early as possible. For example, the phase 3 and phase 4 will run before mod_headers with its _Header_ directive. However, when calling _Header_ with the keyword _early_, the precedence is raised and the directive is executed before ModSecurity phase 3.
So if you want to edit HTTP response headers with mod_headers (adding the secure-flag to cookies springs to mind), you will usually have to wait until ModSecurity phase 5, before you can examine the effect of the header manipulation with ModSecurity.
</p>
<p>Also see Processing Phases (above).
</p>

<h1>
<a id="user-content-a-recommended-base-configuration" class="anchor" href="#a-recommended-base-configuration" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-A_Recommended_Base_Configuration"></a><span>A Recommended Base Configuration</span>
</h1>



<p>The recommended configuration file which handles the main ModSecurity directives/settings is available at source code archive, labeled as <i>modsecurity.conf-recommended</i>. It is also available at <a href="https://raw.github.com/SpiderLabs/ModSecurity/master/modsecurity.conf-recommended">our git repository</a>. These items listed on this recommended configuration are the items that the Admin should handle and configure for their own site. These settings should not be including within 3rd party rules files.
</p>

<h2>
<a id="user-content-impedance-mismatch" class="anchor" href="#impedance-mismatch" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-Impedance_Mismatch"></a><span>Impedance Mismatch</span>
</h2>


<p>Web application firewalls have a difficult job trying to make sense of data that passes by, without any knowledge of the application and its business logic. The protection they provide comes from having an independent layer of security on the outside. Because data validation is done twice, security can be increased without having to touch the application. In some cases, however, the fact that everything is done twice brings problems. Problems can arise in the areas where the communication protocols are not well specified, or where either the device or the application do things that are not in the specification. In such cases it may be possible to design payload that will be interpreted in one way by one device and in another by the other device. This problem is better known as Impedance Mismatch. It can be exploited to evade the security devices.
</p>
<p>While we will continue to enhance ModSecurity to deal with various evasion techniques the problem can only be minimized, but never solved. With so many different application backend chances are some will always do something completely unexpected. The only solution is to be aware of the technologies in the backend when writing rules, adapting the rules to remove the mismatch. See the next section for some examples.
</p>
<h3>
<a id="user-content-impedance-mismatch-with-php-apps" class="anchor" href="#impedance-mismatch-with-php-apps" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<a name="user-content-Impedance_Mismatch_with_PHP_Apps"></a><span>Impedance Mismatch with PHP Apps</span>
</h3>











<ol>
<li>When writing rules to protect PHP applications you need to pay attention to the following facts:</li>
<li>When "register_globals" is set to "On" request parameters are automatically converted to script variables. In some PHP versions it is even possible to override the $GLOBALS array.</li>
<li>Whitespace at the beginning of parameter names is ignored. (This is very dangerous if you are writing rules to target specific named variables.)</li>
<li>The remaining whitespace (in parameter names) is converted to underscores. The same applies to dots and to a "["]if the variable name does not contain a matching closing bracket. (Meaning that if you want to exploit a script through a variable that contains an underscore in the name you can send a parameter with a whitespace or a dot instead.)</li>
<li>Cookies can be treated as request parameters.</li>
<li>The discussion about variable names applies equally to the cookie names.</li>
<li>The order in which parameters are taken from the request and the environment is EGPCS (environment, GET, POST, Cookies, built-in variables). This means that a POST parameter will overwrite the parameters transported on the request line (in QUERY_STRING).</li>
<li>When "magic_quotes_gpc" is set to "On" PHP will use backslash to escape the following characters: single quote, double quote, backslash, and the nul byte.</li>
<li>If "magic_quotes_sybase" is set to "On" only the single quote will be escaped using another single quote. In this case the "magic_quotes_gpc" setting becomes irrelevant. The "magic_quotes_sybase" setting completely overrides the "magic_quotes_gpc" behaviour but "magic_quotes_gpc" still must be set to "On" for the Sybase-specific quoting to be work.</li>
<li>PHP will also automatically create nested arrays for you. For example "p[x][y]=1" results in a total of three variables.</li>
</ol>

        </div>

    </div>
    </div>
  </div>
  </div>

  </div>
  <div class="modal-backdrop js-touch-events"></div>
</div>


    </div>
  </div>

  </div>

      
<div class="footer container-lg px-3" role="contentinfo">
  <div class="position-relative d-flex flex-justify-between py-6 mt-6 f6 text-gray border-top border-gray-light ">
    <ul class="list-style-none d-flex flex-wrap ">
      <li class="mr-3">&copy; 2017 <span title="0.15768s from unicorn-1089359011-1jfj8">GitHub</span>, Inc.</li>
        <li class="mr-3"><a href="https://github.com/site/terms" data-ga-click="Footer, go to terms, text:terms">Terms</a></li>
        <li class="mr-3"><a href="https://github.com/site/privacy" data-ga-click="Footer, go to privacy, text:privacy">Privacy</a></li>
        <li class="mr-3"><a href="https://github.com/security" data-ga-click="Footer, go to security, text:security">Security</a></li>
        <li class="mr-3"><a href="https://status.github.com/" data-ga-click="Footer, go to status, text:status">Status</a></li>
        <li><a href="https://help.github.com" data-ga-click="Footer, go to help, text:help">Help</a></li>
    </ul>

    <a href="https://github.com" aria-label="Homepage" class="footer-octicon" title="GitHub">
      <svg aria-hidden="true" class="octicon octicon-mark-github" height="24" version="1.1" viewBox="0 0 16 16" width="24"><path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"/></svg>
</a>
    <ul class="list-style-none d-flex flex-wrap ">
        <li class="mr-3"><a href="https://github.com/contact" data-ga-click="Footer, go to contact, text:contact">Contact GitHub</a></li>
      <li class="mr-3"><a href="https://developer.github.com" data-ga-click="Footer, go to api, text:api">API</a></li>
      <li class="mr-3"><a href="https://training.github.com" data-ga-click="Footer, go to training, text:training">Training</a></li>
      <li class="mr-3"><a href="https://shop.github.com" data-ga-click="Footer, go to shop, text:shop">Shop</a></li>
        <li class="mr-3"><a href="https://github.com/blog" data-ga-click="Footer, go to blog, text:blog">Blog</a></li>
        <li><a href="https://github.com/about" data-ga-click="Footer, go to about, text:about">About</a></li>

    </ul>
  </div>
</div>



  <div id="ajax-error-message" class="ajax-error-message flash flash-error">
    <svg aria-hidden="true" class="octicon octicon-alert" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M8.865 1.52c-.18-.31-.51-.5-.87-.5s-.69.19-.87.5L.275 13.5c-.18.31-.18.69 0 1 .19.31.52.5.87.5h13.7c.36 0 .69-.19.86-.5.17-.31.18-.69.01-1L8.865 1.52zM8.995 13h-2v-2h2v2zm0-3h-2V6h2v4z"/></svg>
    <button type="button" class="flash-close js-flash-close js-ajax-error-dismiss" aria-label="Dismiss error">
      <svg aria-hidden="true" class="octicon octicon-x" height="16" version="1.1" viewBox="0 0 12 16" width="12"><path fill-rule="evenodd" d="M7.48 8l3.75 3.75-1.48 1.48L6 9.48l-3.75 3.75-1.48-1.48L4.52 8 .77 4.25l1.48-1.48L6 6.52l3.75-3.75 1.48 1.48z"/></svg>
    </button>
    You can't perform that action at this time.
  </div>


    <script crossorigin="anonymous" src="https://assets-cdn.github.com/assets/compat-91f98c37fc84eac24836eec2567e9912742094369a04c4eba6e3cd1fa18902d9.js"></script>
    <script crossorigin="anonymous" src="https://assets-cdn.github.com/assets/frameworks-db06d5e5cc508b59a3d6d16c22bb523005ca9fc0c513cbb039b32a25204b6be7.js"></script>
    
    <script async="async" crossorigin="anonymous" src="https://assets-cdn.github.com/assets/github-6dca6fb369806ef3a922b50d6f873c0d0a66de418690bba26c85c470a50e7f19.js"></script>
    
    
      <script crossorigin="anonymous" src="https://assets-cdn.github.com/assets/wiki-9917c014858e1241a70bbe533a26daef2e2d3a0b1db72cf30c73228d20b74947.js"></script>

    
  <div class="js-stale-session-flash stale-session-flash flash flash-warn flash-banner d-none">
    <svg aria-hidden="true" class="octicon octicon-alert" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M8.865 1.52c-.18-.31-.51-.5-.87-.5s-.69.19-.87.5L.275 13.5c-.18.31-.18.69 0 1 .19.31.52.5.87.5h13.7c.36 0 .69-.19.86-.5.17-.31.18-.69.01-1L8.865 1.52zM8.995 13h-2v-2h2v2zm0-3h-2V6h2v4z"/></svg>
    <span class="signed-in-tab-flash">You signed in with another tab or window. <a href="">Reload</a> to refresh your session.</span>
    <span class="signed-out-tab-flash">You signed out in another tab or window. <a href="">Reload</a> to refresh your session.</span>
  </div>
  <div class="facebox" id="facebox" style="display:none;">
  <div class="facebox-popup">
    <div class="facebox-content" role="dialog" aria-labelledby="facebox-header" aria-describedby="facebox-description">
    </div>
    <button type="button" class="facebox-close js-facebox-close" aria-label="Close modal">
      <svg aria-hidden="true" class="octicon octicon-x" height="16" version="1.1" viewBox="0 0 12 16" width="12"><path fill-rule="evenodd" d="M7.48 8l3.75 3.75-1.48 1.48L6 9.48l-3.75 3.75-1.48-1.48L4.52 8 .77 4.25l1.48-1.48L6 6.52l3.75-3.75 1.48 1.48z"/></svg>
    </button>
  </div>
</div>


  </body>
</html>

